<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>rdkit.Chem.MCS</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a href="http://www.rdkit.org">RDKit</a></th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        Package&nbsp;rdkit ::
        <a href="rdkit.Chem-module.html">Package&nbsp;Chem</a> ::
        Module&nbsp;MCS
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="rdkit.Chem.MCS-module.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<!-- ==================== MODULE DESCRIPTION ==================== -->
<h1 class="epydoc">Module MCS</h1><p class="nomargin-top"><span class="codelink"><a href="rdkit.Chem.MCS-pysrc.html">source&nbsp;code</a></span></p>
<!-- ==================== CLASSES ==================== -->
<a name="section-Classes"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Classes</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Classes"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="rdkit.Chem.MCS.MCSResult-class.html" class="summary-name" onclick="show_private();">MCSResult</a>
    </td>
  </tr>
</table>
<!-- ==================== FUNCTIONS ==================== -->
<a name="section-Functions"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Functions</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Functions"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="rdkit.Chem.MCS-module.html#FindMCS" class="summary-sig-name">FindMCS</a>(<span class="summary-sig-arg">mols</span>,
        <span class="summary-sig-arg">minNumAtoms</span>=<span class="summary-sig-default">2</span>,
        <span class="summary-sig-arg">maximize</span>=<span class="summary-sig-default">Default.maximize</span>,
        <span class="summary-sig-arg">atomCompare</span>=<span class="summary-sig-default">Default.atomCompare</span>,
        <span class="summary-sig-arg">bondCompare</span>=<span class="summary-sig-default">Default.bondCompare</span>,
        <span class="summary-sig-arg">matchValences</span>=<span class="summary-sig-default">Default.matchValences</span>,
        <span class="summary-sig-arg">ringMatchesRingOnly</span>=<span class="summary-sig-default">False</span>,
        <span class="summary-sig-arg">completeRingsOnly</span>=<span class="summary-sig-default">False</span>,
        <span class="summary-sig-arg">timeout</span>=<span class="summary-sig-default">Default.timeout</span>,
        <span class="summary-sig-arg">threshold</span>=<span class="summary-sig-default">None</span>)</span><br />
      Find the maximum common substructure of a set of molecules</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="rdkit.Chem.MCS-pysrc.html#FindMCS">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="_test"></a><span class="summary-sig-name">_test</span>()</span></td>
          <td align="right" valign="top">
            <span class="codelink"><a href="rdkit.Chem.MCS-pysrc.html#_test">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
</table>
<p class="indent-wrapped-lines"><b>Imports:</b>
  <span title="warnings">warnings</span>,
  <a href="rdkit.Chem.fmcs-module.html" title="rdkit.Chem.fmcs">fmcs</a>,
  <span title="rdkit.Chem.fmcs.Default">Default</span>
</p><br />
<!-- ==================== FUNCTION DETAILS ==================== -->
<a name="section-FunctionDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Function Details</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-FunctionDetails"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
</table>
<a name="FindMCS"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">FindMCS</span>(<span class="sig-arg">mols</span>,
        <span class="sig-arg">minNumAtoms</span>=<span class="sig-default">2</span>,
        <span class="sig-arg">maximize</span>=<span class="sig-default">Default.maximize</span>,
        <span class="sig-arg">atomCompare</span>=<span class="sig-default">Default.atomCompare</span>,
        <span class="sig-arg">bondCompare</span>=<span class="sig-default">Default.bondCompare</span>,
        <span class="sig-arg">matchValences</span>=<span class="sig-default">Default.matchValences</span>,
        <span class="sig-arg">ringMatchesRingOnly</span>=<span class="sig-default">False</span>,
        <span class="sig-arg">completeRingsOnly</span>=<span class="sig-default">False</span>,
        <span class="sig-arg">timeout</span>=<span class="sig-default">Default.timeout</span>,
        <span class="sig-arg">threshold</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="rdkit.Chem.MCS-pysrc.html#FindMCS">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">
Find the maximum common substructure of a set of molecules

In the simplest case, pass in a list of molecules and get back
an MCSResult object which describes the MCS:

&gt;&gt;&gt; from rdkit import Chem
&gt;&gt;&gt; mols = [Chem.MolFromSmiles(&quot;C#CCP&quot;), Chem.MolFromSmiles(&quot;C=CCO&quot;)]
&gt;&gt;&gt; from rdkit.Chem import MCS
&gt;&gt;&gt; MCS.FindMCS(mols)
MCSResult(numAtoms=2, numBonds=1, smarts='[#6]-[#6]', completed=1)

The SMARTS '[#6]-[#6]' matches the largest common substructure of
the input structures. It has 2 atoms and 1 bond. If there is no
MCS which is at least `minNumAtoms` in size then the result will set
numAtoms and numBonds to -1 and set smarts to None.

By default, two atoms match if they are the same element and two
bonds match if they have the same bond type. Specify `atomCompare`
and `bondCompare` to use different comparison functions, as in:

&gt;&gt;&gt; MCS.FindMCS(mols, atomCompare=&quot;any&quot;)
MCSResult(numAtoms=3, numBonds=2, smarts='[*]-[*]-[*]', completed=1)
&gt;&gt;&gt; MCS.FindMCS(mols, bondCompare=&quot;any&quot;)
MCSResult(numAtoms=3, numBonds=2, smarts='[#6]~[#6]~[#6]', completed=1)

An atomCompare of &quot;any&quot; says that any atom matches any other atom,
&quot;elements&quot; compares by element type, and &quot;isotopes&quot; matches based on
the isotope label. Isotope labels can be used to implement user-defined
atom types. A bondCompare of &quot;any&quot; says that any bond matches any
other bond, and &quot;bondtypes&quot; says bonds are equivalent if and only if
they have the same bond type.

A substructure has both atoms and bonds. The default `maximize`
setting of &quot;atoms&quot; finds a common substructure with the most number
of atoms. Use maximize=&quot;bonds&quot; to maximize the number of bonds.
Maximizing the number of bonds tends to maximize the number of rings,
although two small rings may have fewer bonds than one large ring.

You might not want a 3-valent nitrogen to match one which is 5-valent.
The default `matchValences` value of False ignores valence information.
When True, the atomCompare setting is modified to also require that
the two atoms have the same valency.

&gt;&gt;&gt; MCS.FindMCS(mols, matchValences=True)
MCSResult(numAtoms=2, numBonds=1, smarts='[#6v4]-[#6v4]', completed=1)

It can be strange to see a linear carbon chain match a carbon ring,
which is what the `ringMatchesRingOnly` default of False does. If
you set it to True then ring bonds will only match ring bonds.

&gt;&gt;&gt; mols = [Chem.MolFromSmiles(&quot;C1CCC1CCC&quot;), Chem.MolFromSmiles(&quot;C1CCCCCC1&quot;)]
&gt;&gt;&gt; MCS.FindMCS(mols)
MCSResult(numAtoms=7, numBonds=6, smarts='[#6]-[#6]-[#6]-[#6]-[#6]-[#6]-[#6]', completed=1)
&gt;&gt;&gt; MCS.FindMCS(mols, ringMatchesRingOnly=True)
MCSResult(numAtoms=4, numBonds=3, smarts='[#6](-@[#6])-@[#6]-@[#6]', completed=1)

You can further restrict things and require that partial rings
(as in this case) are not allowed. That is, if an atom is part of
the MCS and the atom is in a ring of the entire molecule then
that atom is also in a ring of the MCS. Set `completeRingsOnly`
to True to toggle this requirement and also sets ringMatchesRingOnly
to True.

&gt;&gt;&gt; mols = [Chem.MolFromSmiles(&quot;CCC1CC2C1CN2&quot;), Chem.MolFromSmiles(&quot;C1CC2C1CC2&quot;)]
&gt;&gt;&gt; MCS.FindMCS(mols)
MCSResult(numAtoms=6, numBonds=6, smarts='[#6]-1-[#6]-[#6](-[#6])-[#6]-1-[#6]', completed=1)
&gt;&gt;&gt; MCS.FindMCS(mols, ringMatchesRingOnly=True)
MCSResult(numAtoms=5, numBonds=5, smarts='[#6]-@1-@[#6]-@[#6](-@[#6])-@[#6]-@1', completed=1)
&gt;&gt;&gt; MCS.FindMCS(mols, completeRingsOnly=True)
MCSResult(numAtoms=4, numBonds=4, smarts='[#6]-@1-@[#6]-@[#6]-@[#6]-@1', completed=1)

The MCS algorithm will exhaustively search for a maximum common substructure.
Typically this takes a fraction of a second, but for some comparisons this
can take minutes or longer. Use the `timeout` parameter to stop the search
after the given number of seconds (wall-clock seconds, not CPU seconds) and
return the best match found in that time. If timeout is reached then the
`completed` property of the MCSResult will be 0 instead of 1.

&gt;&gt;&gt; mols = [Chem.MolFromSmiles(&quot;Nc1ccccc1&quot;*100), Chem.MolFromSmiles(&quot;Nc1ccccccccc1&quot;*100)]
&gt;&gt;&gt; MCS.FindMCS(mols, timeout=0.1)
MCSResult(..., completed=0)

(The MCS after 50 seconds contained 511 atoms.)

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a href="http://www.rdkit.org">RDKit</a></th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1
    on Tue Jan 23 10:00:34 2018
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
