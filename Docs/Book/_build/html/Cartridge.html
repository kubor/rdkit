
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="ja">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>The RDKit database cartridge &#8212; The RDKit 2017.09.2 ドキュメント</title>
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '2017.09.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/translations.js"></script>
    <link rel="index" title="索引" href="genindex.html" />
    <link rel="search" title="検索" href="search.html" />
    <link rel="prev" title="RDKit Cookbook" href="Cookbook.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="総合索引"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="Cookbook.html" title="RDKit Cookbook"
             accesskey="P">前へ</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">The RDKit 2017.09.2 ドキュメント</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="index.html">目次</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Overview.html">An overview of the RDKit</a></li>
<li class="toctree-l1"><a class="reference internal" href="Install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="GettingStartedInPython.html">Getting Started with the RDKit in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="RDKit_Book.html">The RDKit Book</a></li>
<li class="toctree-l1"><a class="reference internal" href="Cookbook.html">RDKit Cookbook</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">The RDKit database cartridge</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#what-is-this">What is this?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tutorial">Tutorial</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#creating-databases">Creating databases</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#configuration">Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#creating-a-database-from-a-file">Creating a database from a file</a></li>
<li class="toctree-l4"><a class="reference internal" href="#loading-chembl">Loading ChEMBL</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#substructure-searches">Substructure searches</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#smarts-based-queries">SMARTS-based queries</a></li>
<li class="toctree-l4"><a class="reference internal" href="#using-stereochemistry">Using Stereochemistry</a></li>
<li class="toctree-l4"><a class="reference internal" href="#tuning-queries">Tuning queries</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#similarity-searches">Similarity searches</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#adjusting-the-similarity-cutoff">Adjusting the similarity cutoff</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#using-the-mcs-code">Using the MCS code</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#reference-guide">Reference Guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#new-types">New Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="#parameters">Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#operators">Operators</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#similarity-search">Similarity search</a></li>
<li class="toctree-l4"><a class="reference internal" href="#substructure-and-exact-structure-search">Substructure and exact structure search</a></li>
<li class="toctree-l4"><a class="reference internal" href="#molecule-comparison">Molecule comparison</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#functions">Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#fingerprint-related">Fingerprint Related</a></li>
<li class="toctree-l4"><a class="reference internal" href="#molecule-related">Molecule Related</a></li>
<li class="toctree-l4"><a class="reference internal" href="#other">Other</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#using-the-cartridge-from-python">Using the Cartridge from Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="#license">License</a></li>
</ul>
</li>
</ul>

  <h4>前のトピックへ</h4>
  <p class="topless"><a href="Cookbook.html"
                        title="前の章へ">RDKit Cookbook</a></p>
  <div role="note" aria-label="source link">
    <h3>このページ</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/Cartridge.md.txt"
            rel="nofollow">ソースコードを表示</a></li>
    </ul>
   </div>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="the-rdkit-database-cartridge">
<span id="the-rdkit-database-cartridge"></span><h1>The RDKit database cartridge<a class="headerlink" href="#the-rdkit-database-cartridge" title="このヘッドラインへのパーマリンク">¶</a></h1>
<div class="section" id="what-is-this">
<span id="what-is-this"></span><h2>What is this?<a class="headerlink" href="#what-is-this" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>This document is a tutorial and reference guide for the RDKit PostgreSQL cartridge.</p>
<p>If you find mistakes, or have suggestions for improvements, please either fix them yourselves in the source document (the .md file) or send them to the mailing list: <a class="reference external" href="mailto:rdkit-discuss&#37;&#52;&#48;lists&#46;sourceforge&#46;net">rdkit-discuss<span>&#64;</span>lists<span>&#46;</span>sourceforge<span>&#46;</span>net</a> (you will need to subscribe first)</p>
</div>
<div class="section" id="tutorial">
<span id="tutorial"></span><h2>Tutorial<a class="headerlink" href="#tutorial" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="section" id="introduction">
<span id="introduction"></span><h3>Introduction<a class="headerlink" href="#introduction" title="このヘッドラインへのパーマリンク">¶</a></h3>
</div>
<div class="section" id="creating-databases">
<span id="creating-databases"></span><h3>Creating databases<a class="headerlink" href="#creating-databases" title="このヘッドラインへのパーマリンク">¶</a></h3>
<div class="section" id="configuration">
<span id="configuration"></span><h4>Configuration<a class="headerlink" href="#configuration" title="このヘッドラインへのパーマリンク">¶</a></h4>
<p>The timing information below was collected on a commodity desktop PC (Dell Studio XPS with a 2.9GHz i7 CPU and 8GB of RAM) running Ubuntu 12.04 and using PostgreSQL v9.1.4. The database was installed with default parameters.</p>
<p>To improve performance while loading the database and building the index, I changed a couple of postgres configuration settings in postgresql.conf :</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">synchronous_commit</span> <span class="o">=</span> <span class="n">off</span>      <span class="c1"># immediate fsync at commit</span>
<span class="n">full_page_writes</span> <span class="o">=</span> <span class="n">off</span>            <span class="c1"># recover from partial page writes</span>
</pre></div>
</div>
<p>And to improve search performance, I allowed postgresql to use more memory than the extremely conservative default settings:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">shared_buffers</span> <span class="o">=</span> <span class="mi">2048</span><span class="n">MB</span>           <span class="c1"># min 128kB</span>
                  <span class="c1"># (change requires restart)</span>
<span class="n">work_mem</span> <span class="o">=</span> <span class="mi">128</span><span class="n">MB</span>              <span class="c1"># min 64kB</span>
</pre></div>
</div>
</div>
<div class="section" id="creating-a-database-from-a-file">
<span id="creating-a-database-from-a-file"></span><h4>Creating a database from a file<a class="headerlink" href="#creating-a-database-from-a-file" title="このヘッドラインへのパーマリンク">¶</a></h4>
<p>In this example I show how to load a database from the SMILES file of commercially available compounds that is downloadable from emolecules.com at URL <a class="reference external" href="http://www.emolecules.com/doc/plus/download-database.php">http://www.emolecules.com/doc/plus/download-database.php</a></p>
<p>If you choose to repeat this exact example yourself, please note that it takes several hours to load the 6 million row database and generate all fingerprints.</p>
<p>First create the database and install the cartridge:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">~/</span><span class="n">RDKit_trunk</span><span class="o">/</span><span class="n">Data</span><span class="o">/</span><span class="n">emolecules</span> <span class="o">&gt;</span> <span class="n">createdb</span> <span class="n">emolecules</span>
<span class="o">~/</span><span class="n">RDKit_trunk</span><span class="o">/</span><span class="n">Data</span><span class="o">/</span><span class="n">emolecules</span> <span class="o">&gt;</span> <span class="n">psql</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;create extension rdkit&#39;</span> <span class="n">emolecules</span>
</pre></div>
</div>
<p>Now create and populate a table holding the raw data:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">~/</span><span class="n">RDKit_trunk</span><span class="o">/</span><span class="n">Data</span><span class="o">/</span><span class="n">emolecules</span> <span class="o">&gt;</span> <span class="n">psql</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;create table raw_data (id SERIAL, smiles text, emol_id integer, parent_id integer)&#39;</span> <span class="n">emolecules</span>
<span class="n">NOTICE</span><span class="p">:</span>  <span class="n">CREATE</span> <span class="n">TABLE</span> <span class="n">will</span> <span class="n">create</span> <span class="n">implicit</span> <span class="n">sequence</span> <span class="s2">&quot;raw_data_id_seq&quot;</span> <span class="k">for</span> <span class="n">serial</span> <span class="n">column</span> <span class="s2">&quot;raw_data.id&quot;</span>
<span class="n">CREATE</span> <span class="n">TABLE</span>
<span class="o">~/</span><span class="n">RDKit_trunk</span><span class="o">/</span><span class="n">Data</span><span class="o">/</span><span class="n">emolecules</span> <span class="o">&gt;</span> <span class="n">zcat</span> <span class="n">emolecules</span><span class="o">-</span><span class="mi">2013</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mf">01.</span><span class="n">smi</span><span class="o">.</span><span class="n">gz</span> <span class="o">|</span> <span class="n">sed</span> <span class="s1">&#39;1d; s/</span><span class="se">\\</span><span class="s1">/</span><span class="se">\\\\</span><span class="s1">/g&#39;</span> <span class="o">|</span> <span class="n">psql</span> <span class="o">-</span><span class="n">c</span> <span class="s2">&quot;copy raw_data (smiles,emol_id,parent_id) from stdin with delimiter &#39; &#39;&quot;</span> <span class="n">emolecules</span>
</pre></div>
</div>
<p>Create the molecule table, but only for SMILES that the RDKit accepts:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">~/</span><span class="n">RDKit_trunk</span><span class="o">/</span><span class="n">Data</span><span class="o">/</span><span class="n">emolecules</span> <span class="o">&gt;</span> <span class="n">psql</span> <span class="n">emolecules</span>
<span class="n">psql</span> <span class="p">(</span><span class="mf">9.1</span><span class="o">.</span><span class="mi">4</span><span class="p">)</span>
<span class="n">Type</span> <span class="s2">&quot;help&quot;</span> <span class="k">for</span> <span class="n">help</span><span class="o">.</span>
<span class="n">emolecules</span><span class="o">=</span><span class="c1"># select * into mols from (select id,mol_from_smiles(smiles::cstring) m from raw_data) tmp where m is not null;</span>
<span class="n">WARNING</span><span class="p">:</span>  <span class="n">could</span> <span class="ow">not</span> <span class="n">create</span> <span class="n">molecule</span> <span class="kn">from</span> <span class="nn">SMILES</span> <span class="s1">&#39;CN(C)C(=[N+](C)C)Cl.F[P-](F)(F)(F)(F)F&#39;</span>
<span class="o">...</span> <span class="n">a</span> <span class="n">lot</span> <span class="n">of</span> <span class="n">warnings</span> <span class="n">deleted</span> <span class="o">...</span>
<span class="n">SELECT</span> <span class="mi">6008732</span>
<span class="n">emolecules</span><span class="o">=</span><span class="c1"># create index molidx on mols using gist(m);</span>
<span class="n">CREATE</span> <span class="n">INDEX</span>
</pre></div>
</div>
<p>The last step is only required if you plan to do substructure searches.</p>
</div>
<div class="section" id="loading-chembl">
<span id="loading-chembl"></span><h4>Loading ChEMBL<a class="headerlink" href="#loading-chembl" title="このヘッドラインへのパーマリンク">¶</a></h4>
<p>Start by downloading and installing the postgresql dump from the ChEMBL website <a class="reference external" href="ftp://ftp.ebi.ac.uk/pub/databases/chembl/ChEMBLdb/latest">ftp://ftp.ebi.ac.uk/pub/databases/chembl/ChEMBLdb/latest</a></p>
<p>Connect to the database, install the cartridge, and create the schema that we’ll use:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">chembl_23</span><span class="o">=</span><span class="c1"># create extension if not exists rdkit;</span>
<span class="n">chembl_23</span><span class="o">=</span><span class="c1"># create schema rdk;</span>
</pre></div>
</div>
<p>Create the molecules and build the substructure search index:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">chembl_23</span><span class="o">=</span><span class="c1"># select * into rdk.mols from (select molregno,mol_from_ctab(molfile::cstring) m  from compound_structures) tmp where m is not null;</span>
<span class="n">SELECT</span> <span class="mi">1727081</span>
<span class="n">chembl_23</span><span class="o">=</span><span class="c1"># create index molidx on rdk.mols using gist(m);</span>
<span class="n">CREATE</span> <span class="n">INDEX</span>
<span class="n">chembl_23</span><span class="o">=</span><span class="c1"># alter table rdk.mols add primary key (molregno);</span>
<span class="n">ALTER</span> <span class="n">TABLE</span>
</pre></div>
</div>
<p>Create some fingerprints and build the similarity search index:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">chembl_23</span><span class="o">=</span><span class="c1"># select molregno,torsionbv_fp(m) as torsionbv,morganbv_fp(m) as mfp2,featmorganbv_fp(m) as ffp2 into rdk.fps from rdk.mols;</span>
<span class="n">SELECT</span> <span class="mi">1727081</span>
<span class="n">chembl_23</span><span class="o">=</span><span class="c1"># create index fps_ttbv_idx on rdk.fps using gist(torsionbv);</span>
<span class="n">CREATE</span> <span class="n">INDEX</span>
<span class="n">chembl_23</span><span class="o">=</span><span class="c1"># create index fps_mfp2_idx on rdk.fps using gist(mfp2);</span>
<span class="n">CREATE</span> <span class="n">INDEX</span>
<span class="n">chembl_23</span><span class="o">=</span><span class="c1"># create index fps_ffp2_idx on rdk.fps using gist(ffp2);</span>
<span class="n">CREATE</span> <span class="n">INDEX</span>
<span class="n">chembl_23</span><span class="o">=</span><span class="c1"># alter table rdk.fps add primary key (molregno);</span>
<span class="n">ALTER</span> <span class="n">TABLE</span>
</pre></div>
</div>
<p>Here is a group of the commands used here (and below) in one block so that you can just paste it in at the psql prompt:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>create extension if not exists rdkit;
create schema rdk;
select * into rdk.mols from (select molregno,mol_from_ctab(molfile::cstring) m  from compound_structures) tmp where m is not null;
create index molidx on rdk.mols using gist(m);
alter table rdk.mols add primary key (molregno);
select molregno,torsionbv_fp(m) as torsionbv,morganbv_fp(m) as mfp2,featmorganbv_fp(m) as ffp2 into rdk.fps from rdk.mols;
create index fps_ttbv_idx on rdk.fps using gist(torsionbv);
create index fps_mfp2_idx on rdk.fps using gist(mfp2);
create index fps_ffp2_idx on rdk.fps using gist(ffp2);
alter table rdk.fps add primary key (molregno);
create or replace function get_mfp2_neighbors(smiles text)
returns table(molregno integer, m mol, similarity double precision) as
$$
select molregno,m,tanimoto_sml(morganbv_fp(mol_from_smiles($1::cstring)),mfp2) as similarity
from rdk.fps join rdk.mols using (molregno)
where morganbv_fp(mol_from_smiles($1::cstring))%mfp2
order by morganbv_fp(mol_from_smiles($1::cstring))&lt;%&gt;mfp2;
$$ language sql stable ;
</pre></div>
</div>
</div>
</div>
<div class="section" id="substructure-searches">
<span id="substructure-searches"></span><h3>Substructure searches<a class="headerlink" href="#substructure-searches" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Example query molecules taken from the <a class="reference external" href="http://www.emolecules.com/">eMolecules home page</a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">chembl_23</span><span class="o">=</span><span class="c1"># select count(*) from rdk.mols where m@&gt;&#39;c1cccc2c1nncc2&#39; ;</span>
 <span class="n">count</span>
<span class="o">-------</span>
   <span class="mi">447</span>
<span class="p">(</span><span class="mi">1</span> <span class="n">row</span><span class="p">)</span>

<span class="n">Time</span><span class="p">:</span> <span class="mf">107.602</span> <span class="n">ms</span>
<span class="n">chembl_23</span><span class="o">=</span><span class="c1"># select count(*) from rdk.mols where m@&gt;&#39;c1ccnc2c1nccn2&#39; ;</span>
 <span class="n">count</span>
<span class="o">-------</span>
  <span class="mi">1013</span>
<span class="p">(</span><span class="mi">1</span> <span class="n">row</span><span class="p">)</span>

<span class="n">Time</span><span class="p">:</span> <span class="mf">216.222</span> <span class="n">ms</span>
<span class="n">chembl_23</span><span class="o">=</span><span class="c1"># select count(*) from rdk.mols where m@&gt;&#39;c1cncc2n1ccn2&#39; ;</span>
 <span class="n">count</span>
<span class="o">-------</span>
  <span class="mi">1775</span>
<span class="p">(</span><span class="mi">1</span> <span class="n">row</span><span class="p">)</span>

<span class="n">Time</span><span class="p">:</span> <span class="mf">88.266</span> <span class="n">ms</span>
<span class="n">chembl_23</span><span class="o">=</span><span class="c1"># select count(*) from rdk.mols where m@&gt;&#39;Nc1ncnc(N)n1&#39; ;</span>
 <span class="n">count</span>
<span class="o">-------</span>
  <span class="mi">5842</span>
<span class="p">(</span><span class="mi">1</span> <span class="n">row</span><span class="p">)</span>

<span class="n">Time</span><span class="p">:</span> <span class="mf">327.855</span> <span class="n">ms</span>
<span class="n">chembl_23</span><span class="o">=</span><span class="c1"># select count(*) from rdk.mols where m@&gt;&#39;c1scnn1&#39; ;</span>
 <span class="n">count</span>
<span class="o">-------</span>
 <span class="mi">15962</span>
<span class="p">(</span><span class="mi">1</span> <span class="n">row</span><span class="p">)</span>

<span class="n">Time</span><span class="p">:</span> <span class="mf">568.675</span> <span class="n">ms</span>
<span class="n">chembl_23</span><span class="o">=</span><span class="c1"># select count(*) from rdk.mols where m@&gt;&#39;c1cccc2c1ncs2&#39; ;</span>
 <span class="n">count</span>
<span class="o">-------</span>
 <span class="mi">18986</span>
<span class="p">(</span><span class="mi">1</span> <span class="n">row</span><span class="p">)</span>

<span class="n">Time</span><span class="p">:</span> <span class="mf">998.104</span> <span class="n">ms</span>
<span class="n">chembl_23</span><span class="o">=</span><span class="c1"># select count(*) from rdk.mols where m@&gt;&#39;c1cccc2c1CNCCN2&#39; ;</span>
 <span class="n">count</span>
<span class="o">-------</span>
  <span class="mi">1613</span>
<span class="p">(</span><span class="mi">1</span> <span class="n">row</span><span class="p">)</span>

<span class="n">Time</span><span class="p">:</span> <span class="mf">1922.273</span> <span class="n">ms</span>
</pre></div>
</div>
<p>Notice that the last two queries are starting to take a while to execute and count all the results.</p>
<p>Given we’re searching through 1.7 million compounds these search times aren’t incredibly slow, but it would be nice to have them quicker.</p>
<p>One easy way to speed things up, particularly for queries that return a large number of results, is to only retrieve a limited number of results:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">chembl_23</span><span class="o">=</span><span class="c1"># select * from rdk.mols where m@&gt;&#39;c1cccc2c1CNCCN2&#39; limit 100;</span>
 <span class="n">molregno</span> <span class="o">|</span>                                                                                             <span class="n">m</span>                                                             

<span class="o">----------+-----------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="o">--------------------------------</span>
   <span class="mi">908048</span> <span class="o">|</span> <span class="n">O</span><span class="o">=</span><span class="n">C1CN</span><span class="p">(</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">c2ccc</span><span class="p">(</span><span class="n">Br</span><span class="p">)</span><span class="n">o2</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="n">c2ccc</span><span class="p">(</span><span class="n">F</span><span class="p">)</span><span class="n">cc2</span><span class="p">)</span><span class="n">c2cc</span><span class="p">(</span><span class="n">F</span><span class="p">)</span><span class="n">ccc2N1</span>
   <span class="mi">931972</span> <span class="o">|</span> <span class="n">Cl</span><span class="o">.</span><span class="n">c1ccc</span><span class="p">(</span><span class="n">CC2CNc3ccccc3CN2</span><span class="p">)</span><span class="n">cc1</span>
   <span class="mi">904450</span> <span class="o">|</span> <span class="n">CCOC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)[</span><span class="n">C</span><span class="nd">@H</span><span class="p">]</span><span class="mi">1</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">]</span><span class="mi">2</span><span class="n">COc3ccc</span><span class="p">(</span><span class="n">Cl</span><span class="p">)</span><span class="n">cc3</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">]</span><span class="mi">2</span><span class="n">N2C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">c3ccc</span><span class="p">(</span><span class="n">Cl</span><span class="p">)</span><span class="n">cc3NC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)[</span><span class="n">C</span><span class="o">@@</span><span class="p">]</span><span class="mi">12</span><span class="n">C</span>
   <span class="mi">226391</span> <span class="o">|</span> <span class="n">C</span><span class="o">/</span><span class="n">C</span><span class="o">=</span><span class="n">C1</span><span class="o">/</span><span class="n">CC2C</span><span class="p">(</span><span class="n">OC</span><span class="p">)</span><span class="n">Nc3cc</span><span class="p">(</span><span class="n">OC</span><span class="p">)</span><span class="n">c</span><span class="p">(</span><span class="n">OC</span><span class="p">)</span><span class="n">cc3C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N2C1</span>
   <span class="mi">930820</span> <span class="o">|</span> <span class="n">CN1CC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">(</span><span class="n">CC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">Nc2ccc</span><span class="p">(</span><span class="n">N</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">C</span><span class="p">)</span><span class="n">cc2</span><span class="p">)</span><span class="n">c2ccccc2C1</span><span class="o">=</span><span class="n">O</span>
    <span class="mi">18576</span> <span class="o">|</span> <span class="n">CO</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">]</span><span class="mi">1</span><span class="n">Nc2c</span><span class="p">(</span><span class="n">ccc</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">c2O</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N2C</span><span class="o">=</span><span class="n">C</span><span class="p">(</span><span class="o">/</span><span class="n">C</span><span class="o">=</span><span class="n">C</span><span class="o">/</span><span class="n">C</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">C</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">]</span><span class="mi">12</span>
   <span class="mi">249934</span> <span class="o">|</span> <span class="n">O</span><span class="o">=</span><span class="n">C</span><span class="p">(</span><span class="n">c1cccc2ccccc12</span><span class="p">)</span><span class="n">N1CCN</span><span class="p">(</span><span class="n">Cc2cncn2Cc2ccccc2</span><span class="p">)</span><span class="n">c2ccccc2C1</span>
   <span class="o">...</span>
    <span class="mi">91020</span> <span class="o">|</span> <span class="n">CC</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">C</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">]</span><span class="mi">1</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N2c3ccccc3</span><span class="p">[</span><span class="n">C</span><span class="o">@@</span><span class="p">](</span><span class="n">O</span><span class="p">)(</span><span class="n">C</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">]</span><span class="mi">3</span><span class="n">NC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">c4ccccc4N4C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">c5ccccc5NC34</span><span class="p">)[</span><span class="n">C</span><span class="nd">@H</span><span class="p">]</span><span class="mi">2</span><span class="n">N1C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="n">CCCNC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">OCc1ccccc1</span><span class="p">)</span><span class="n">NC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">OC</span><span class="p">(</span><span class="n">C</span><span class="p">)(</span><span class="n">C</span><span class="p">)</span><span class="n">C</span>
    <span class="mi">91225</span> <span class="o">|</span> <span class="n">CC</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">C</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">]</span><span class="mi">1</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N2c3ccccc3</span><span class="p">[</span><span class="n">C</span><span class="o">@@</span><span class="p">](</span><span class="n">O</span><span class="p">)(</span><span class="n">C</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">]</span><span class="mi">3</span><span class="n">NC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">c4ccccc4N4C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">c5ccccc5NC34</span><span class="p">)[</span><span class="n">C</span><span class="nd">@H</span><span class="p">]</span><span class="mi">2</span><span class="n">N1C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">CCC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)[</span><span class="n">O</span><span class="o">-</span><span class="p">]</span><span class="o">.</span><span class="p">[</span><span class="n">Na</span><span class="o">+</span><span class="p">]</span>
   <span class="mi">348798</span> <span class="o">|</span> <span class="n">O</span><span class="o">=</span><span class="n">C</span><span class="p">(</span><span class="n">O</span><span class="p">)</span><span class="n">CN1C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="n">c2ccc</span><span class="p">(</span><span class="n">Cl</span><span class="p">)</span><span class="n">cc2</span><span class="p">)</span><span class="n">N</span><span class="p">(</span><span class="n">C</span><span class="p">(</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">O</span><span class="p">)</span><span class="n">c2ccc</span><span class="p">(</span><span class="n">Cl</span><span class="p">)</span><span class="n">cc2</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">c2cc</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="n">ccc21</span>
   <span class="mi">348972</span> <span class="o">|</span> <span class="n">C</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">c1ccc</span><span class="p">(</span><span class="n">Cl</span><span class="p">)</span><span class="n">cc1</span><span class="p">)</span><span class="n">N1C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">c2cc</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="n">ccc2N</span><span class="p">(</span><span class="n">CCCCC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">O</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">]</span><span class="mi">1</span><span class="n">c1ccc</span><span class="p">(</span><span class="n">C</span><span class="p">(</span><span class="n">F</span><span class="p">)(</span><span class="n">F</span><span class="p">)</span><span class="n">F</span><span class="p">)</span><span class="n">cc1</span>

<span class="o">...</span><span class="n">skipping</span> <span class="mi">23</span> <span class="n">lines</span>
<span class="n">Time</span><span class="p">:</span> <span class="mf">97.357</span> <span class="n">ms</span>
</pre></div>
</div>
<div class="section" id="smarts-based-queries">
<span id="smarts-based-queries"></span><h4>SMARTS-based queries<a class="headerlink" href="#smarts-based-queries" title="このヘッドラインへのパーマリンク">¶</a></h4>
<p>Oxadiazole or thiadiazole:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">chembl_23</span><span class="o">=</span><span class="c1"># select * from rdk.mols where m@&gt;&#39;c1[o,s]ncn1&#39;::qmol limit 500;</span>
 <span class="n">molregno</span> <span class="o">|</span>                                                      <span class="n">m</span>                                                       
<span class="o">----------+--------------------------------------------------------------------------------------------------------------</span>
  <span class="mi">1370170</span> <span class="o">|</span> <span class="n">Fc1cccc</span><span class="p">(</span><span class="o">-</span><span class="n">c2nc</span><span class="p">(</span><span class="n">NCC3COc4ccccc4O3</span><span class="p">)</span><span class="n">no2</span><span class="p">)</span><span class="n">c1F</span>
  <span class="mi">1370417</span> <span class="o">|</span> <span class="n">COc1cc</span><span class="p">(</span><span class="n">CN2CCC</span><span class="p">(</span><span class="n">Cc3nc</span><span class="p">(</span><span class="o">-</span><span class="n">c4ccc5c</span><span class="p">(</span><span class="n">c4</span><span class="p">)</span><span class="n">CCO5</span><span class="p">)</span><span class="n">no3</span><span class="p">)</span><span class="n">C2</span><span class="p">)</span><span class="n">ccc1F</span>
  <span class="mi">1370526</span> <span class="o">|</span> <span class="n">Cl</span><span class="o">.</span><span class="n">Cn1cc</span><span class="p">(</span><span class="o">-</span><span class="n">c2noc</span><span class="p">(</span><span class="o">/</span><span class="n">C</span><span class="o">=</span><span class="n">C3</span><span class="o">/</span><span class="n">CCN4CCCC</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">]</span><span class="mi">4</span><span class="n">C3</span><span class="p">)</span><span class="n">n2</span><span class="p">)</span><span class="n">c2ccccc21</span>
  <span class="mi">1379267</span> <span class="o">|</span> <span class="n">CCC</span><span class="p">(</span><span class="n">c1ccccc1</span><span class="p">)</span><span class="n">c1noc</span><span class="p">(</span><span class="n">CCN</span><span class="p">(</span><span class="n">CC</span><span class="p">)</span><span class="n">CC</span><span class="p">)</span><span class="n">n1</span>
  <span class="mi">1404150</span> <span class="o">|</span> <span class="n">OC</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">]</span><span class="mi">1</span><span class="n">O</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">c2nc</span><span class="p">(</span><span class="o">-</span><span class="n">c3nc</span><span class="p">(</span><span class="o">-</span><span class="n">c4cccs4</span><span class="p">)</span><span class="n">no3</span><span class="p">)</span><span class="n">cs2</span><span class="p">)</span><span class="n">C</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">]</span><span class="mi">1</span><span class="n">O</span>
  <span class="mi">1217463</span> <span class="o">|</span> <span class="n">CC</span><span class="p">(</span><span class="n">C</span><span class="p">)(</span><span class="n">C</span><span class="p">)</span><span class="n">c1ccc</span><span class="p">(</span><span class="o">-</span><span class="n">c2noc</span><span class="p">(</span><span class="n">CCC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N3CCCCC3</span><span class="p">)</span><span class="n">n2</span><span class="p">)</span><span class="n">cc1</span>
  <span class="o">...</span>
  <span class="mi">1517753</span> <span class="o">|</span> <span class="n">CC</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">c1noc</span><span class="p">(</span><span class="n">N2CCC</span><span class="p">(</span><span class="n">CO</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">]</span><span class="mi">3</span><span class="n">CC</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">c4ccc</span><span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="n">C</span><span class="p">)(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">cc4F</span><span class="p">)</span><span class="n">CC3</span><span class="p">)</span><span class="n">CC2</span><span class="p">)</span><span class="n">n1</span>
  <span class="mi">1263024</span> <span class="o">|</span> <span class="n">COc1cc</span><span class="p">(</span><span class="n">Nc2nc3c</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span><span class="n">CCCC3c2ccccc2</span><span class="p">)</span><span class="n">ccc1</span><span class="o">-</span><span class="n">c1nc</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">no1</span>
  <span class="mi">1264016</span> <span class="o">|</span> <span class="n">O</span><span class="o">=</span><span class="n">C</span><span class="p">(</span><span class="n">O</span><span class="p">)</span><span class="n">CCc1nc2cc</span><span class="p">(</span><span class="o">-</span><span class="n">c3noc</span><span class="p">(</span><span class="o">-</span><span class="n">c4cc</span><span class="p">(</span><span class="n">C</span><span class="p">(</span><span class="n">F</span><span class="p">)(</span><span class="n">F</span><span class="p">)</span><span class="n">F</span><span class="p">)</span><span class="n">cc</span><span class="p">(</span><span class="n">C</span><span class="p">(</span><span class="n">F</span><span class="p">)(</span><span class="n">F</span><span class="p">)</span><span class="n">F</span><span class="p">)</span><span class="n">c4</span><span class="p">)</span><span class="n">n3</span><span class="p">)</span><span class="n">ccc2</span><span class="p">[</span><span class="n">nH</span><span class="p">]</span><span class="mi">1</span>
  <span class="mi">1847733</span> <span class="o">|</span> <span class="n">Cc1cc</span><span class="p">(</span><span class="o">-</span><span class="n">c2noc</span><span class="p">([</span><span class="n">C</span><span class="nd">@H</span><span class="p">]</span><span class="mi">3</span><span class="n">CCCCN3C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">COc3ccccc3</span><span class="p">)</span><span class="n">n2</span><span class="p">)</span><span class="n">no1</span>
<span class="p">(</span><span class="mi">500</span> <span class="n">rows</span><span class="p">)</span>

<span class="n">Time</span><span class="p">:</span> <span class="mf">761.847</span> <span class="n">ms</span>
</pre></div>
</div>
<p>This is slower than the pure SMILES query, this is generally true of SMARTS-based queries.</p>
</div>
<div class="section" id="using-stereochemistry">
<span id="using-stereochemistry"></span><h4>Using Stereochemistry<a class="headerlink" href="#using-stereochemistry" title="このヘッドラインへのパーマリンク">¶</a></h4>
<p>Note that by default stereochemistry is not taken into account when doing substructure queries:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">chembl_23</span><span class="o">=</span><span class="c1"># select * from rdk.mols where m@&gt;&#39;NC(=O)[C@@H]1CCCN1C=O&#39; limit 10;</span>
 <span class="n">molregno</span> <span class="o">|</span>                                                                                                                                                           
               <span class="n">m</span>                                                                                                                                                      

<span class="o">----------+-----------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="o">----------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="o">---------------------</span>
    <span class="mi">87611</span> <span class="o">|</span> <span class="n">CNCC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">CCCN</span><span class="o">=</span><span class="n">C</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="n">N</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N1C</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">]</span><span class="mi">2</span><span class="n">C</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">]</span><span class="mi">1</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cc1ccc</span><span class="p">(</span><span class="n">O</span><span class="p">)</span><span class="n">cc1</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cc1c</span><span class="p">[</span><span class="n">nH</span><span class="p">]</span><span class="n">cn1</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N1CCC</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">]</span><span class="mi">1</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cc1ccccc1</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span>
<span class="p">)</span><span class="n">O</span><span class="p">)</span><span class="n">CCSS2</span>
    <span class="mi">88372</span> <span class="o">|</span> <span class="n">CNCCCC</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">NC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cc1ccccc1</span><span class="p">)</span><span class="n">NC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">CCCCNC</span><span class="p">)</span><span class="n">NC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cc1ccc</span><span class="p">(</span><span class="n">O</span><span class="p">)</span><span class="n">cc1</span><span class="p">)</span><span class="n">NC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">CO</span><span class="p">)</span><span class="n">NC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cc1ccccc1</span><span class="p">)</span><span class="n">NC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cc1ccccc1</span><span class="p">)</span><span class="n">NC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">C</span>
<span class="n">c1ccc2ccccc2c1</span><span class="p">)</span><span class="n">NC</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N1CCC</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">]</span><span class="mi">1</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">C</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">O</span>
    <span class="mi">88322</span> <span class="o">|</span> <span class="n">CC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cc1ccc2ccccc2c1</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cc1ccccc1</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cc1ccccc1</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">CO</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cc1ccc</span><span class="p">(</span><span class="n">O</span><span class="p">)</span><span class="n">cc1</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">CCCCNC</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">C</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cc1</span>
<span class="n">ccccc1</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">CCCCNC</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">C</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N1CCC</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">]</span><span class="mi">1</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">C</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">O</span>
    <span class="mi">88168</span> <span class="o">|</span> <span class="n">CC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cc1ccc2ccccc2c1</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cc1ccccc1</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cc1ccccc1</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">CO</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cc1ccc</span><span class="p">(</span><span class="n">O</span><span class="p">)</span><span class="n">cc1</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">CCCN</span><span class="o">=</span><span class="n">C</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="n">N</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cc1</span>
<span class="n">ccccc1</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">CCCCNC1CCCC1</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N1CCC</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">]</span><span class="mi">1</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">C</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">O</span>
    <span class="mi">88150</span> <span class="o">|</span> <span class="n">CC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cc1ccc2ccccc2c1</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cc1ccccc1</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cc1ccccc1</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">CO</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cc1ccc</span><span class="p">(</span><span class="n">O</span><span class="p">)</span><span class="n">cc1</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">CCCN</span><span class="o">=</span><span class="n">C</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="n">N</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cc1</span>
<span class="n">ccccc1</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">CCCCNCc1ccc</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">cc1</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N1CCC</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">]</span><span class="mi">1</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">C</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">O</span>
    <span class="mi">88373</span> <span class="o">|</span> <span class="n">CC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cc1ccc2ccccc2c1</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cc1ccccc1</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cc1ccccc1</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">CO</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cc1ccc</span><span class="p">(</span><span class="n">O</span><span class="p">)</span><span class="n">cc1</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">CCCCNC1CCCCC1</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span>
<span class="n">Cc1ccccc1</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">CCCCNC1CCCCC1</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N1CCC</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">]</span><span class="mi">1</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">C</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">O</span>
    <span class="mi">93377</span> <span class="o">|</span> <span class="n">CC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cc1ccc</span><span class="p">([</span><span class="n">N</span><span class="o">+</span><span class="p">](</span><span class="o">=</span><span class="n">O</span><span class="p">)[</span><span class="n">O</span><span class="o">-</span><span class="p">])</span><span class="n">cc1</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N1CCC</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">]</span><span class="mi">1</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">CCC</span><span class="o">/</span><span class="n">N</span><span class="o">=</span><span class="n">C</span><span class="p">(</span><span class="o">/</span><span class="n">N</span><span class="p">)</span><span class="n">NS</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">c1c</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">c</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">c2c</span><span class="p">(</span><span class="n">c1C</span><span class="p">)</span><span class="n">CCC</span><span class="p">(</span><span class="n">C</span><span class="p">)(</span><span class="n">C</span><span class="p">)</span><span class="n">O2</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cc1ccccc1</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span>
<span class="n">CCC</span><span class="o">/</span><span class="n">N</span><span class="o">=</span><span class="n">C</span><span class="p">(</span><span class="o">/</span><span class="n">N</span><span class="p">)</span><span class="n">NS</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">c1c</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">c</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">c2c</span><span class="p">(</span><span class="n">c1C</span><span class="p">)</span><span class="n">CCC</span><span class="p">(</span><span class="n">C</span><span class="p">)(</span><span class="n">C</span><span class="p">)</span><span class="n">O2</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">NCC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">COC</span><span class="p">(</span><span class="n">C</span><span class="p">)(</span><span class="n">C</span><span class="p">)</span><span class="n">C</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">CCCCNC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">c1ccccc1N</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">NCC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">O</span><span class="p">)[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">C</span><span class="p">)</span><span class="n">OC</span><span class="p">(</span><span class="n">C</span><span class="p">)(</span><span class="n">C</span><span class="p">)</span><span class="n">C</span>
    <span class="mi">94493</span> <span class="o">|</span> <span class="n">CC</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">C</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">]</span><span class="mi">1</span><span class="n">NC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)[</span><span class="n">C</span><span class="nd">@H</span><span class="p">]([</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">C</span><span class="p">)</span><span class="n">O</span><span class="p">)</span><span class="n">NC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cc2c</span><span class="p">[</span><span class="n">nH</span><span class="p">]</span><span class="n">c3ccccc23</span><span class="p">)</span><span class="n">NC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">C</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">C</span><span class="p">)</span><span class="n">NC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">NC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">CCCCN</span><span class="p">)</span><span class="n">NC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">]</span><span class="mi">2</span><span class="n">CCCN2C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">CCC</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">NC</span>
<span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">CNC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">CN</span><span class="p">)</span><span class="n">CSSC</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cc2ccc</span><span class="p">(</span><span class="n">O</span><span class="p">)</span><span class="n">cc2</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">CO</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">NCC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">NCC</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">=</span><span class="n">O</span><span class="p">)[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">C</span><span class="p">)</span><span class="n">O</span><span class="p">)</span><span class="n">NC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cc2c</span><span class="p">[</span><span class="n">nH</span><span class="p">]</span><span class="n">cn2</span><span class="p">)</span><span class="n">NC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cc2ccccc2</span><span class="p">)</span><span class="n">NC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">CNC</span>
<span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">]</span><span class="mi">2</span><span class="n">CCCN2C1</span><span class="o">=</span><span class="n">O</span>

<span class="o">...</span><span class="n">skipping</span> <span class="mi">1</span> <span class="n">line</span>
    <span class="mi">89559</span> <span class="o">|</span> <span class="n">CC1</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">SSC</span><span class="p">(</span><span class="n">C</span><span class="p">)(</span><span class="n">C</span><span class="p">)[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cc2c</span><span class="p">[</span><span class="n">nH</span><span class="p">]</span><span class="n">cn2</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N2CCC</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">]</span><span class="mi">2</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cc2ccccc2</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">O</span><span class="p">)</span><span class="n">NC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cc2ccc</span><span class="p">(</span><span class="n">O</span><span class="p">)</span><span class="n">cc2</span><span class="p">)</span><span class="n">NC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)[</span><span class="n">C</span><span class="nd">@H</span><span class="p">]</span><span class="mi">1</span><span class="n">NC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">CCCN</span><span class="o">=</span><span class="n">C</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="n">N</span><span class="p">)</span><span class="n">N</span>
<span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">N</span><span class="p">)</span><span class="n">CC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">O</span>
<span class="p">(</span><span class="mi">10</span> <span class="n">rows</span><span class="p">)</span>
</pre></div>
</div>
<p>This can be changed using the rdkit.do_chiral_sss configuration variable:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">chembl_23</span><span class="o">=</span><span class="c1"># set rdkit.do_chiral_sss=true;</span>
<span class="n">SET</span>
<span class="n">Time</span><span class="p">:</span> <span class="mf">0.241</span> <span class="n">ms</span>
<span class="n">chembl_23</span><span class="o">=</span><span class="c1"># select * from rdk.mols where m@&gt;&#39;NC(=O)[C@@H]1CCCN1C=O&#39; limit 10;</span>
 <span class="n">molregno</span> <span class="o">|</span>                                                                                                                                                              
            <span class="n">m</span>                                                                                                                                                            

<span class="o">----------+--------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="o">-------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="o">---------------</span>
    <span class="mi">87611</span> <span class="o">|</span> <span class="n">CNCC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">CCCN</span><span class="o">=</span><span class="n">C</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="n">N</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N1C</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">]</span><span class="mi">2</span><span class="n">C</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">]</span><span class="mi">1</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cc1ccc</span><span class="p">(</span><span class="n">O</span><span class="p">)</span><span class="n">cc1</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cc1c</span><span class="p">[</span><span class="n">nH</span><span class="p">]</span><span class="n">cn1</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N1CCC</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">]</span><span class="mi">1</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cc1ccccc1</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">O</span><span class="p">)</span>
<span class="n">CCSS2</span>
    <span class="mi">93377</span> <span class="o">|</span> <span class="n">CC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cc1ccc</span><span class="p">([</span><span class="n">N</span><span class="o">+</span><span class="p">](</span><span class="o">=</span><span class="n">O</span><span class="p">)[</span><span class="n">O</span><span class="o">-</span><span class="p">])</span><span class="n">cc1</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N1CCC</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">]</span><span class="mi">1</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">CCC</span><span class="o">/</span><span class="n">N</span><span class="o">=</span><span class="n">C</span><span class="p">(</span><span class="o">/</span><span class="n">N</span><span class="p">)</span><span class="n">NS</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">c1c</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">c</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">c2c</span><span class="p">(</span><span class="n">c1C</span><span class="p">)</span><span class="n">CCC</span><span class="p">(</span><span class="n">C</span><span class="p">)(</span><span class="n">C</span><span class="p">)</span><span class="n">O2</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cc1ccccc1</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">CCC</span>
<span class="o">/</span><span class="n">N</span><span class="o">=</span><span class="n">C</span><span class="p">(</span><span class="o">/</span><span class="n">N</span><span class="p">)</span><span class="n">NS</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">c1c</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">c</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">c2c</span><span class="p">(</span><span class="n">c1C</span><span class="p">)</span><span class="n">CCC</span><span class="p">(</span><span class="n">C</span><span class="p">)(</span><span class="n">C</span><span class="p">)</span><span class="n">O2</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">NCC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">COC</span><span class="p">(</span><span class="n">C</span><span class="p">)(</span><span class="n">C</span><span class="p">)</span><span class="n">C</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">CCCCNC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">c1ccccc1N</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">NCC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">O</span><span class="p">)[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">C</span><span class="p">)</span><span class="n">OC</span><span class="p">(</span><span class="n">C</span><span class="p">)(</span><span class="n">C</span><span class="p">)</span><span class="n">C</span>
    <span class="mi">94493</span> <span class="o">|</span> <span class="n">CC</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">C</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">]</span><span class="mi">1</span><span class="n">NC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)[</span><span class="n">C</span><span class="nd">@H</span><span class="p">]([</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">C</span><span class="p">)</span><span class="n">O</span><span class="p">)</span><span class="n">NC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cc2c</span><span class="p">[</span><span class="n">nH</span><span class="p">]</span><span class="n">c3ccccc23</span><span class="p">)</span><span class="n">NC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">C</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">C</span><span class="p">)</span><span class="n">NC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">NC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">CCCCN</span><span class="p">)</span><span class="n">NC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">]</span><span class="mi">2</span><span class="n">CCCN2C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">CCC</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">NC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span>
<span class="p">)</span><span class="n">CNC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">CN</span><span class="p">)</span><span class="n">CSSC</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cc2ccc</span><span class="p">(</span><span class="n">O</span><span class="p">)</span><span class="n">cc2</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">CO</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">NCC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">NCC</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">=</span><span class="n">O</span><span class="p">)[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">C</span><span class="p">)</span><span class="n">O</span><span class="p">)</span><span class="n">NC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cc2c</span><span class="p">[</span><span class="n">nH</span><span class="p">]</span><span class="n">cn2</span><span class="p">)</span><span class="n">NC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cc2ccccc2</span><span class="p">)</span><span class="n">NC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">CNC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)[</span><span class="n">C</span>
<span class="o">@</span><span class="nd">@H</span><span class="p">]</span><span class="mi">2</span><span class="n">CCCN2C1</span><span class="o">=</span><span class="n">O</span>
    <span class="mi">89558</span> <span class="o">|</span> <span class="n">NC</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">=</span><span class="n">NCCC</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">NC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">N</span><span class="p">)</span><span class="n">CC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">O</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">]</span><span class="mi">1</span><span class="n">CCSSC</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cc2c</span><span class="p">[</span><span class="n">nH</span><span class="p">]</span><span class="n">cn2</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N2CCC</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">]</span><span class="mi">2</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cc2ccccc2</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">O</span><span class="p">)</span><span class="n">NC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cc2ccc</span><span class="p">(</span><span class="n">O</span><span class="p">)</span><span class="n">cc</span>
<span class="mi">2</span><span class="p">)</span><span class="n">NC1</span><span class="o">=</span><span class="n">O</span>
    <span class="mi">89559</span> <span class="o">|</span> <span class="n">CC1</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">SSC</span><span class="p">(</span><span class="n">C</span><span class="p">)(</span><span class="n">C</span><span class="p">)[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cc2c</span><span class="p">[</span><span class="n">nH</span><span class="p">]</span><span class="n">cn2</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N2CCC</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">]</span><span class="mi">2</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cc2ccccc2</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">O</span><span class="p">)</span><span class="n">NC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cc2ccc</span><span class="p">(</span><span class="n">O</span><span class="p">)</span><span class="n">cc2</span><span class="p">)</span><span class="n">NC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)[</span><span class="n">C</span><span class="nd">@H</span><span class="p">]</span><span class="mi">1</span><span class="n">NC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">CCCN</span><span class="o">=</span><span class="n">C</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="n">N</span><span class="p">)</span><span class="n">NC</span><span class="p">(</span><span class="o">=</span>
<span class="n">O</span><span class="p">)[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">N</span><span class="p">)</span><span class="n">CC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">O</span>
   <span class="mi">126618</span> <span class="o">|</span> <span class="n">NC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">]</span><span class="mi">1</span><span class="n">CCCN1C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">]</span><span class="mi">1</span><span class="n">CCCN1C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">O</span><span class="p">)[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">N</span><span class="p">)</span><span class="n">Cc1ccccc1</span>
   <span class="mi">152339</span> <span class="o">|</span> <span class="n">O</span><span class="o">=</span><span class="n">C</span><span class="p">(</span><span class="n">O</span><span class="p">)</span><span class="n">CN</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">CC1CCCCC1</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N1CCC</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">]</span><span class="mi">1</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">NCCCc1c</span><span class="p">[</span><span class="n">nH</span><span class="p">]</span><span class="n">cn1</span>
   <span class="mi">152504</span> <span class="o">|</span> <span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">CC1CCCCC1</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N1</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">NC</span><span class="o">/</span><span class="n">C</span><span class="o">=</span><span class="n">C</span><span class="o">/</span><span class="n">c2c</span><span class="p">[</span><span class="n">nH</span><span class="p">]</span><span class="n">cn2</span><span class="p">)</span><span class="n">C</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">]</span><span class="mi">2</span><span class="n">CCCC</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">]</span><span class="mi">21</span>
   <span class="mi">152383</span> <span class="o">|</span> <span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">CC1CCCCC1</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N1CCC</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">]</span><span class="mi">1</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">NCCCCc1c</span><span class="p">[</span><span class="n">nH</span><span class="p">]</span><span class="n">cn1</span>
   <span class="mi">151837</span> <span class="o">|</span> <span class="n">N</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">CC1CCCCC1</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N1CCC</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">]</span><span class="mi">1</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">NC</span><span class="o">/</span><span class="n">C</span><span class="o">=</span><span class="n">C</span><span class="o">/</span><span class="n">c1c</span><span class="p">[</span><span class="n">nH</span><span class="p">]</span><span class="n">cn1</span>
<span class="p">(</span><span class="mi">10</span> <span class="n">rows</span><span class="p">)</span>

<span class="n">Time</span><span class="p">:</span> <span class="mf">6.181</span> <span class="n">ms</span>
</pre></div>
</div>
</div>
<div class="section" id="tuning-queries">
<span id="tuning-queries"></span><h4>Tuning queries<a class="headerlink" href="#tuning-queries" title="このヘッドラインへのパーマリンク">¶</a></h4>
<p>It is frequently useful to be able to exert a bit more control over substructure queries without
having to construct complex SMARTS queries. The cartridge function <code class="docutils literal"><span class="pre">mol_adjust_query_properties()</span></code>
can be used to do just this. Here is an example of the default behavior, using aquery for 2,6 di-substituted pyridines:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">chembl_23</span><span class="o">=</span><span class="c1"># select molregno,m from rdk.mols where m@&gt;mol_adjust_query_properties(&#39;*c1cccc(NC(=O)*)n1&#39;) limit 10;</span>
 <span class="n">molregno</span> <span class="o">|</span>                                             <span class="n">m</span>                                             
<span class="o">----------+-------------------------------------------------------------------------------------------</span>
  <span class="mi">1993749</span> <span class="o">|</span> <span class="n">Cn1c</span><span class="p">(</span><span class="n">Nc2c</span><span class="p">(</span><span class="n">Cl</span><span class="p">)</span><span class="n">ccc</span><span class="p">(</span><span class="n">CNC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="n">C</span><span class="p">)(</span><span class="n">C</span><span class="p">)</span><span class="n">C</span><span class="p">)</span><span class="n">c2Cl</span><span class="p">)</span><span class="n">nc2cc</span><span class="p">(</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">Nc3cccc</span><span class="p">(</span><span class="n">C</span><span class="p">(</span><span class="n">F</span><span class="p">)(</span><span class="n">F</span><span class="p">)</span><span class="n">F</span><span class="p">)</span><span class="n">n3</span><span class="p">)</span><span class="n">c</span><span class="p">(</span><span class="n">N3CCC</span><span class="p">(</span><span class="n">F</span><span class="p">)(</span><span class="n">F</span><span class="p">)</span><span class="n">C3</span><span class="p">)</span><span class="n">cc21</span>
  <span class="mi">1988455</span> <span class="o">|</span> <span class="n">Cc1cccc</span><span class="p">(</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">Nc2cccc</span><span class="p">(</span><span class="n">Oc3cccnc3</span><span class="p">)</span><span class="n">n2</span><span class="p">)</span><span class="n">c1</span>
  <span class="mi">1870095</span> <span class="o">|</span> <span class="n">COC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">CN</span><span class="p">(</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">c1c</span><span class="p">(</span><span class="n">F</span><span class="p">)</span><span class="n">cccc1F</span><span class="p">)</span><span class="n">c1cccc</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">n1</span>
  <span class="mi">1870023</span> <span class="o">|</span> <span class="n">CCC</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">(</span><span class="n">CC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">OC</span><span class="p">)</span><span class="n">c1cccc</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">n1</span>
  <span class="mi">1873944</span> <span class="o">|</span> <span class="n">Cc1ccc</span><span class="p">(</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">CC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">Nc2cccc</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">n2</span><span class="p">)</span><span class="n">cn1</span>
  <span class="mi">1873968</span> <span class="o">|</span> <span class="n">Cc1cccc</span><span class="p">(</span><span class="n">NC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">CN</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">c2ccc</span><span class="p">(</span><span class="o">-</span><span class="n">n3cccc3</span><span class="p">)</span><span class="n">nc2</span><span class="p">)</span><span class="n">n1</span>
  <span class="mi">1882693</span> <span class="o">|</span> <span class="n">Cc1cccc</span><span class="p">(</span><span class="n">NC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">CCNCc2c</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">nn</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">c2N</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">C</span><span class="p">)</span><span class="n">n1</span>
  <span class="mi">1882711</span> <span class="o">|</span> <span class="n">COc1c</span><span class="p">(</span><span class="n">CNCCC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">Nc2cccc</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">n2</span><span class="p">)</span><span class="n">c</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">nn1C</span>
  <span class="mi">1868705</span> <span class="o">|</span> <span class="n">CCOc1cccc</span><span class="p">(</span><span class="n">NC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">c2cnc</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">cn2</span><span class="p">)</span><span class="n">n1</span>
  <span class="mi">1875177</span> <span class="o">|</span> <span class="n">Cc1cccc</span><span class="p">(</span><span class="n">NC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">]</span><span class="mi">2</span><span class="n">CCCN2Cc2nc</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">c</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">o2</span><span class="p">)</span><span class="n">n1</span>
<span class="p">(</span><span class="mi">10</span> <span class="n">rows</span><span class="p">)</span>

<span class="n">Time</span><span class="p">:</span> <span class="mf">11.895</span> <span class="n">ms</span>
</pre></div>
</div>
<p>By default <code class="docutils literal"><span class="pre">mol_adjust_query_properties()</span></code> makes the following changes to the molecule:</p>
<ul class="simple">
<li>Converts dummy atoms into 「any」 queries</li>
<li>Adds a degree query to every ring atom so that its substitution must match what was provided</li>
<li>Aromaticity perception is done (if it hasn’t been done already)</li>
</ul>
<p>We can control the behavior by providing an additional JSON argument. Here’s an example
where we disable the additional degree queries:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">chembl_23</span><span class="o">=</span><span class="c1"># select molregno,m from rdk.mols where m@&gt;mol_adjust_query_properties(&#39;*c1cccc(NC(=O)*)n1&#39;,</span>
<span class="n">chembl_23</span><span class="p">(</span><span class="c1"># &#39;{&quot;adjustDegree&quot;:false}&#39;) limit 10;</span>
 <span class="n">molregno</span> <span class="o">|</span>                                             <span class="n">m</span>                                             
<span class="o">----------+-------------------------------------------------------------------------------------------</span>
  <span class="mi">1993749</span> <span class="o">|</span> <span class="n">Cn1c</span><span class="p">(</span><span class="n">Nc2c</span><span class="p">(</span><span class="n">Cl</span><span class="p">)</span><span class="n">ccc</span><span class="p">(</span><span class="n">CNC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="n">C</span><span class="p">)(</span><span class="n">C</span><span class="p">)</span><span class="n">C</span><span class="p">)</span><span class="n">c2Cl</span><span class="p">)</span><span class="n">nc2cc</span><span class="p">(</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">Nc3cccc</span><span class="p">(</span><span class="n">C</span><span class="p">(</span><span class="n">F</span><span class="p">)(</span><span class="n">F</span><span class="p">)</span><span class="n">F</span><span class="p">)</span><span class="n">n3</span><span class="p">)</span><span class="n">c</span><span class="p">(</span><span class="n">N3CCC</span><span class="p">(</span><span class="n">F</span><span class="p">)(</span><span class="n">F</span><span class="p">)</span><span class="n">C3</span><span class="p">)</span><span class="n">cc21</span>
  <span class="mi">1957849</span> <span class="o">|</span> <span class="n">COc1ccc2ncc</span><span class="p">(</span><span class="n">F</span><span class="p">)</span><span class="n">c</span><span class="p">(</span><span class="n">C</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">O</span><span class="p">)</span><span class="n">C3CCC</span><span class="p">(</span><span class="n">NCc4nc5c</span><span class="p">(</span><span class="n">cc4F</span><span class="p">)</span><span class="n">OCC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N5</span><span class="p">)</span><span class="n">CO3</span><span class="p">)</span><span class="n">c2n1</span>
  <span class="mi">1959611</span> <span class="o">|</span> <span class="n">O</span><span class="o">=</span><span class="n">C1COc2ccc</span><span class="p">(</span><span class="n">CNC3CCN</span><span class="p">(</span><span class="n">CCn4c</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">ccc5ncc</span><span class="p">(</span><span class="n">OCc6cccnn6</span><span class="p">)</span><span class="n">cc54</span><span class="p">)</span><span class="n">CC3</span><span class="p">)</span><span class="n">nc2N1</span>
  <span class="mi">1988455</span> <span class="o">|</span> <span class="n">Cc1cccc</span><span class="p">(</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">Nc2cccc</span><span class="p">(</span><span class="n">Oc3cccnc3</span><span class="p">)</span><span class="n">n2</span><span class="p">)</span><span class="n">c1</span>
  <span class="mi">1870095</span> <span class="o">|</span> <span class="n">COC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">CN</span><span class="p">(</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">c1c</span><span class="p">(</span><span class="n">F</span><span class="p">)</span><span class="n">cccc1F</span><span class="p">)</span><span class="n">c1cccc</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">n1</span>
  <span class="mi">1870023</span> <span class="o">|</span> <span class="n">CCC</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">(</span><span class="n">CC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">OC</span><span class="p">)</span><span class="n">c1cccc</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">n1</span>
  <span class="mi">1873944</span> <span class="o">|</span> <span class="n">Cc1ccc</span><span class="p">(</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">CC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">Nc2cccc</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">n2</span><span class="p">)</span><span class="n">cn1</span>
  <span class="mi">1873968</span> <span class="o">|</span> <span class="n">Cc1cccc</span><span class="p">(</span><span class="n">NC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">CN</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">c2ccc</span><span class="p">(</span><span class="o">-</span><span class="n">n3cccc3</span><span class="p">)</span><span class="n">nc2</span><span class="p">)</span><span class="n">n1</span>
  <span class="mi">1882693</span> <span class="o">|</span> <span class="n">Cc1cccc</span><span class="p">(</span><span class="n">NC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">CCNCc2c</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">nn</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">c2N</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">C</span><span class="p">)</span><span class="n">n1</span>
  <span class="mi">1882711</span> <span class="o">|</span> <span class="n">COc1c</span><span class="p">(</span><span class="n">CNCCC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">Nc2cccc</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">n2</span><span class="p">)</span><span class="n">c</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">nn1C</span>
<span class="p">(</span><span class="mi">10</span> <span class="n">rows</span><span class="p">)</span>

<span class="n">Time</span><span class="p">:</span> <span class="mf">10.780</span> <span class="n">ms</span>
</pre></div>
</div>
<p>or where we don’t add the additional degree queries to ring atoms or dummies (they are only
added to chain atoms):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">chembl_23</span><span class="o">=</span><span class="c1"># select molregno,m from rdk.mols where m@&gt;mol_adjust_query_properties(&#39;*c1cccc(NC(=O)*)n1&#39;,</span>
<span class="n">chembl_23</span><span class="p">(</span><span class="c1"># &#39;{&quot;adjustDegree&quot;:true,&quot;adjustDegreeFlags&quot;:&quot;IGNORERINGS|IGNOREDUMMIES&quot;}&#39;) limit 10;</span>
 <span class="n">molregno</span> <span class="o">|</span>                                             <span class="n">m</span>                                             
<span class="o">----------+-------------------------------------------------------------------------------------------</span>
  <span class="mi">1993749</span> <span class="o">|</span> <span class="n">Cn1c</span><span class="p">(</span><span class="n">Nc2c</span><span class="p">(</span><span class="n">Cl</span><span class="p">)</span><span class="n">ccc</span><span class="p">(</span><span class="n">CNC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="n">C</span><span class="p">)(</span><span class="n">C</span><span class="p">)</span><span class="n">C</span><span class="p">)</span><span class="n">c2Cl</span><span class="p">)</span><span class="n">nc2cc</span><span class="p">(</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">Nc3cccc</span><span class="p">(</span><span class="n">C</span><span class="p">(</span><span class="n">F</span><span class="p">)(</span><span class="n">F</span><span class="p">)</span><span class="n">F</span><span class="p">)</span><span class="n">n3</span><span class="p">)</span><span class="n">c</span><span class="p">(</span><span class="n">N3CCC</span><span class="p">(</span><span class="n">F</span><span class="p">)(</span><span class="n">F</span><span class="p">)</span><span class="n">C3</span><span class="p">)</span><span class="n">cc21</span>
  <span class="mi">1957849</span> <span class="o">|</span> <span class="n">COc1ccc2ncc</span><span class="p">(</span><span class="n">F</span><span class="p">)</span><span class="n">c</span><span class="p">(</span><span class="n">C</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">O</span><span class="p">)</span><span class="n">C3CCC</span><span class="p">(</span><span class="n">NCc4nc5c</span><span class="p">(</span><span class="n">cc4F</span><span class="p">)</span><span class="n">OCC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N5</span><span class="p">)</span><span class="n">CO3</span><span class="p">)</span><span class="n">c2n1</span>
  <span class="mi">1959611</span> <span class="o">|</span> <span class="n">O</span><span class="o">=</span><span class="n">C1COc2ccc</span><span class="p">(</span><span class="n">CNC3CCN</span><span class="p">(</span><span class="n">CCn4c</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">ccc5ncc</span><span class="p">(</span><span class="n">OCc6cccnn6</span><span class="p">)</span><span class="n">cc54</span><span class="p">)</span><span class="n">CC3</span><span class="p">)</span><span class="n">nc2N1</span>
  <span class="mi">1988455</span> <span class="o">|</span> <span class="n">Cc1cccc</span><span class="p">(</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">Nc2cccc</span><span class="p">(</span><span class="n">Oc3cccnc3</span><span class="p">)</span><span class="n">n2</span><span class="p">)</span><span class="n">c1</span>
  <span class="mi">1873944</span> <span class="o">|</span> <span class="n">Cc1ccc</span><span class="p">(</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">CC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">Nc2cccc</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">n2</span><span class="p">)</span><span class="n">cn1</span>
  <span class="mi">1873968</span> <span class="o">|</span> <span class="n">Cc1cccc</span><span class="p">(</span><span class="n">NC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">CN</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">c2ccc</span><span class="p">(</span><span class="o">-</span><span class="n">n3cccc3</span><span class="p">)</span><span class="n">nc2</span><span class="p">)</span><span class="n">n1</span>
  <span class="mi">1882693</span> <span class="o">|</span> <span class="n">Cc1cccc</span><span class="p">(</span><span class="n">NC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">CCNCc2c</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">nn</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">c2N</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">C</span><span class="p">)</span><span class="n">n1</span>
  <span class="mi">1882711</span> <span class="o">|</span> <span class="n">COc1c</span><span class="p">(</span><span class="n">CNCCC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">Nc2cccc</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">n2</span><span class="p">)</span><span class="n">c</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">nn1C</span>
  <span class="mi">1884388</span> <span class="o">|</span> <span class="n">Cc1noc</span><span class="p">(</span><span class="n">COCC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">Nc2ccc</span><span class="p">(</span><span class="n">Br</span><span class="p">)</span><span class="n">c</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">n2</span><span class="p">)</span><span class="n">n1</span>
  <span class="mi">1868705</span> <span class="o">|</span> <span class="n">CCOc1cccc</span><span class="p">(</span><span class="n">NC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">c2cnc</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">cn2</span><span class="p">)</span><span class="n">n1</span>
<span class="p">(</span><span class="mi">10</span> <span class="n">rows</span><span class="p">)</span>

<span class="n">Time</span><span class="p">:</span> <span class="mf">12.827</span> <span class="n">ms</span>
</pre></div>
</div>
<p>The options available are:</p>
<ul class="simple">
<li><strong>adjustDegree</strong> (default: true) : adds a query to match the input atomic degree</li>
<li><strong>adjustDegreeFlags</strong> (default: ADJUST_IGNOREDUMMIES | ADJUST_IGNORECHAINS) controls where the degree is adjusted</li>
<li><strong>adjustRingCount</strong> (default: false) : adds a query to match the input ring count</li>
<li><strong>adjustRingCountFlags</strong> (default: ADJUST_IGNOREDUMMIES | ADJUST_IGNORECHAINS) controls where the ring count is adjusted</li>
<li><strong>makeDummiesQueries</strong> (default: true) : convert dummy atoms in the input structure into any-atom queries</li>
<li><strong>aromatizeIfPossible</strong> (default: true) : run the aromaticity perception algorithm on the input structure (note: this is largely redundant since molecules built from smiles always have aromaticity perceived)</li>
<li><strong>makeBondsGeneric</strong> (default: false) : convert bonds into any-bond queries</li>
<li><strong>makeBondsGenericFlags</strong> (default: false) : controls which bonds are made generic</li>
<li><strong>makeAtomsGeneric</strong> (default: false) : convert atoms into any-atom queries</li>
<li><strong>makeAtomsGenericFlags</strong> (default: false) : controls which atoms are made generic</li>
</ul>
<p>The various <code class="docutils literal"><span class="pre">Flags</span></code> arguments mentioned above, which control where particular options are applied,
are constructed by combining operations from the list below with the <code class="docutils literal"><span class="pre">|</span></code> character.</p>
<ul class="simple">
<li><strong>IGNORENONE</strong> : apply the operation to all atoms</li>
<li><strong>IGNORERINGS</strong> : do not apply the operation to ring atoms</li>
<li><strong>IGNORECHAINS</strong> : do not apply the operation to chain atoms</li>
<li><strong>IGNOREDUMMIES</strong> : do not apply the operation to dummy atoms</li>
<li><strong>IGNORENONDUMMIES</strong> : do not apply the operation to non-dummy atoms</li>
<li><strong>IGNOREALL</strong> : do not apply the operation to any atoms</li>
</ul>
</div>
</div>
<div class="section" id="similarity-searches">
<span id="similarity-searches"></span><h3>Similarity searches<a class="headerlink" href="#similarity-searches" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Basic similarity searching:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">chembl_23</span><span class="o">=</span><span class="c1"># select count(*) from rdk.fps where mfp2%morganbv_fp(&#39;Cc1ccc2nc(-c3ccc(NC(C4N(C(c5cccs5)=O)CCC4)=O)cc3)sc2c1&#39;);</span>
 <span class="n">count</span>
<span class="o">-------</span>
    <span class="mi">67</span>
<span class="p">(</span><span class="mi">1</span> <span class="n">row</span><span class="p">)</span>

<span class="n">Time</span><span class="p">:</span> <span class="mf">177.579</span> <span class="n">ms</span>
</pre></div>
</div>
<p>Usually we’d like to find a sorted listed of neighbors along with the accompanying SMILES. This SQL function makes that pattern easy:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>chembl_23=# create or replace function get_mfp2_neighbors(smiles text)
    returns table(molregno integer, m mol, similarity double precision) as
  $$
  select molregno,m,tanimoto_sml(morganbv_fp(mol_from_smiles($1::cstring)),mfp2) as similarity
  from rdk.fps join rdk.mols using (molregno)
  where morganbv_fp(mol_from_smiles($1::cstring))%mfp2
  order by morganbv_fp(mol_from_smiles($1::cstring))&lt;%&gt;mfp2;
  $$ language sql stable ;
CREATE FUNCTION
Time: 0.856 ms
chembl_23=# select * from get_mfp2_neighbors(&#39;Cc1ccc2nc(-c3ccc(NC(C4N(C(c5cccs5)=O)CCC4)=O)cc3)sc2c1&#39;) limit 10;
 molregno |                             m                              |    similarity     
----------+------------------------------------------------------------+-------------------
   471319 | Cc1ccc2nc(-c3ccc(NC(=O)C4CCN(S(=O)(=O)c5cccs5)C4)cc3)sc2c1 | 0.638888888888889
  1032469 | O=C(Nc1nc2ccc(Cl)cc2s1)[C@@H]1CCCN1C(=O)c1cccs1            | 0.623188405797101
   751668 | COc1ccc2nc(NC(=O)[C@@H]3CCCN3C(=O)c3cccs3)sc2c1            | 0.619718309859155
   471318 | Cc1ccc2nc(-c3ccc(NC(=O)C4CN(S(=O)(=O)c5cccs5)C4)cc3)sc2c1  | 0.611111111111111
   740754 | Cc1ccc(NC(=O)C2CCCN2C(=O)c2cccs2)cc1C                      | 0.606060606060606
   732905 | O=C(Nc1ccc(S(=O)(=O)N2CCCC2)cc1)C1CCCN1C(=O)c1cccs1        | 0.602941176470588
  1087495 | Cc1ccc(NC(=O)C2CCCN2C(=O)c2cccs2)c(C)c1                    | 0.597014925373134
   471462 | CCS(=O)(=O)N1CCC(C(=O)Nc2ccc(-c3nc4ccc(C)cc4s3)cc2)CC1     | 0.585714285714286
   810850 | Cc1cc(C)n(-c2ccc(NC(=O)C3CCCCN3C(=O)c3cccs3)cc2)n1         | 0.583333333333333
  1224407 | O=C(Nc1cccc(S(=O)(=O)N2CCCC2)c1)C1CCCN1C(=O)c1cccs1        | 0.579710144927536
(10 rows)

Time: 28.909 ms
chembl_23=# select * from get_mfp2_neighbors(&#39;Cc1ccc2nc(N(C)CC(=O)O)sc2c1&#39;) limit 10;
 molregno |                           m                           |    similarity     
----------+-------------------------------------------------------+-------------------
  1044892 | Cc1ccc2nc(N(CCN(C)C)C(=O)c3cc(Cl)sc3Cl)sc2c1          | 0.518518518518518
  1040496 | Cc1ccc2nc(N(CCCN(C)C)C(=O)CCc3ccccc3)sc2c1            | 0.517857142857143
  1049393 | Cc1ccc2nc(N(CCCN(C)C)C(=O)CS(=O)(=O)c3ccccc3)sc2c1    | 0.517857142857143
   441378 | Cc1ccc2nc(NC(=O)CCC(=O)O)sc2c1                        | 0.510204081632653
  1047691 | Cc1ccc(S(=O)(=O)CC(=O)N(CCCN(C)C)c2nc3ccc(C)cc3s2)cc1 | 0.509090909090909
   911501 | Cc1ccc2nc(N(CCN(C)C)C(=O)c3cc(Cl)sc3Cl)sc2c1.Cl       | 0.509090909090909
  1042958 | Cc1ccc2nc(N(CCN(C)C)C(=O)c3ccc4ccccc4c3)sc2c1         | 0.509090909090909
   775269 | Cc1ccc2nc(N(CCCN(C)C)C(=O)CCc3ccccc3)sc2c1.Cl         | 0.508771929824561
  1045663 | Cc1ccc2nc(N(CCCN(C)C)C(=O)COc3ccc(Cl)cc3)sc2c1        |               0.5
  1015485 | Cc1ccc2nc(N(Cc3cccnc3)C(=O)Cc3ccccc3)sc2c1            |               0.5
(10 rows)

Time: 41.623 ms
</pre></div>
</div>
<div class="section" id="adjusting-the-similarity-cutoff">
<span id="adjusting-the-similarity-cutoff"></span><h4>Adjusting the similarity cutoff<a class="headerlink" href="#adjusting-the-similarity-cutoff" title="このヘッドラインへのパーマリンク">¶</a></h4>
<p>By default, the minimum similarity returned with a similarity search is 0.5. This can be adjusted with the rdkit.tanimoto_threshold (and rdkit.dice_threshold) configuration variables:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">chembl_23</span><span class="o">=</span><span class="c1"># select count(*) from get_mfp2_neighbors(&#39;Cc1ccc2nc(N(C)CC(=O)O)sc2c1&#39;);</span>
 <span class="n">count</span>
<span class="o">-------</span>
    <span class="mi">20</span>
<span class="p">(</span><span class="mi">1</span> <span class="n">row</span><span class="p">)</span>

<span class="n">Time</span><span class="p">:</span> <span class="mf">181.438</span> <span class="n">ms</span>
<span class="n">chembl_23</span><span class="o">=</span><span class="c1"># set rdkit.tanimoto_threshold=0.7;</span>
<span class="n">SET</span>
<span class="n">Time</span><span class="p">:</span> <span class="mf">0.047</span> <span class="n">ms</span>
<span class="n">chembl_23</span><span class="o">=</span><span class="c1"># select count(*) from get_mfp2_neighbors(&#39;Cc1ccc2nc(N(C)CC(=O)O)sc2c1&#39;);</span>
 <span class="n">count</span>
<span class="o">-------</span>
     <span class="mi">0</span>
<span class="p">(</span><span class="mi">1</span> <span class="n">row</span><span class="p">)</span>

<span class="n">Time</span><span class="p">:</span> <span class="mf">161.228</span> <span class="n">ms</span>
<span class="n">chembl_23</span><span class="o">=</span><span class="c1"># set rdkit.tanimoto_threshold=0.6;</span>
<span class="n">SET</span>
<span class="n">Time</span><span class="p">:</span> <span class="mf">0.045</span> <span class="n">ms</span>
<span class="n">chembl_23</span><span class="o">=</span><span class="c1"># select count(*) from get_mfp2_neighbors(&#39;Cc1ccc2nc(N(C)CC(=O)O)sc2c1&#39;);</span>
 <span class="n">count</span>
<span class="o">-------</span>
     <span class="mi">1</span>
<span class="p">(</span><span class="mi">1</span> <span class="n">row</span><span class="p">)</span>

<span class="n">Time</span><span class="p">:</span> <span class="mf">184.275</span> <span class="n">ms</span>
<span class="n">chembl_23</span><span class="o">=</span><span class="c1"># set rdkit.tanimoto_threshold=0.5;</span>
<span class="n">SET</span>
<span class="n">Time</span><span class="p">:</span> <span class="mf">0.055</span> <span class="n">ms</span>
<span class="n">chembl_23</span><span class="o">=</span><span class="c1"># select count(*) from get_mfp2_neighbors(&#39;Cc1ccc2nc(N(C)CC(=O)O)sc2c1&#39;);</span>
 <span class="n">count</span>
<span class="o">-------</span>
    <span class="mi">20</span>
<span class="p">(</span><span class="mi">1</span> <span class="n">row</span><span class="p">)</span>

<span class="n">Time</span><span class="p">:</span> <span class="mf">181.100</span> <span class="n">ms</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="using-the-mcs-code">
<span id="using-the-mcs-code"></span><h3>Using the MCS code<a class="headerlink" href="#using-the-mcs-code" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>The most straightforward use of the MCS code is to find the maximum common substructure of a group of molecules:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">chembl_23</span><span class="o">=</span><span class="c1"># select fmcs(m::text) from rdk.mols join compound_records using (molregno) where doc_id=4;</span>
                                  <span class="n">fmcs</span>                                  
<span class="o">------------------------------------------------------------------------</span>
 <span class="p">[</span><span class="c1">#6](-[#6]-[#7]-[#6]-[#6](-,:[#6])-,:[#6])-,:[#6]-,:[#6]-,:[#6]-,:[#6]</span>
<span class="p">(</span><span class="mi">1</span> <span class="n">row</span><span class="p">)</span>

<span class="n">Time</span><span class="p">:</span> <span class="mf">31.041</span> <span class="n">ms</span>
<span class="n">chembl_23</span><span class="o">=</span><span class="c1"># select fmcs(m::text) from rdk.mols join compound_records using (molregno) where doc_id=5;</span>
                                                                   <span class="n">fmcs</span>                                                                   
<span class="o">------------------------------------------------------------------------------------------------------------------------------------------</span>
 <span class="p">[</span><span class="c1">#6]-[#6](=[#8])-[#7]-[#6](-[#6](=[#8])-[#7]1-[#6]-[#6]-[#6]-[#6]-1-[#6](=[#8])-[#7]-[#6](-[#6](=[#8])-[#8])-[#6]-[#6])-[#6](-[#6])-[#6]</span>
<span class="p">(</span><span class="mi">1</span> <span class="n">row</span><span class="p">)</span>

<span class="n">Time</span><span class="p">:</span> <span class="mf">705.535</span> <span class="n">ms</span>
</pre></div>
</div>
<p>The same thing can be done with a SMILES column:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">chembl_23</span><span class="o">=</span><span class="c1"># select fmcs(canonical_smiles) from compound_structures join compound_records using (molregno) where doc_id=4;</span>
                                  <span class="n">fmcs</span>                                  
<span class="o">------------------------------------------------------------------------</span>
 <span class="p">[</span><span class="c1">#6](-[#7]-[#6]-[#6]-,:[#6]-,:[#6]-,:[#6]-,:[#6])-[#6](-,:[#6])-,:[#6]</span>
<span class="p">(</span><span class="mi">1</span> <span class="n">row</span><span class="p">)</span>

<span class="n">Time</span><span class="p">:</span> <span class="mf">128.879</span> <span class="n">ms</span>
</pre></div>
</div>
<p>It’s also possible to adjust some of the parameters to the FMCS algorithm, though this is somewhat more painful as of this writing (the 2017_03 release cycle). Here are a couple of examples:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">chembl_23</span><span class="o">=</span><span class="c1"># select fmcs_smiles(str,&#39;{&quot;Threshold&quot;:0.8}&#39;) from</span>
<span class="n">chembl_23</span><span class="o">-</span><span class="c1">#    (select string_agg(m::text,&#39; &#39;) as str from rdk.mols</span>
<span class="n">chembl_23</span><span class="p">(</span><span class="c1">#    join compound_records using (molregno) where doc_id=4) as str ;</span>

                                                                           <span class="n">fmcs_smiles</span>                                                                            
<span class="o">------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
 <span class="p">[</span><span class="c1">#6]-[#6]-[#8]-[#6](-[#6](=[#8])-[#7]-[#6](-[#6])-[#6](-,:[#6])-,:[#6])-[#6](-[#8])-[#6](-[#8])-[#6](-[#8]-[#6]-[#6])-[#6]-[#7]-[#6](-[#6])-[#6](-,:[#6])-,:[#6]</span>
<span class="p">(</span><span class="mi">1</span> <span class="n">row</span><span class="p">)</span>

<span class="n">Time</span><span class="p">:</span> <span class="mf">9673.949</span> <span class="n">ms</span>
<span class="n">chembl_23</span><span class="o">=</span><span class="c1">#</span>
<span class="n">chembl_23</span><span class="o">=</span><span class="c1"># select fmcs_smiles(str,&#39;{&quot;AtomCompare&quot;:&quot;Any&quot;}&#39;) from</span>
<span class="n">chembl_23</span><span class="o">-</span><span class="c1">#    (select string_agg(m::text,&#39; &#39;) as str from rdk.mols</span>
<span class="n">chembl_23</span><span class="p">(</span><span class="c1">#    join compound_records using (molregno) where doc_id=4) as str ;</span>
                                                                              <span class="n">fmcs_smiles</span>                                                                               
<span class="o">------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
 <span class="p">[</span><span class="c1">#6]-,:[#6,#7]-[#8,#6]-[#6,#7](-[#6,#8]-[#7,#6]-,:[#6,#7]-,:[#6,#7]-,:[#7,#6]-,:[#6])-[#6,#7]-[#6]-[#6](-[#8,#6]-[#6])-[#6,#7]-[#7,#6]-[#6]-,:[#6,#8]-,:[#7,#6]-,:[#6]</span>
<span class="p">(</span><span class="mi">1</span> <span class="n">row</span><span class="p">)</span>

<span class="n">Time</span><span class="p">:</span> <span class="mf">304.332</span> <span class="n">ms</span>
</pre></div>
</div>
<p><em>Note</em> The combination of <code class="docutils literal"><span class="pre">&quot;AtomCompare&quot;:&quot;Any&quot;</span></code> and a value of <code class="docutils literal"><span class="pre">&quot;Threshold&quot;</span></code> that is less than 1.0 does a quite generic search and can results in very long search times. Using <code class="docutils literal"><span class="pre">&quot;Timeout&quot;</span></code> with this combination is recommended:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">chembl_23</span><span class="o">=</span><span class="c1"># select fmcs_smiles(str,&#39;{&quot;AtomCompare&quot;:&quot;Any&quot;,&quot;CompleteRingsOnly&quot;:true,&quot;Threshold&quot;:0.8,&quot;Timeout&quot;:60}&#39;) from</span>
<span class="n">chembl_23</span><span class="o">-</span><span class="c1">#    (select string_agg(m::text,&#39; &#39;) as str from rdk.mols</span>
<span class="n">chembl_23</span><span class="p">(</span><span class="c1">#    join compound_records using (molregno) where doc_id=3) as str ;</span>

<span class="n">WARNING</span><span class="p">:</span>  <span class="n">findMCS</span> <span class="n">timed</span> <span class="n">out</span><span class="p">,</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">maximal</span>
                                                                                          <span class="n">fmcs_smiles</span>                                                                    

<span class="o">-------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="o">----------------------</span>
 <span class="p">[</span><span class="c1">#8]=[#6](-[#7]-[#6]1:[#6]:[#6]:[#6](:[#6]:[#6]:1)-[#6](=[#8])-[#7]1-[#6]-[#6]-[#6]-[#6,#7]-[#6]2:[#6]-1:[#6]:[#6]:[#16]:2)-[#6]1:[#6]:[#6]:[#6]:[#6]:[#6]:1-[#6]1:[#6]:</span>
<span class="p">[</span><span class="c1">#6]:[#6]:[#6]:[#6]:1</span>
<span class="p">(</span><span class="mi">1</span> <span class="n">row</span><span class="p">)</span>

<span class="n">Time</span><span class="p">:</span> <span class="mf">60479.753</span> <span class="n">ms</span>
</pre></div>
</div>
<p>Available parameters and their default values are:</p>
<blockquote>
<div><ul class="simple">
<li>MaximizeBonds (true)</li>
<li>Threshold (1.0)</li>
<li>Timeout (-1, no timeout)</li>
<li>MatchValences (false)</li>
<li>MatchChiralTag (false) Applies to atoms</li>
<li>RingMatchesRingOnly (false)</li>
<li>CompleteRingsOnly (false)</li>
<li>MatchStereo (false) Applies to bonds</li>
<li>AtomCompare (「Elements」) can be 「Elements」, 「Isotopes」, or 「Any」</li>
<li>BondCompare (「Order」) can be 「Order」, 「OrderExact」, or 「Any」</li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="reference-guide">
<span id="reference-guide"></span><h2>Reference Guide<a class="headerlink" href="#reference-guide" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="section" id="new-types">
<span id="new-types"></span><h3>New Types<a class="headerlink" href="#new-types" title="このヘッドラインへのパーマリンク">¶</a></h3>
<ul class="simple">
<li>mol : an rdkit molecule. Can be created from a SMILES via direct type conversion, for example: 『c1ccccc1』::mol creates a molecule from the SMILES 『c1ccccc1』</li>
<li>qmol : an rdkit molecule containing query features (i.e. constructed from SMARTS). Can be created from a SMARTS via direct type conversion, for example: 『c1cccc[c,n]1』::qmol creates a query molecule from the SMARTS 『c1cccc[c,n]1』</li>
<li>sfp : a sparse count vector fingerprint (SparseIntVect in C++ and Python)</li>
<li>bfp : a bit vector fingerprint (ExplicitBitVect in C++ and Python)</li>
</ul>
</div>
<div class="section" id="parameters">
<span id="parameters"></span><h3>Parameters<a class="headerlink" href="#parameters" title="このヘッドラインへのパーマリンク">¶</a></h3>
<ul class="simple">
<li>rdkit.tanimoto_threshold : threshold value for the Tanimoto similarity operator. Searches done using Tanimoto similarity will only return results with a similarity of at least this value.</li>
<li>rdkit.dice_threshold : threshold value for the Dice similiarty operator. Searches done using Dice similarity will only return results with a similarity of at least this value.</li>
<li>rdkit.do_chiral_sss : toggles whether or not stereochemistry is used in substructure matching. (<em>available from 2013_03 release</em>).</li>
<li>rdkit.sss_fp_size : the size (in bits) of the fingerprint used for substructure screening.</li>
<li>rdkit.morgan_fp_size : the size (in bits) of morgan fingerprints</li>
<li>rdkit.featmorgan_fp_size : the size (in bits) of featmorgan fingerprints</li>
<li>rdkit.layered_fp_size : the size (in bits) of layered fingerprints</li>
<li>rdkit.rdkit_fp_size : the size (in bits) of RDKit fingerprints</li>
<li>rdkit.torsion_fp_size : the size (in bits) of topological torsion bit vector fingerprints</li>
<li>rdkit.atompair_fp_size : the size (in bits) of atom pair bit vector fingerprints</li>
<li>rdkit.avalon_fp_size : the size (in bits) of avalon fingerprints</li>
</ul>
</div>
<div class="section" id="operators">
<span id="operators"></span><h3>Operators<a class="headerlink" href="#operators" title="このヘッドラインへのパーマリンク">¶</a></h3>
<div class="section" id="similarity-search">
<span id="similarity-search"></span><h4>Similarity search<a class="headerlink" href="#similarity-search" title="このヘッドラインへのパーマリンク">¶</a></h4>
<ul class="simple">
<li>% : operator used for similarity searches using Tanimoto similarity. Returns whether or not the Tanimoto similarity between two fingerprints (either two sfp or two bfp values) exceeds rdkit.tanimoto_threshold.</li>
<li># : operator used for similarity searches using Dice similarity. Returns whether or not the Dice similarity between two fingerprints (either two sfp or two bfp values) exceeds rdkit.dice_threshold.</li>
<li>&lt;%&gt; : used for Tanimoto KNN searches (to return ordered lists of neighbors).</li>
<li>&lt;#&gt; : used for Dice KNN searches (to return ordered lists of neighbors).</li>
</ul>
</div>
<div class="section" id="substructure-and-exact-structure-search">
<span id="substructure-and-exact-structure-search"></span><h4>Substructure and exact structure search<a class="headerlink" href="#substructure-and-exact-structure-search" title="このヘッドラインへのパーマリンク">¶</a></h4>
<ul class="simple">
<li>&#64;&gt; : substructure search operator. Returns whether or not the mol or qmol on the right is a substructure of the mol on the left.</li>
<li>&lt;&#64; : substructure search operator. Returns whether or not the mol or qmol on the left is a substructure of the mol on the right.</li>
<li>&#64;= : returns whether or not two molecules are the same.</li>
</ul>
</div>
<div class="section" id="molecule-comparison">
<span id="molecule-comparison"></span><h4>Molecule comparison<a class="headerlink" href="#molecule-comparison" title="このヘッドラインへのパーマリンク">¶</a></h4>
<ul class="simple">
<li>&lt; : returns whether or not the left mol is less than the right mol</li>
<li>&gt; : returns whether or not the left mol is greater than the right mol</li>
<li>= : returns whether or not the left mol is equal to the right mol</li>
<li>&lt;= : returns whether or not the left mol is less than or equal to the right mol</li>
<li>&gt;= : returns whether or not the left mol is greater than or equal to the right mol</li>
</ul>
<p><em>Note</em> Two molecules are compared by making the following comparisons in order. Later comparisons are only made if the preceding values are equal:</p>
<p># Number of atoms # Number of bonds # Molecular weight # Number of rings</p>
<p>If all of the above are the same and the second molecule is a substructure of the first, the molecules are declared equal, Otherwise (should not happen) the first molecule is arbitrarily defined to be less than the second.</p>
<p>There are additional operators defined in the cartridge, but these are used for internal purposes.</p>
</div>
</div>
<div class="section" id="functions">
<span id="functions"></span><h3>Functions<a class="headerlink" href="#functions" title="このヘッドラインへのパーマリンク">¶</a></h3>
<div class="section" id="fingerprint-related">
<span id="fingerprint-related"></span><h4>Fingerprint Related<a class="headerlink" href="#fingerprint-related" title="このヘッドラインへのパーマリンク">¶</a></h4>
<div class="section" id="generating-fingerprints">
<span id="generating-fingerprints"></span><h5>Generating fingerprints<a class="headerlink" href="#generating-fingerprints" title="このヘッドラインへのパーマリンク">¶</a></h5>
<ul class="simple">
<li>morgan_fp(mol,int default 2) : returns an sfp which is the count-based Morgan fingerprint for a molecule using connectivity invariants. The second argument provides the radius. This is an ECFP-like fingerprint.</li>
<li>morganbv_fp(mol,int default 2) : returns a bfp which is the bit vector Morgan fingerprint for a molecule using connectivity invariants. The second argument provides the radius. This is an ECFP-like fingerprint.</li>
<li>featmorgan_fp(mol,int default 2) : returns an sfp which is the count-based Morgan fingerprint for a molecule using chemical-feature invariants. The second argument provides the radius. This is an FCFP-like fingerprint.</li>
<li>featmorganbv_fp(mol,int default 2) : returns a bfp which is the bit vector Morgan fingerprint for a molecule using chemical-feature invariants. The second argument provides the radius. This is an FCFP-like fingerprint.</li>
<li>rdkit_fp(mol) : returns a bfp which is the RDKit fingerprint for a molecule. This is a daylight-fingerprint using hashed molecular subgraphs.</li>
<li>atompair_fp(mol) : returns an sfp which is the count-based atom-pair fingerprint for a molecule.</li>
<li>atompairbv_fp(mol) : returns a bfp which is the bit vector atom-pair fingerprint for a molecule.</li>
<li>torsion_fp(mol) : returns an sfp which is the count-based topological-torsion fingerprint for a molecule.</li>
<li>torsionbv_fp(mol) : returns a bfp which is the bit vector topological-torsion fingerprint for a molecule.</li>
<li>layered_fp(mol) : returns a bfp which is the layered fingerprint for a molecule. This is an experimental substructure fingerprint using hashed molecular subgraphs.</li>
<li>maccs_fp(mol) : returns a bfp which is the MACCS fingerprint for a molecule (<em>available from 2013_01 release</em>).</li>
</ul>
</div>
<div class="section" id="working-with-fingerprints">
<span id="working-with-fingerprints"></span><h5>Working with fingerprints<a class="headerlink" href="#working-with-fingerprints" title="このヘッドラインへのパーマリンク">¶</a></h5>
<ul class="simple">
<li>tanimoto_sml(fp,fp) : returns the Tanimoto similarity between two fingerprints of the same type (either two sfp or two bfp values).</li>
<li>dice_sml(fp,fp) : returns the Dice similarity between two fingerprints of the same type (either two sfp or two bfp values).</li>
<li>size(bfp) : returns the length of (number of bits in) a bfp.</li>
<li>add(sfp,sfp) : returns an sfp formed by the element-wise addition of the two sfp arguments.</li>
<li>subtract(sfp,sfp) : returns an sfp formed by the element-wise subtraction of the two sfp arguments.</li>
<li>all_values_lt(sfp,int) : returns a boolean indicating whether or not all elements of the sfp argument are less than the int argument.</li>
<li>all_values_gt(sfp,int) : returns a boolean indicating whether or not all elements of the sfp argument are greater than the int argument.</li>
</ul>
</div>
<div class="section" id="fingerprint-i-o">
<span id="fingerprint-i-o"></span><h5>Fingerprint I/O<a class="headerlink" href="#fingerprint-i-o" title="このヘッドラインへのパーマリンク">¶</a></h5>
<ul class="simple">
<li>bfp_to_binary_text(bfp) : returns a bytea with the binary string representation of the fingerprint that can be converted back into an RDKit fingerprint in other software. (<em>available from Q3 2012 (2012_09) release</em>)</li>
<li>bfp_from_binary_text(bytea) : constructs a bfp from a binary string representation of the fingerprint. (<em>available from Q3 2012 (2012_09) release</em>)</li>
</ul>
</div>
</div>
<div class="section" id="molecule-related">
<span id="molecule-related"></span><h4>Molecule Related<a class="headerlink" href="#molecule-related" title="このヘッドラインへのパーマリンク">¶</a></h4>
<div class="section" id="molecule-i-o-and-validation">
<span id="molecule-i-o-and-validation"></span><h5>Molecule I/O and Validation<a class="headerlink" href="#molecule-i-o-and-validation" title="このヘッドラインへのパーマリンク">¶</a></h5>
<ul class="simple">
<li>is_valid_smiles(smiles) : returns whether or not a SMILES string produces a valid RDKit molecule.</li>
<li>is_valid_ctab(ctab) : returns whether or not a CTAB (mol block) string produces a valid RDKit molecule.</li>
<li>is_valid_smarts(smarts) : returns whether or not a SMARTS string produces a valid RDKit molecule.</li>
<li>is_valid_mol_pkl(bytea) : returns whether or not a binary string (bytea) can be converted into an RDKit molecule. (<em>available from Q3 2012 (2012_09) release</em>)</li>
<li>mol_from_smiles(smiles) : returns a molecule for a SMILES string, NULL if the molecule construction fails.</li>
<li>mol_from_smarts(smarts) : returns a molecule for a SMARTS string, NULL if the molecule construction fails.</li>
<li>mol_from_ctab(ctab, bool default false) : returns a molecule for a CTAB (mol block) string, NULL if the molecule construction fails. The optional second argument controls whether or not the molecule’s coordinates are saved.</li>
<li>mol_from_pkl(bytea) : returns a molecule for a binary string (bytea), NULL if the molecule construction fails. (<em>available from Q3 2012 (2012_09) release</em>)</li>
<li>qmol_from_smiles(smiles) : returns a query molecule for a SMILES string, NULL if the molecule construction fails. Explicit Hs in the SMILES are converted into query features on the attached atom.</li>
<li>qmol_from_ctab(ctab, bool default false) : returns a query molecule for a CTAB (mol block) string, NULL if the molecule construction fails. Explicit Hs in the SMILES are converted into query features on the attached atom. The optional second argument controls whether or not the molecule’s coordinates are saved.</li>
<li>mol_to_smiles(mol) : returns the canonical SMILES for a molecule.</li>
<li>mol_to_smarts(mol) : returns SMARTS string for a molecule.</li>
<li>mol_to_pkl(mol) : returns binary string (bytea) for a molecule. (<em>available from Q3 2012 (2012_09) release</em>)</li>
<li>mol_to_ctab(mol,bool default true) : returns a CTAB (mol block) string for a molecule. The optional second argument controls whether or not 2D coordinates will be generated for molecules that don’t have coordinates. (<em>available from the 2014_03 release</em>)</li>
<li>mol_to_svg(mol,string default 『』,int default 250, int default 200, string default 『』) : returns an SVG with a drawing of the molecule. The optional parameters are a string to use as the legend, the width of the image, the height of the image, and a JSON with additional rendering parameters. (<em>available from the 2016_09 release</em>)</li>
</ul>
</div>
<div class="section" id="substructure-operations">
<span id="substructure-operations"></span><h5>Substructure operations<a class="headerlink" href="#substructure-operations" title="このヘッドラインへのパーマリンク">¶</a></h5>
<ul class="simple">
<li>substruct(mol,mol) : returns whether or not the second mol is a substructure of the first.</li>
<li>substruct_count(mol,mol,bool default true) : returns the number of substructure matches between the second molecule and the first. The third argument toggles whether or not the matches are uniquified. (<em>available from 2013_03 release</em>)</li>
<li>mol_adjust_query_properties(mol,string default 『』) : returns a new molecule with additional query information attached. (<em>available from the 2016_09 release</em>)</li>
</ul>
</div>
<div class="section" id="descriptors">
<span id="descriptors"></span><h5>Descriptors<a class="headerlink" href="#descriptors" title="このヘッドラインへのパーマリンク">¶</a></h5>
<ul class="simple">
<li>mol_amw(mol) : returns the AMW for a molecule.</li>
<li>mol_logp(mol) : returns the MolLogP for a molecule.</li>
<li>mol_tpsa(mol) : returns the topological polar surface area for a molecule (<em>available from Q1 2011 (2011_03) release</em>).</li>
<li>mol_fractioncsp3(mol) : returns the fraction of carbons that are sp3 hybridized (<em>available from 2013_03 release</em>).</li>
<li>mol_hba(mol) : returns the number of Lipinski H-bond acceptors (i.e. number of Os and Ns) for a molecule.</li>
<li>mol_hbd(mol) : returns the number of Lipinski H-bond donors (i.e. number of Os and Ns that have at least one H) for a molecule.</li>
<li>mol_numatoms(mol) : returns the total number of atoms in a molecule.</li>
<li>mol_numheavyatoms(mol) : returns the number of heavy atoms in a molecule.</li>
<li>mol_numrotatablebonds(mol) : returns the number of rotatable bonds in a molecule (<em>available from Q1 2011 (2011_03) release</em>).</li>
<li>mol_numheteroatoms(mol) : returns the number of heteroatoms in a molecule (<em>available from Q1 2011 (2011_03) release</em>).</li>
<li>mol_numrings(mol) : returns the number of rings in a molecule (<em>available from Q1 2011 (2011_03) release</em>).</li>
<li>mol_numaromaticrings(mol) : returns the number of aromatic rings in a molecule (<em>available from 2013_03 release</em>).</li>
<li>mol_numaliphaticrings(mol) : returns the number of aliphatic (at least one non-aromatic bond) rings in a molecule (<em>available from 2013_03 release</em>).</li>
<li>mol_numsaturatedrings(mol) : returns the number of saturated rings in a molecule (<em>available from 2013_03 release</em>).</li>
<li>mol_numaromaticheterocycles(mol) : returns the number of aromatic heterocycles in a molecule (<em>available from 2013_03 release</em>).</li>
<li>mol_numaliphaticheterocycles(mol) : returns the number of aliphatic (at least one non-aromatic bond) heterocycles in a molecule (<em>available from 2013_03 release</em>).</li>
<li>mol_numsaturatedheterocycles(mol) : returns the number of saturated heterocycles in a molecule (<em>available from 2013_03 release</em>).</li>
<li>mol_numaromaticcarbocycles(mol) : returns the number of aromatic carbocycles in a molecule (<em>available from 2013_03 release</em>).</li>
<li>mol_numaliphaticcarbocycles(mol) : returns the number of aliphatic (at least one non-aromatic bond) carbocycles in a molecule (<em>available from 2013_03 release</em>).</li>
<li>mol_numsaturatedcarbocycles(mol) : returns the number of saturated carbocycles in a molecule (<em>available from 2013_03 release</em>).</li>
<li>mol_inchi(mol) : returns an InChI for the molecule. (<em>available from the 2011_06 release, requires that the RDKit be built with InChI support</em>).</li>
<li>mol_inchikey(mol) : returns an InChI key for the molecule. (<em>available from the 2011_06 release, requires that the RDKit be built with InChI support</em>).</li>
<li>mol_formula(mol,bool default false, bool default true) : returns a string with the molecular formula. The second argument controls whether isotope information is included in the formula; the third argument controls whether 「D」 and 「T」 are used instead of [2H] and [3H]. (<em>available from the 2014_03 release</em>)</li>
</ul>
</div>
<div class="section" id="connectivity-descriptors">
<span id="connectivity-descriptors"></span><h5>Connectivity Descriptors<a class="headerlink" href="#connectivity-descriptors" title="このヘッドラインへのパーマリンク">¶</a></h5>
<ul class="simple">
<li>mol_chi0v(mol) - mol_chi4v(mol) : returns the ChiXv value for a molecule for X=0-4 (<em>available from 2012_01 release</em>).</li>
<li>mol_chi0n(mol) - mol_chi4n(mol) : returns the ChiXn value for a molecule for X=0-4 (<em>available from 2012_01 release</em>).</li>
<li>mol_kappa1(mol) - mol_kappa3(mol) : returns the kappaX value for a molecule for X=1-3 (<em>available from 2012_01 release</em>).</li>
<li>mol_numspiroatoms : returns the number of spiro atoms in a molecule (<em>available from 2015_09 release</em>).</li>
<li>mol_numbridgeheadatoms : returns the number of bridgehead atoms in a molecule (<em>available from 2015_09 release</em>).</li>
</ul>
</div>
<div class="section" id="mcs">
<span id="mcs"></span><h5>MCS<a class="headerlink" href="#mcs" title="このヘッドラインへのパーマリンク">¶</a></h5>
<ul class="simple">
<li>fmcs(mols) : an aggregation function that calculates the MCS for a set of molecules</li>
<li>fmcs_smiles(text, json default 『』) : calculates the MCS for a space-separated set of SMILES. The optional json argument is used to provide parameters to the MCS code.</li>
</ul>
</div>
</div>
<div class="section" id="other">
<span id="other"></span><h4>Other<a class="headerlink" href="#other" title="このヘッドラインへのパーマリンク">¶</a></h4>
<ul class="simple">
<li>rdkit_version() : returns a string with the cartridge version number.</li>
</ul>
<p>There are additional functions defined in the cartridge, but these are used for internal purposes.</p>
</div>
</div>
</div>
<div class="section" id="using-the-cartridge-from-python">
<span id="using-the-cartridge-from-python"></span><h2>Using the Cartridge from Python<a class="headerlink" href="#using-the-cartridge-from-python" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>The recommended adapter for connecting to postgresql is pyscopg2 (<a class="reference external" href="https://pypi.python.org/pypi/psycopg2">https://pypi.python.org/pypi/psycopg2</a>).</p>
<p>Here’s an example of connecting to our local copy of ChEMBL and doing a basic substructure search:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">psycopg2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span> <span class="o">=</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">database</span><span class="o">=</span><span class="s1">&#39;chembl_16&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">curs</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">curs</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;select * from rdk.mols where m@&gt;</span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,(</span><span class="s1">&#39;c1cccc2c1nncc2&#39;</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">curs</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>
<span class="go">(9830, &#39;CC(C)Sc1ccc(CC2CCN(C3CCN(C(=O)c4cnnc5ccccc54)CC3)CC2)cc1&#39;)</span>
</pre></div>
</div>
<p>That returns a SMILES for each molecule. If you plan to do more work with the molecules after retrieving them, it is much more efficient to ask postgresql to give you the molecules in pickled form:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">curs</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;select molregno,mol_send(m) from rdk.mols where m@&gt;</span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,(</span><span class="s1">&#39;c1cccc2c1nncc2&#39;</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">row</span> <span class="o">=</span> <span class="n">curs</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">row</span>
<span class="go">(9830, &lt;read-only buffer for 0x...&gt;)</span>
</pre></div>
</div>
<p>These pickles can then be converted into molecules:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">rdkit</span> <span class="k">import</span> <span class="n">Chem</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">Mol</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Chem</span><span class="o">.</span><span class="n">MolToSmiles</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="kc">True</span><span class="p">)</span>
<span class="go">&#39;CC(C)Sc1ccc(CC2CCN(C3CCN(C(=O)c4cnnc5ccccc54)CC3)CC2)cc1&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="license">
<span id="license"></span><h2>License<a class="headerlink" href="#license" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>This document is copyright (C) 2013-2016 by Greg Landrum</p>
<p>This work is licensed under the Creative Commons Attribution-ShareAlike 4.0 License. To view a copy of this license, visit <a class="reference external" href="http://creativecommons.org/licenses/by-sa/4.0/">http://creativecommons.org/licenses/by-sa/4.0/</a> or send a letter to Creative Commons, 543 Howard Street, 5th Floor, San Francisco, California, 94105, USA.</p>
<p>The intent of this license is similar to that of the RDKit itself. In simple words: “Do whatever you want with it, but please give us some credit.”</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="総合索引"
             >索引</a></li>
        <li class="right" >
          <a href="Cookbook.html" title="RDKit Cookbook"
             >前へ</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">The RDKit 2017.09.2 ドキュメント</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, Greg Landrum.
      このドキュメントは <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.6 で生成しました。
    </div>
  </body>
</html>