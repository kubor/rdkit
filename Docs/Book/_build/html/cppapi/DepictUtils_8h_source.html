<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>RDKit: DepictUtils.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo_plain.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">RDKit
   </div>
   <div id="projectbrief">Open-source cheminformatics and machine learning.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('DepictUtils_8h_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">DepictUtils.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="DepictUtils_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//  Copyright (C) 2003-2010 Greg Landrum and Rational Discovery LLC</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//   @@ All Rights Reserved @@</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//  This file is part of the RDKit.</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//  The contents are covered by the terms of the BSD license</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//  which is included in the file license.txt, found at the root</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//  of the RDKit source tree.</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#ifndef _RD_DEPICT_UTILS_H_</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#define _RD_DEPICT_UTILS_H_</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// REVIEW: remove extra headers here</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="types_8h.html">RDGeneral/types.h</a>&gt;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="RDKitBase_8h.html">GraphMol/RDKitBase.h</a>&gt;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="RWMol_8h.html">GraphMol/RWMol.h</a>&gt;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="ROMol_8h.html">GraphMol/ROMol.h</a>&gt;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="Transform2D_8h.html">Geometry/Transform2D.h</a>&gt;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="point_8h.html">Geometry/point.h</a>&gt;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &lt;queue&gt;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceRDDepict.html">RDDepict</a> {</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">double</span> <a class="code" href="namespaceRDDepict.html#a09625151d4af8132b05a3e54ef7bf162">BOND_LEN</a>;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">double</span> <a class="code" href="namespaceRDDepict.html#a8c89d9dd6610e843707b8535a0874d98">COLLISION_THRES</a>;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">double</span> <a class="code" href="namespaceRDDepict.html#a89f0701480dd780d179fdebbca21272b">BOND_THRES</a>;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">double</span> <a class="code" href="namespaceRDDepict.html#a917bb70049f88eeb974efc812f4a4572">ANGLE_OPEN</a>;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceRDDepict.html#a90d1fcbf4cab2323902e9dab35d7196f">MAX_COLL_ITERS</a>;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">double</span> <a class="code" href="namespaceRDDepict.html#a4f472354f7954240df792a0e4d114441">HETEROATOM_COLL_SCALE</a>;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceRDDepict.html#a0a75a1e9181f13612d1ab2b6fa112025">NUM_BONDS_FLIPS</a>;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno"><a class="line" href="namespaceRDDepict.html#a5d8a7f118e85ea5d67acc695147891f6">   31</a></span>&#160;<span class="keyword">typedef</span> std::vector&lt;const RDGeom::Point2D *&gt; <a class="code" href="namespaceRDDepict.html#a5d8a7f118e85ea5d67acc695147891f6">VECT_C_POINT</a>;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="namespaceRDDepict.html#a31f8444a8f7a8efb5ef3779dd250a36f">   33</a></span>&#160;<span class="keyword">typedef</span> std::pair&lt;int, int&gt; <a class="code" href="namespaceRDDepict.html#a31f8444a8f7a8efb5ef3779dd250a36f">PAIR_I_I</a>;</div><div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="namespaceRDDepict.html#a84946688805616d12983805489787c9f">   34</a></span>&#160;<span class="keyword">typedef</span> std::vector&lt;PAIR_I_I&gt; <a class="code" href="namespaceRDDepict.html#a84946688805616d12983805489787c9f">VECT_PII</a>;</div><div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="structRDDepict_1_1gtIIPair.html">   35</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structRDDepict_1_1gtIIPair.html">gtIIPair</a> {</div><div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="structRDDepict_1_1gtIIPair.html#a013178b0b8b7ff65dc0ad743e504da8e">   36</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="structRDDepict_1_1gtIIPair.html#a013178b0b8b7ff65dc0ad743e504da8e">operator()</a>(<span class="keyword">const</span> PAIR_I_I &amp;pd1, <span class="keyword">const</span> PAIR_I_I &amp;pd2)<span class="keyword"> const </span>{</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keywordflow">return</span> pd1.first &gt; pd2.first;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  }</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;};</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="namespaceRDDepict.html#a7e73ec07bb1a0e2872ee0deba95d3539">   41</a></span>&#160;<span class="keyword">typedef</span> std::priority_queue&lt;PAIR_I_I, VECT_PII, gtIIPair&gt; <a class="code" href="namespaceRDDepict.html#a7e73ec07bb1a0e2872ee0deba95d3539">PR_QUEUE</a>;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="namespaceRDDepict.html#a9385d17eacca3ec341b2075d2d2a1eff">   43</a></span>&#160;<span class="keyword">typedef</span> std::pair&lt;double, PAIR_I_I&gt; <a class="code" href="namespaceRDDepict.html#a9385d17eacca3ec341b2075d2d2a1eff">PAIR_D_I_I</a>;</div><div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="namespaceRDDepict.html#a80b75cd65da43409086de2cd723efe57">   44</a></span>&#160;<span class="keyword">typedef</span> std::list&lt;PAIR_D_I_I&gt; <a class="code" href="namespaceRDDepict.html#a80b75cd65da43409086de2cd723efe57">LIST_PAIR_DII</a>;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">//! Some utility functions used in generating 2D coordinates</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment"></span><span class="comment"></span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">//! Embed a ring as a convex polygon in 2D</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment"></span><span class="comment">/*!</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">  The process here is very straightforward:</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">  We take the center of the ring to lie at the origin, so put the first</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">  point at the origin and then sweep</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">  anti-clockwise by an angle A = 360/n for the next point.</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">  The length of the arm (l) we want to sweep is easy to compute given the</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">  bond length (b) we want to use for each bond in the ring (for now</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">  we will assume that this bond legnth is the same for all bonds in the ring:</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">  l = b/sqrt(2*(1 - cos(A))</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">  the above formula derives from the triangle formula, where side &#39;c&#39; is given</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">  in terms of sides &#39;a&#39; and &#39;b&#39; as:</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">  c = a^2 + b^2 - 2.a.b.cos(A)</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">  where A is the angle between a and b</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<a class="code" href="namespaceRDGeom.html#a35989ac0bc413e5118210622f4805866">RDGeom::INT_POINT2D_MAP</a> <a class="code" href="namespaceRDDepict.html#ab8b340c558ecfd0305dfa0ac911b7cb7">embedRing</a>(<span class="keyword">const</span> <a class="code" href="namespaceRDKit.html#a1d1aa140f55ea44f46af9ff22bfcaf8d">RDKit::INT_VECT</a> &amp;ring);</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceRDDepict.html#a0fb6bbed6f567e903b7b875860dae5a3">transformPoints</a>(<a class="code" href="namespaceRDGeom.html#a35989ac0bc413e5118210622f4805866">RDGeom::INT_POINT2D_MAP</a> &amp;nringCor,</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                     <span class="keyword">const</span> <a class="code" href="classRDGeom_1_1Transform2D.html">RDGeom::Transform2D</a> &amp;trans);</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">//! Find a point that bisects the angle at rcr</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment"></span><span class="comment">/*!</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">  The new point lies between nb1 and nb2. The line (rcr, newPt) bisects the</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">  angle</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">  &#39;ang&#39; at rcr</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<a class="code" href="classRDGeom_1_1Point2D.html">RDGeom::Point2D</a> <a class="code" href="namespaceRDDepict.html#a8b79bb95ca77f269632f242355439993">computeBisectPoint</a>(<span class="keyword">const</span> <a class="code" href="classRDGeom_1_1Point2D.html">RDGeom::Point2D</a> &amp;rcr, <span class="keywordtype">double</span> ang,</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                                   <span class="keyword">const</span> <a class="code" href="classRDGeom_1_1Point2D.html">RDGeom::Point2D</a> &amp;nb1,</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                                   <span class="keyword">const</span> <a class="code" href="classRDGeom_1_1Point2D.html">RDGeom::Point2D</a> &amp;nb2);</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">//! Reflect a set of point through a the line joining two point</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment"></span><span class="comment">/*!</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">  ARGUMENTS:</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">  \param coordMap       a map of &lt;int, point2D&gt; going from atom id to current</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">                        coordinates of the points that need to be reflected:</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">                        The coordinates are overwritten</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">  \param loc1           the first point of the line that is to be used as a</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">  mirror</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">  \param loc2           the second point of the line to be used as a mirror</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceRDDepict.html#a02e74b42a2872ba5cc28d9b0031c5cd2">reflectPoints</a>(<a class="code" href="namespaceRDGeom.html#a35989ac0bc413e5118210622f4805866">RDGeom::INT_POINT2D_MAP</a> &amp;coordMap,</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                   <span class="keyword">const</span> <a class="code" href="classRDGeom_1_1Point2D.html">RDGeom::Point2D</a> &amp;loc1, <span class="keyword">const</span> <a class="code" href="classRDGeom_1_1Point2D.html">RDGeom::Point2D</a> &amp;loc2);</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<a class="code" href="classRDGeom_1_1Point2D.html">RDGeom::Point2D</a> <a class="code" href="namespaceRDDepict.html#a15fb0c5b7657c623b4852bd4184374d9">reflectPoint</a>(<span class="keyword">const</span> <a class="code" href="classRDGeom_1_1Point2D.html">RDGeom::Point2D</a> &amp;point,</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                             <span class="keyword">const</span> <a class="code" href="classRDGeom_1_1Point2D.html">RDGeom::Point2D</a> &amp;loc1,</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                             <span class="keyword">const</span> <a class="code" href="classRDGeom_1_1Point2D.html">RDGeom::Point2D</a> &amp;loc2);</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">//! Set the neighbors yet to added to aid such that the atoms with the most subs</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment"></span><span class="comment">// fall on opposite sides</span><span class="comment"></span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">  Ok this needs some explanation</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">  - Let A, B, C, D be the substituent on the central atom X (given</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">    by atom index aid)</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">  - also let A be the atom that is already embedded</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">  - Now we want the order in which the remaining neighbors B,C,D are</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">    added to X such that the atoms with atom with largest number of</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">    substituent fall on opposite sides of X so as to minimize atom</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">    clashes later in the depiction</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">  E.g. let say we have the following situation</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">&lt;pre&gt;</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">          B</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">       |  |</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">       A--X--C</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">       |  |</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">        --D--</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">          |</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">&lt;/pre&gt;</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">  In this case the the number substituent of A, B, C, D are 3, 1, 1,</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">  4 respectively so want to A and D to go opposite sides and so that</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">  we draw</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">&lt;pre&gt;</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">          B</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">       |  |  |</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">       A--X--D--</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">       |  |  |</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">          C</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">&lt;/pre&gt;</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">  And the correct ordering of the neighbors is B,D,C</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<a class="code" href="namespaceRDKit.html#a1d1aa140f55ea44f46af9ff22bfcaf8d">RDKit::INT_VECT</a> <a class="code" href="namespaceRDDepict.html#a9efd60ef0c84d904236a926cbba4ac28">setNbrOrder</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> aid, <span class="keyword">const</span> <a class="code" href="namespaceRDKit.html#a1d1aa140f55ea44f46af9ff22bfcaf8d">RDKit::INT_VECT</a> &amp;nbrs,</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                            <span class="keyword">const</span> <a class="code" href="classRDKit_1_1ROMol.html">RDKit::ROMol</a> &amp;mol);</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">//! \brief From a given set of rings find the ring the largest common elements</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment"></span><span class="comment">// with other rings</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">  Bit of a weird function - this is typically called once we have embedded some</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">  of the</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">  rings in a fused system and we are looking for the ring that must be embedded</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">  (or merged)</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">  next. The heuristic used here is to pick the rings with the maximum number of</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">  atoms</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">  in common with the rings that are already embedded.</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">  \param doneRings    a vertor of ring IDs that have been embedded already</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">  \param fusedRings   list of all the rings in the the fused system</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">  \param nextId       this is where the ID for the next ring is written</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">  \return list of atom ids that are common</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<a class="code" href="namespaceRDKit.html#a1d1aa140f55ea44f46af9ff22bfcaf8d">RDKit::INT_VECT</a> <a class="code" href="namespaceRDDepict.html#a7d1ffc508c4dea5d33b3297576e7be21">findNextRingToEmbed</a>(<span class="keyword">const</span> <a class="code" href="namespaceRDKit.html#a1d1aa140f55ea44f46af9ff22bfcaf8d">RDKit::INT_VECT</a> &amp;doneRings,</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                                    <span class="keyword">const</span> <a class="code" href="namespaceRDKit.html#a44eafa424a4e9580b730ca0ec73c7540">RDKit::VECT_INT_VECT</a> &amp;fusedRings,</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                                    <span class="keywordtype">int</span> &amp;nextId);</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div><div class="line"><a name="l00158"></a><span class="lineno"><a class="line" href="namespaceRDDepict.html#aff67c4b304e654f92103e214aada252d">  158</a></span>&#160;<span class="keyword">typedef</span> std::pair&lt;int, int&gt; <a class="code" href="namespaceRDDepict.html#aff67c4b304e654f92103e214aada252d">INT_PAIR</a>;</div><div class="line"><a name="l00159"></a><span class="lineno"><a class="line" href="namespaceRDDepict.html#a85b2de51991b56105cb73c6f0dc3c503">  159</a></span>&#160;<span class="keyword">typedef</span> std::vector&lt;INT_PAIR&gt; <a class="code" href="namespaceRDDepict.html#a85b2de51991b56105cb73c6f0dc3c503">INT_PAIR_VECT</a>;</div><div class="line"><a name="l00160"></a><span class="lineno"><a class="line" href="namespaceRDDepict.html#adfbf3b426c0b96c6847b1acdae21a3c0">  160</a></span>&#160;<span class="keyword">typedef</span> INT_PAIR_VECT::const_iterator <a class="code" href="namespaceRDDepict.html#adfbf3b426c0b96c6847b1acdae21a3c0">INT_PAIR_VECT_CI</a>;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno"><a class="line" href="namespaceRDDepict.html#a50b3bd01291bbc39a4201f9dc2e9eec6">  162</a></span>&#160;<span class="keyword">typedef</span> std::pair&lt;double, INT_PAIR&gt; <a class="code" href="namespaceRDDepict.html#a50b3bd01291bbc39a4201f9dc2e9eec6">DOUBLE_INT_PAIR</a>;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">//! Sort a list of atoms by their  CIP rank</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment"></span><span class="comment">/*!</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">  \param mol        molecule of interest</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">  \param commAtms   atoms that need to be ranked</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">  \param ascending  sort to an ascending order or a descending order</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;T <a class="code" href="namespaceRDDepict.html#adea542de9aebe1a744016371ad50682c">rankAtomsByRank</a>(<span class="keyword">const</span> <a class="code" href="classRDKit_1_1ROMol.html">RDKit::ROMol</a> &amp;mol, <span class="keyword">const</span> T &amp;commAtms,</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                  <span class="keywordtype">bool</span> ascending = <span class="keyword">true</span>);</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">//! computes a subangle for an atom of given hybridization and degree</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment"></span><span class="comment">/*!</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">  \param degree the degree of the atom (number of neighbors)</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">  \param htype  the atom&#39;s hybridization</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">  \return the subangle (in radians)</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00181"></a><span class="lineno"><a class="line" href="namespaceRDDepict.html#a840d447f3bf4fa58dd3a5cc9b9b1fe60">  181</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="namespaceRDDepict.html#a840d447f3bf4fa58dd3a5cc9b9b1fe60">computeSubAngle</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> degree,</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                              <a class="code" href="classRDKit_1_1Atom.html#a58e40e30db6b42826243163175cac976">RDKit::Atom::HybridizationType</a> htype) {</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="keywordtype">double</span> angle = <a class="code" href="MMFF_2Params_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="keywordflow">switch</span> (htype) {</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classRDKit_1_1Atom.html#a58e40e30db6b42826243163175cac976ac2c0beed1c19c0d892ad98ad0967a601">RDKit::Atom::UNSPECIFIED</a>:</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classRDKit_1_1Atom.html#a58e40e30db6b42826243163175cac976a385dd0f8e1df8580b91bf8e62001a709">RDKit::Atom::SP3</a>:</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      <span class="keywordflow">if</span> (degree == 4) {</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        angle = <a class="code" href="MMFF_2Params_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a> / 2;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        angle = 2 * <a class="code" href="MMFF_2Params_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a> / 3;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      }</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classRDKit_1_1Atom.html#a58e40e30db6b42826243163175cac976abf5e1c0d5acd32e59cc1b0975f4bad2e">RDKit::Atom::SP2</a>:</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      angle = 2 * <a class="code" href="MMFF_2Params_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a> / 3;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      angle = 2. * <a class="code" href="MMFF_2Params_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a> / degree;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  }</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="keywordflow">return</span> angle;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;}</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">//! computes the rotation direction between two vectors</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment"></span><span class="comment">/*!</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">  Let:</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">     v1 = loc1 - center</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">     v2 = loc2 - center</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">  If remaining angle(v1, v2) is &lt; 180 and corss(v1, v2) &gt; 0.0 then the rotation</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">  dir is +1.0</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">  else if remAngle(v1, v2) is &gt; 180 and cross(v1, v2) &lt; 0.0 then rotation dir is</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">  -1.0</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">  else if remAngle(v1, v2) is &lt; 180 and cross(v1, v2) &lt; 0.0 then rotation dir is</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">  -1.0</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">  finally if remAngle(v1, v2) is &gt; 180 and cross(v1, v2) &lt; 0.0 then rotation dir</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">  is +1.0</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">  \param center     the common point</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">  \param loc1       endpoint 1</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">  \param loc2       endpoint 2</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">  \param remAngle   the remaining angle about center in radians</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">  \return the rotation direction (1 or -1)</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00230"></a><span class="lineno"><a class="line" href="namespaceRDDepict.html#a4b5c8786715a63dde2c6d1257fe615be">  230</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="namespaceRDDepict.html#a4b5c8786715a63dde2c6d1257fe615be">rotationDir</a>(<span class="keyword">const</span> <a class="code" href="classRDGeom_1_1Point2D.html">RDGeom::Point2D</a> &amp;center,</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                       <span class="keyword">const</span> <a class="code" href="classRDGeom_1_1Point2D.html">RDGeom::Point2D</a> &amp;loc1, <span class="keyword">const</span> <a class="code" href="classRDGeom_1_1Point2D.html">RDGeom::Point2D</a> &amp;loc2,</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                       <span class="keywordtype">double</span> remAngle) {</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <a class="code" href="classRDGeom_1_1Point2D.html">RDGeom::Point2D</a> pt1 = loc1 - center;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <a class="code" href="classRDGeom_1_1Point2D.html">RDGeom::Point2D</a> pt2 = loc2 - center;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <span class="keywordtype">double</span> cross = pt1.<a class="code" href="classRDGeom_1_1Point2D.html#af65f5002a49449c0aed2ba3301f88ff0">x</a> * pt2.<a class="code" href="classRDGeom_1_1Point2D.html#abc27e42869445a65a99957f8ab6e319f">y</a> - pt1.<a class="code" href="classRDGeom_1_1Point2D.html#abc27e42869445a65a99957f8ab6e319f">y</a> * pt2.<a class="code" href="classRDGeom_1_1Point2D.html#af65f5002a49449c0aed2ba3301f88ff0">x</a>;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="keywordtype">double</span> diffAngle = <a class="code" href="MMFF_2Params_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a> - remAngle;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  cross *= diffAngle;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="keywordflow">if</span> (cross &gt;= 0.0) {</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  }</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;}</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">//! computes and return the normal of a vector between two points</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment"></span><span class="comment">/*!</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">  \param center     the common point</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">  \param other      the endpoint</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">  \return the normal</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00252"></a><span class="lineno"><a class="line" href="namespaceRDDepict.html#ac3438aaf1da6146d84ad7bdb0d2a626b">  252</a></span>&#160;<span class="keyword">inline</span> <a class="code" href="classRDGeom_1_1Point2D.html">RDGeom::Point2D</a> <a class="code" href="namespaceRDDepict.html#ac3438aaf1da6146d84ad7bdb0d2a626b">computeNormal</a>(<span class="keyword">const</span> <a class="code" href="classRDGeom_1_1Point2D.html">RDGeom::Point2D</a> &amp;center,</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                                     <span class="keyword">const</span> <a class="code" href="classRDGeom_1_1Point2D.html">RDGeom::Point2D</a> &amp;other) {</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <a class="code" href="classRDGeom_1_1Point2D.html">RDGeom::Point2D</a> res = other - center;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  res.<a class="code" href="classRDGeom_1_1Point2D.html#a3d85340394eef9d8f918df3994be412e">normalize</a>();</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <span class="keywordtype">double</span> tmp = res.<a class="code" href="classRDGeom_1_1Point2D.html#af65f5002a49449c0aed2ba3301f88ff0">x</a>;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  res.<a class="code" href="classRDGeom_1_1Point2D.html#af65f5002a49449c0aed2ba3301f88ff0">x</a> = -res.<a class="code" href="classRDGeom_1_1Point2D.html#abc27e42869445a65a99957f8ab6e319f">y</a>;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  res.<a class="code" href="classRDGeom_1_1Point2D.html#abc27e42869445a65a99957f8ab6e319f">y</a> = tmp;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;}</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">//! computes the rotation angle between two vectors</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment"></span><span class="comment">/*!</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">  \param center     the common point</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">  \param loc1       endpoint 1</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">  \param loc2       endpoint 2</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">  \return the angle (in radians)</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00270"></a><span class="lineno"><a class="line" href="namespaceRDDepict.html#a947f1b1627363cd937a36ed27b55db86">  270</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="namespaceRDDepict.html#a947f1b1627363cd937a36ed27b55db86">computeAngle</a>(<span class="keyword">const</span> <a class="code" href="classRDGeom_1_1Point2D.html">RDGeom::Point2D</a> &amp;center,</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                           <span class="keyword">const</span> <a class="code" href="classRDGeom_1_1Point2D.html">RDGeom::Point2D</a> &amp;loc1,</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                           <span class="keyword">const</span> <a class="code" href="classRDGeom_1_1Point2D.html">RDGeom::Point2D</a> &amp;loc2) {</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <a class="code" href="classRDGeom_1_1Point2D.html">RDGeom::Point2D</a> v1 = loc1 - center;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <a class="code" href="classRDGeom_1_1Point2D.html">RDGeom::Point2D</a> v2 = loc2 - center;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <span class="keywordflow">return</span> v1.<a class="code" href="classRDGeom_1_1Point2D.html#a8f6549411b18d15ab673ea601ce1432d">angleTo</a>(v2);</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;}</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">//! \brief pick the ring to embed first in a fused system</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment"></span><span class="comment">/*!</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">  \param mol        the molecule of interest</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">  \param fusedRings the collection of the molecule&#39;s fused rings</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">  \return the index of the ring with the least number of substitutions</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespaceRDDepict.html#a426a8f28b5fb7ba9806f168618ce8c29">pickFirstRingToEmbed</a>(<span class="keyword">const</span> <a class="code" href="classRDKit_1_1ROMol.html">RDKit::ROMol</a> &amp;mol,</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                         <span class="keyword">const</span> <a class="code" href="namespaceRDKit.html#a44eafa424a4e9580b730ca0ec73c7540">RDKit::VECT_INT_VECT</a> &amp;fusedRings);</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">//! \brief find the rotatable bonds on the shortest path between two atoms</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">//!   we will ignore ring atoms, and double bonds which are marked cis/trans</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment"></span><span class="comment">/*!</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">  &lt;b&gt;Note&lt;/b&gt; that rotatable in this context doesn&#39;t connect to the</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">    standard chemical definition of a rotatable bond; we&#39;re just talking</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">    about bonds than can be flipped in order to clean up the depiction.</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">  \param mol   the molecule of interest</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">  \param aid1  index of the first atom</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">  \param aid2  index of the second atom</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">  \return a set of the indices of the rotatable bonds</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<a class="code" href="namespaceRDKit.html#a1d1aa140f55ea44f46af9ff22bfcaf8d">RDKit::INT_VECT</a> <a class="code" href="namespaceRDDepict.html#ab30c582582a9d766456295d9b3ffb98d">getRotatableBonds</a>(<span class="keyword">const</span> <a class="code" href="classRDKit_1_1ROMol.html">RDKit::ROMol</a> &amp;mol, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> aid1,</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                                  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> aid2);</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">//! \brief find all the rotatable bonds in a molecule</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">//!   we will ignore ring atoms, and double bonds which are marked cis/trans</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment"></span><span class="comment">/*!</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">  &lt;b&gt;Note&lt;/b&gt; that rotatable in this context doesn&#39;t connect to the</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">    standard chemical definition of a rotatable bond; we&#39;re just talking</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">    about bonds than can be flipped in order to clean up the depiction.</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">  \param mol   the molecule of interest</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">  \return a set of the indices of the rotatable bonds</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<a class="code" href="namespaceRDKit.html#a1d1aa140f55ea44f46af9ff22bfcaf8d">RDKit::INT_VECT</a> <a class="code" href="namespaceRDDepict.html#aa535f505e1fcc5defd3f92c50f6e846a">getAllRotatableBonds</a>(<span class="keyword">const</span> <a class="code" href="classRDKit_1_1ROMol.html">RDKit::ROMol</a> &amp;mol);</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">//! Get the ids of the atoms and bonds that are connected to aid</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="namespaceRDDepict.html#ac99e2f94e473bdf60abc9d8ec2e7e7cf">getNbrAtomAndBondIds</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> aid, <span class="keyword">const</span> <a class="code" href="classRDKit_1_1ROMol.html">RDKit::ROMol</a> *mol,</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                          <a class="code" href="namespaceRDKit.html#a1d1aa140f55ea44f46af9ff22bfcaf8d">RDKit::INT_VECT</a> &amp;aids, <a class="code" href="namespaceRDKit.html#a1d1aa140f55ea44f46af9ff22bfcaf8d">RDKit::INT_VECT</a> &amp;bids);</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">//! Find pairs of bonds that can be permuted at a non-ring degree 4 atom</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment"></span><span class="comment">/*!</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">  This function will return only those pairs that cannot be</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">  permuted by flipping a rotatble bond</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">         D</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">         |</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">         b3</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">         |</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">    A-b1-B-b2-C</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">         |</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">         b4</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">         |</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">         E</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">   For example in teh above situation on the pairs (b1, b3) and (b1, b4) will be</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">  returned</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">   All other permutations can be achieved via a rotatable bond flip.</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">   ARGUMENTS:</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">   \param center - location of the central atom</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">   \param nbrBids - a vector (of length 4) containing the ids of the bonds to</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">  the neighbors</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">   \param nbrLocs - locations of the neighbors</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;INT_PAIR_VECT <a class="code" href="namespaceRDDepict.html#afe19d1ba9780914a272c4b0022c3293b">findBondsPairsToPermuteDeg4</a>(<span class="keyword">const</span> <a class="code" href="classRDGeom_1_1Point2D.html">RDGeom::Point2D</a> &amp;center,</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                                          <span class="keyword">const</span> <a class="code" href="namespaceRDKit.html#a1d1aa140f55ea44f46af9ff22bfcaf8d">RDKit::INT_VECT</a> &amp;nbrBids,</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                                          <span class="keyword">const</span> VECT_C_POINT &amp;nbrLocs);</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">//! returns the rank of the atom for determining draw order</span></div><div class="line"><a name="l00350"></a><span class="lineno"><a class="line" href="namespaceRDDepict.html#a0b978c76285bf6795b0abc7b7f84b780">  350</a></span>&#160;<span class="comment"></span><span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="namespaceRDDepict.html#a0b978c76285bf6795b0abc7b7f84b780">getAtomDepictRank</a>(<span class="keyword">const</span> <a class="code" href="classRDKit_1_1Atom.html">RDKit::Atom</a> *at) {</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> maxAtNum = 1000;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> maxDeg = 100;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <span class="keywordtype">int</span> anum = at-&gt;<a class="code" href="classRDKit_1_1Atom.html#a1b65245c6e3ed07f11327c3ea850acc5">getAtomicNum</a>();</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  anum = anum == 1 ? maxAtNum : anum;  <span class="comment">// favor non-hydrogen atoms</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <span class="keywordtype">int</span> deg = at-&gt;<a class="code" href="classRDKit_1_1Atom.html#aa26d87bb2aee6fcad634fdc23ca13b77">getDegree</a>();</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <span class="keywordflow">return</span> maxDeg * anum + deg;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;}</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;}</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="preprocessor">#endif</span></div><div class="ttc" id="namespaceRDDepict_html_a90d1fcbf4cab2323902e9dab35d7196f"><div class="ttname"><a href="namespaceRDDepict.html#a90d1fcbf4cab2323902e9dab35d7196f">RDDepict::MAX_COLL_ITERS</a></div><div class="ttdeci">unsigned int MAX_COLL_ITERS</div></div>
<div class="ttc" id="namespaceRDDepict_html_a31f8444a8f7a8efb5ef3779dd250a36f"><div class="ttname"><a href="namespaceRDDepict.html#a31f8444a8f7a8efb5ef3779dd250a36f">RDDepict::PAIR_I_I</a></div><div class="ttdeci">std::pair&lt; int, int &gt; PAIR_I_I</div><div class="ttdef"><b>Definition:</b> <a href="DepictUtils_8h_source.html#l00033">DepictUtils.h:33</a></div></div>
<div class="ttc" id="types_8h_html"><div class="ttname"><a href="types_8h.html">types.h</a></div></div>
<div class="ttc" id="namespaceRDDepict_html_ab30c582582a9d766456295d9b3ffb98d"><div class="ttname"><a href="namespaceRDDepict.html#ab30c582582a9d766456295d9b3ffb98d">RDDepict::getRotatableBonds</a></div><div class="ttdeci">RDKit::INT_VECT getRotatableBonds(const RDKit::ROMol &amp;mol, unsigned int aid1, unsigned int aid2)</div><div class="ttdoc">find the rotatable bonds on the shortest path between two atoms we will ignore ring atoms...</div></div>
<div class="ttc" id="classRDGeom_1_1Point2D_html_abc27e42869445a65a99957f8ab6e319f"><div class="ttname"><a href="classRDGeom_1_1Point2D.html#abc27e42869445a65a99957f8ab6e319f">RDGeom::Point2D::y</a></div><div class="ttdeci">double y</div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00256">point.h:256</a></div></div>
<div class="ttc" id="namespaceRDDepict_html_aff67c4b304e654f92103e214aada252d"><div class="ttname"><a href="namespaceRDDepict.html#aff67c4b304e654f92103e214aada252d">RDDepict::INT_PAIR</a></div><div class="ttdeci">std::pair&lt; int, int &gt; INT_PAIR</div><div class="ttdef"><b>Definition:</b> <a href="DepictUtils_8h_source.html#l00158">DepictUtils.h:158</a></div></div>
<div class="ttc" id="namespaceRDDepict_html_a840d447f3bf4fa58dd3a5cc9b9b1fe60"><div class="ttname"><a href="namespaceRDDepict.html#a840d447f3bf4fa58dd3a5cc9b9b1fe60">RDDepict::computeSubAngle</a></div><div class="ttdeci">double computeSubAngle(unsigned int degree, RDKit::Atom::HybridizationType htype)</div><div class="ttdoc">computes a subangle for an atom of given hybridization and degree </div><div class="ttdef"><b>Definition:</b> <a href="DepictUtils_8h_source.html#l00181">DepictUtils.h:181</a></div></div>
<div class="ttc" id="classRDKit_1_1Atom_html_a58e40e30db6b42826243163175cac976ac2c0beed1c19c0d892ad98ad0967a601"><div class="ttname"><a href="classRDKit_1_1Atom.html#a58e40e30db6b42826243163175cac976ac2c0beed1c19c0d892ad98ad0967a601">RDKit::Atom::UNSPECIFIED</a></div><div class="ttdoc">hybridization that hasn&amp;#39;t been specified </div><div class="ttdef"><b>Definition:</b> <a href="Atom_8h_source.html#l00081">Atom.h:81</a></div></div>
<div class="ttc" id="Transform2D_8h_html"><div class="ttname"><a href="Transform2D_8h.html">Transform2D.h</a></div></div>
<div class="ttc" id="point_8h_html"><div class="ttname"><a href="point_8h.html">point.h</a></div></div>
<div class="ttc" id="classRDGeom_1_1Transform2D_html"><div class="ttname"><a href="classRDGeom_1_1Transform2D.html">RDGeom::Transform2D</a></div><div class="ttdef"><b>Definition:</b> <a href="Transform2D_8h_source.html#l00020">Transform2D.h:20</a></div></div>
<div class="ttc" id="namespaceRDDepict_html_a8b79bb95ca77f269632f242355439993"><div class="ttname"><a href="namespaceRDDepict.html#a8b79bb95ca77f269632f242355439993">RDDepict::computeBisectPoint</a></div><div class="ttdeci">RDGeom::Point2D computeBisectPoint(const RDGeom::Point2D &amp;rcr, double ang, const RDGeom::Point2D &amp;nb1, const RDGeom::Point2D &amp;nb2)</div><div class="ttdoc">Find a point that bisects the angle at rcr. </div></div>
<div class="ttc" id="ROMol_8h_html"><div class="ttname"><a href="ROMol_8h.html">ROMol.h</a></div><div class="ttdoc">Defines the primary molecule class ROMol as well as associated typedefs. </div></div>
<div class="ttc" id="classRDGeom_1_1Point2D_html"><div class="ttname"><a href="classRDGeom_1_1Point2D.html">RDGeom::Point2D</a></div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00254">point.h:254</a></div></div>
<div class="ttc" id="namespaceRDDepict_html_a09625151d4af8132b05a3e54ef7bf162"><div class="ttname"><a href="namespaceRDDepict.html#a09625151d4af8132b05a3e54ef7bf162">RDDepict::BOND_LEN</a></div><div class="ttdeci">double BOND_LEN</div></div>
<div class="ttc" id="namespaceRDDepict_html_a0a75a1e9181f13612d1ab2b6fa112025"><div class="ttname"><a href="namespaceRDDepict.html#a0a75a1e9181f13612d1ab2b6fa112025">RDDepict::NUM_BONDS_FLIPS</a></div><div class="ttdeci">unsigned int NUM_BONDS_FLIPS</div></div>
<div class="ttc" id="namespaceRDDepict_html_a917bb70049f88eeb974efc812f4a4572"><div class="ttname"><a href="namespaceRDDepict.html#a917bb70049f88eeb974efc812f4a4572">RDDepict::ANGLE_OPEN</a></div><div class="ttdeci">double ANGLE_OPEN</div></div>
<div class="ttc" id="namespaceRDDepict_html_a02e74b42a2872ba5cc28d9b0031c5cd2"><div class="ttname"><a href="namespaceRDDepict.html#a02e74b42a2872ba5cc28d9b0031c5cd2">RDDepict::reflectPoints</a></div><div class="ttdeci">void reflectPoints(RDGeom::INT_POINT2D_MAP &amp;coordMap, const RDGeom::Point2D &amp;loc1, const RDGeom::Point2D &amp;loc2)</div><div class="ttdoc">Reflect a set of point through a the line joining two point. </div></div>
<div class="ttc" id="namespaceRDDepict_html_a9385d17eacca3ec341b2075d2d2a1eff"><div class="ttname"><a href="namespaceRDDepict.html#a9385d17eacca3ec341b2075d2d2a1eff">RDDepict::PAIR_D_I_I</a></div><div class="ttdeci">std::pair&lt; double, PAIR_I_I &gt; PAIR_D_I_I</div><div class="ttdef"><b>Definition:</b> <a href="DepictUtils_8h_source.html#l00043">DepictUtils.h:43</a></div></div>
<div class="ttc" id="namespaceRDDepict_html_a947f1b1627363cd937a36ed27b55db86"><div class="ttname"><a href="namespaceRDDepict.html#a947f1b1627363cd937a36ed27b55db86">RDDepict::computeAngle</a></div><div class="ttdeci">double computeAngle(const RDGeom::Point2D &amp;center, const RDGeom::Point2D &amp;loc1, const RDGeom::Point2D &amp;loc2)</div><div class="ttdoc">computes the rotation angle between two vectors </div><div class="ttdef"><b>Definition:</b> <a href="DepictUtils_8h_source.html#l00270">DepictUtils.h:270</a></div></div>
<div class="ttc" id="namespaceRDDepict_html_afe19d1ba9780914a272c4b0022c3293b"><div class="ttname"><a href="namespaceRDDepict.html#afe19d1ba9780914a272c4b0022c3293b">RDDepict::findBondsPairsToPermuteDeg4</a></div><div class="ttdeci">INT_PAIR_VECT findBondsPairsToPermuteDeg4(const RDGeom::Point2D &amp;center, const RDKit::INT_VECT &amp;nbrBids, const VECT_C_POINT &amp;nbrLocs)</div><div class="ttdoc">Find pairs of bonds that can be permuted at a non-ring degree 4 atom. </div></div>
<div class="ttc" id="namespaceRDDepict_html_a89f0701480dd780d179fdebbca21272b"><div class="ttname"><a href="namespaceRDDepict.html#a89f0701480dd780d179fdebbca21272b">RDDepict::BOND_THRES</a></div><div class="ttdeci">double BOND_THRES</div></div>
<div class="ttc" id="RDKitBase_8h_html"><div class="ttname"><a href="RDKitBase_8h.html">RDKitBase.h</a></div><div class="ttdoc">pulls in the core RDKit functionality </div></div>
<div class="ttc" id="classRDKit_1_1ROMol_html"><div class="ttname"><a href="classRDKit_1_1ROMol.html">RDKit::ROMol</a></div><div class="ttdoc">ROMol is a molecule class that is intended to have a fixed topology. </div><div class="ttdef"><b>Definition:</b> <a href="ROMol_8h_source.html#l00103">ROMol.h:103</a></div></div>
<div class="ttc" id="classRDKit_1_1Atom_html_aa26d87bb2aee6fcad634fdc23ca13b77"><div class="ttname"><a href="classRDKit_1_1Atom.html#aa26d87bb2aee6fcad634fdc23ca13b77">RDKit::Atom::getDegree</a></div><div class="ttdeci">unsigned int getDegree() const </div></div>
<div class="ttc" id="namespaceRDKit_html_a44eafa424a4e9580b730ca0ec73c7540"><div class="ttname"><a href="namespaceRDKit.html#a44eafa424a4e9580b730ca0ec73c7540">RDKit::VECT_INT_VECT</a></div><div class="ttdeci">std::vector&lt; INT_VECT &gt; VECT_INT_VECT</div><div class="ttdef"><b>Definition:</b> <a href="types_8h_source.html#l00205">types.h:205</a></div></div>
<div class="ttc" id="namespaceRDDepict_html_a5d8a7f118e85ea5d67acc695147891f6"><div class="ttname"><a href="namespaceRDDepict.html#a5d8a7f118e85ea5d67acc695147891f6">RDDepict::VECT_C_POINT</a></div><div class="ttdeci">std::vector&lt; const RDGeom::Point2D * &gt; VECT_C_POINT</div><div class="ttdef"><b>Definition:</b> <a href="DepictUtils_8h_source.html#l00031">DepictUtils.h:31</a></div></div>
<div class="ttc" id="namespaceRDGeom_html_a35989ac0bc413e5118210622f4805866"><div class="ttname"><a href="namespaceRDGeom.html#a35989ac0bc413e5118210622f4805866">RDGeom::INT_POINT2D_MAP</a></div><div class="ttdeci">std::map&lt; int, Point2D &gt; INT_POINT2D_MAP</div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00511">point.h:511</a></div></div>
<div class="ttc" id="namespaceRDDepict_html_a85b2de51991b56105cb73c6f0dc3c503"><div class="ttname"><a href="namespaceRDDepict.html#a85b2de51991b56105cb73c6f0dc3c503">RDDepict::INT_PAIR_VECT</a></div><div class="ttdeci">std::vector&lt; INT_PAIR &gt; INT_PAIR_VECT</div><div class="ttdef"><b>Definition:</b> <a href="DepictUtils_8h_source.html#l00159">DepictUtils.h:159</a></div></div>
<div class="ttc" id="namespaceRDDepict_html_a7e73ec07bb1a0e2872ee0deba95d3539"><div class="ttname"><a href="namespaceRDDepict.html#a7e73ec07bb1a0e2872ee0deba95d3539">RDDepict::PR_QUEUE</a></div><div class="ttdeci">std::priority_queue&lt; PAIR_I_I, VECT_PII, gtIIPair &gt; PR_QUEUE</div><div class="ttdef"><b>Definition:</b> <a href="DepictUtils_8h_source.html#l00041">DepictUtils.h:41</a></div></div>
<div class="ttc" id="namespaceRDDepict_html"><div class="ttname"><a href="namespaceRDDepict.html">RDDepict</a></div><div class="ttdef"><b>Definition:</b> <a href="Reaction_8h_source.html#l00434">Reaction.h:434</a></div></div>
<div class="ttc" id="namespaceRDDepict_html_a426a8f28b5fb7ba9806f168618ce8c29"><div class="ttname"><a href="namespaceRDDepict.html#a426a8f28b5fb7ba9806f168618ce8c29">RDDepict::pickFirstRingToEmbed</a></div><div class="ttdeci">int pickFirstRingToEmbed(const RDKit::ROMol &amp;mol, const RDKit::VECT_INT_VECT &amp;fusedRings)</div><div class="ttdoc">pick the ring to embed first in a fused system </div></div>
<div class="ttc" id="classRDKit_1_1Atom_html_a1b65245c6e3ed07f11327c3ea850acc5"><div class="ttname"><a href="classRDKit_1_1Atom.html#a1b65245c6e3ed07f11327c3ea850acc5">RDKit::Atom::getAtomicNum</a></div><div class="ttdeci">int getAtomicNum() const </div><div class="ttdoc">returns our atomic number </div><div class="ttdef"><b>Definition:</b> <a href="Atom_8h_source.html#l00116">Atom.h:116</a></div></div>
<div class="ttc" id="namespaceRDKit_html_a1d1aa140f55ea44f46af9ff22bfcaf8d"><div class="ttname"><a href="namespaceRDKit.html#a1d1aa140f55ea44f46af9ff22bfcaf8d">RDKit::INT_VECT</a></div><div class="ttdeci">std::vector&lt; int &gt; INT_VECT</div><div class="ttdef"><b>Definition:</b> <a href="types_8h_source.html#l00191">types.h:191</a></div></div>
<div class="ttc" id="classRDGeom_1_1Point2D_html_a3d85340394eef9d8f918df3994be412e"><div class="ttname"><a href="classRDGeom_1_1Point2D.html#a3d85340394eef9d8f918df3994be412e">RDGeom::Point2D::normalize</a></div><div class="ttdeci">void normalize()</div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00324">point.h:324</a></div></div>
<div class="ttc" id="namespaceRDDepict_html_a9efd60ef0c84d904236a926cbba4ac28"><div class="ttname"><a href="namespaceRDDepict.html#a9efd60ef0c84d904236a926cbba4ac28">RDDepict::setNbrOrder</a></div><div class="ttdeci">RDKit::INT_VECT setNbrOrder(unsigned int aid, const RDKit::INT_VECT &amp;nbrs, const RDKit::ROMol &amp;mol)</div><div class="ttdoc">Set the neighbors yet to added to aid such that the atoms with the most subs. </div></div>
<div class="ttc" id="namespaceRDDepict_html_a0fb6bbed6f567e903b7b875860dae5a3"><div class="ttname"><a href="namespaceRDDepict.html#a0fb6bbed6f567e903b7b875860dae5a3">RDDepict::transformPoints</a></div><div class="ttdeci">void transformPoints(RDGeom::INT_POINT2D_MAP &amp;nringCor, const RDGeom::Transform2D &amp;trans)</div></div>
<div class="ttc" id="namespaceRDDepict_html_a50b3bd01291bbc39a4201f9dc2e9eec6"><div class="ttname"><a href="namespaceRDDepict.html#a50b3bd01291bbc39a4201f9dc2e9eec6">RDDepict::DOUBLE_INT_PAIR</a></div><div class="ttdeci">std::pair&lt; double, INT_PAIR &gt; DOUBLE_INT_PAIR</div><div class="ttdef"><b>Definition:</b> <a href="DepictUtils_8h_source.html#l00162">DepictUtils.h:162</a></div></div>
<div class="ttc" id="namespaceRDDepict_html_adfbf3b426c0b96c6847b1acdae21a3c0"><div class="ttname"><a href="namespaceRDDepict.html#adfbf3b426c0b96c6847b1acdae21a3c0">RDDepict::INT_PAIR_VECT_CI</a></div><div class="ttdeci">INT_PAIR_VECT::const_iterator INT_PAIR_VECT_CI</div><div class="ttdef"><b>Definition:</b> <a href="DepictUtils_8h_source.html#l00160">DepictUtils.h:160</a></div></div>
<div class="ttc" id="structRDDepict_1_1gtIIPair_html"><div class="ttname"><a href="structRDDepict_1_1gtIIPair.html">RDDepict::gtIIPair</a></div><div class="ttdef"><b>Definition:</b> <a href="DepictUtils_8h_source.html#l00035">DepictUtils.h:35</a></div></div>
<div class="ttc" id="namespaceRDDepict_html_a0b978c76285bf6795b0abc7b7f84b780"><div class="ttname"><a href="namespaceRDDepict.html#a0b978c76285bf6795b0abc7b7f84b780">RDDepict::getAtomDepictRank</a></div><div class="ttdeci">int getAtomDepictRank(const RDKit::Atom *at)</div><div class="ttdoc">returns the rank of the atom for determining draw order </div><div class="ttdef"><b>Definition:</b> <a href="DepictUtils_8h_source.html#l00350">DepictUtils.h:350</a></div></div>
<div class="ttc" id="classRDGeom_1_1Point2D_html_a8f6549411b18d15ab673ea601ce1432d"><div class="ttname"><a href="classRDGeom_1_1Point2D.html#a8f6549411b18d15ab673ea601ce1432d">RDGeom::Point2D::angleTo</a></div><div class="ttdeci">double angleTo(const Point2D &amp;other) const </div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00352">point.h:352</a></div></div>
<div class="ttc" id="classRDKit_1_1Atom_html_a58e40e30db6b42826243163175cac976"><div class="ttname"><a href="classRDKit_1_1Atom.html#a58e40e30db6b42826243163175cac976">RDKit::Atom::HybridizationType</a></div><div class="ttdeci">HybridizationType</div><div class="ttdoc">store hybridization </div><div class="ttdef"><b>Definition:</b> <a href="Atom_8h_source.html#l00080">Atom.h:80</a></div></div>
<div class="ttc" id="classRDKit_1_1Atom_html_a58e40e30db6b42826243163175cac976abf5e1c0d5acd32e59cc1b0975f4bad2e"><div class="ttname"><a href="classRDKit_1_1Atom.html#a58e40e30db6b42826243163175cac976abf5e1c0d5acd32e59cc1b0975f4bad2e">RDKit::Atom::SP2</a></div><div class="ttdef"><b>Definition:</b> <a href="Atom_8h_source.html#l00084">Atom.h:84</a></div></div>
<div class="ttc" id="namespaceRDDepict_html_a84946688805616d12983805489787c9f"><div class="ttname"><a href="namespaceRDDepict.html#a84946688805616d12983805489787c9f">RDDepict::VECT_PII</a></div><div class="ttdeci">std::vector&lt; PAIR_I_I &gt; VECT_PII</div><div class="ttdef"><b>Definition:</b> <a href="DepictUtils_8h_source.html#l00034">DepictUtils.h:34</a></div></div>
<div class="ttc" id="namespaceRDDepict_html_ac3438aaf1da6146d84ad7bdb0d2a626b"><div class="ttname"><a href="namespaceRDDepict.html#ac3438aaf1da6146d84ad7bdb0d2a626b">RDDepict::computeNormal</a></div><div class="ttdeci">RDGeom::Point2D computeNormal(const RDGeom::Point2D &amp;center, const RDGeom::Point2D &amp;other)</div><div class="ttdoc">computes and return the normal of a vector between two points </div><div class="ttdef"><b>Definition:</b> <a href="DepictUtils_8h_source.html#l00252">DepictUtils.h:252</a></div></div>
<div class="ttc" id="namespaceRDDepict_html_ab8b340c558ecfd0305dfa0ac911b7cb7"><div class="ttname"><a href="namespaceRDDepict.html#ab8b340c558ecfd0305dfa0ac911b7cb7">RDDepict::embedRing</a></div><div class="ttdeci">RDGeom::INT_POINT2D_MAP embedRing(const RDKit::INT_VECT &amp;ring)</div><div class="ttdoc">Some utility functions used in generating 2D coordinates. </div></div>
<div class="ttc" id="namespaceRDDepict_html_a8c89d9dd6610e843707b8535a0874d98"><div class="ttname"><a href="namespaceRDDepict.html#a8c89d9dd6610e843707b8535a0874d98">RDDepict::COLLISION_THRES</a></div><div class="ttdeci">double COLLISION_THRES</div></div>
<div class="ttc" id="namespaceRDDepict_html_a15fb0c5b7657c623b4852bd4184374d9"><div class="ttname"><a href="namespaceRDDepict.html#a15fb0c5b7657c623b4852bd4184374d9">RDDepict::reflectPoint</a></div><div class="ttdeci">RDGeom::Point2D reflectPoint(const RDGeom::Point2D &amp;point, const RDGeom::Point2D &amp;loc1, const RDGeom::Point2D &amp;loc2)</div></div>
<div class="ttc" id="structRDDepict_1_1gtIIPair_html_a013178b0b8b7ff65dc0ad743e504da8e"><div class="ttname"><a href="structRDDepict_1_1gtIIPair.html#a013178b0b8b7ff65dc0ad743e504da8e">RDDepict::gtIIPair::operator()</a></div><div class="ttdeci">bool operator()(const PAIR_I_I &amp;pd1, const PAIR_I_I &amp;pd2) const </div><div class="ttdef"><b>Definition:</b> <a href="DepictUtils_8h_source.html#l00036">DepictUtils.h:36</a></div></div>
<div class="ttc" id="classRDKit_1_1Atom_html_a58e40e30db6b42826243163175cac976a385dd0f8e1df8580b91bf8e62001a709"><div class="ttname"><a href="classRDKit_1_1Atom.html#a58e40e30db6b42826243163175cac976a385dd0f8e1df8580b91bf8e62001a709">RDKit::Atom::SP3</a></div><div class="ttdef"><b>Definition:</b> <a href="Atom_8h_source.html#l00085">Atom.h:85</a></div></div>
<div class="ttc" id="namespaceRDDepict_html_ac99e2f94e473bdf60abc9d8ec2e7e7cf"><div class="ttname"><a href="namespaceRDDepict.html#ac99e2f94e473bdf60abc9d8ec2e7e7cf">RDDepict::getNbrAtomAndBondIds</a></div><div class="ttdeci">void getNbrAtomAndBondIds(unsigned int aid, const RDKit::ROMol *mol, RDKit::INT_VECT &amp;aids, RDKit::INT_VECT &amp;bids)</div><div class="ttdoc">Get the ids of the atoms and bonds that are connected to aid. </div></div>
<div class="ttc" id="namespaceRDDepict_html_a4f472354f7954240df792a0e4d114441"><div class="ttname"><a href="namespaceRDDepict.html#a4f472354f7954240df792a0e4d114441">RDDepict::HETEROATOM_COLL_SCALE</a></div><div class="ttdeci">double HETEROATOM_COLL_SCALE</div></div>
<div class="ttc" id="namespaceRDDepict_html_adea542de9aebe1a744016371ad50682c"><div class="ttname"><a href="namespaceRDDepict.html#adea542de9aebe1a744016371ad50682c">RDDepict::rankAtomsByRank</a></div><div class="ttdeci">T rankAtomsByRank(const RDKit::ROMol &amp;mol, const T &amp;commAtms, bool ascending=true)</div><div class="ttdoc">Sort a list of atoms by their CIP rank. </div></div>
<div class="ttc" id="classRDGeom_1_1Point2D_html_af65f5002a49449c0aed2ba3301f88ff0"><div class="ttname"><a href="classRDGeom_1_1Point2D.html#af65f5002a49449c0aed2ba3301f88ff0">RDGeom::Point2D::x</a></div><div class="ttdeci">double x</div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00256">point.h:256</a></div></div>
<div class="ttc" id="namespaceRDDepict_html_a7d1ffc508c4dea5d33b3297576e7be21"><div class="ttname"><a href="namespaceRDDepict.html#a7d1ffc508c4dea5d33b3297576e7be21">RDDepict::findNextRingToEmbed</a></div><div class="ttdeci">RDKit::INT_VECT findNextRingToEmbed(const RDKit::INT_VECT &amp;doneRings, const RDKit::VECT_INT_VECT &amp;fusedRings, int &amp;nextId)</div><div class="ttdoc">From a given set of rings find the ring the largest common elements. </div></div>
<div class="ttc" id="namespaceRDDepict_html_a4b5c8786715a63dde2c6d1257fe615be"><div class="ttname"><a href="namespaceRDDepict.html#a4b5c8786715a63dde2c6d1257fe615be">RDDepict::rotationDir</a></div><div class="ttdeci">int rotationDir(const RDGeom::Point2D &amp;center, const RDGeom::Point2D &amp;loc1, const RDGeom::Point2D &amp;loc2, double remAngle)</div><div class="ttdoc">computes the rotation direction between two vectors </div><div class="ttdef"><b>Definition:</b> <a href="DepictUtils_8h_source.html#l00230">DepictUtils.h:230</a></div></div>
<div class="ttc" id="namespaceRDDepict_html_a80b75cd65da43409086de2cd723efe57"><div class="ttname"><a href="namespaceRDDepict.html#a80b75cd65da43409086de2cd723efe57">RDDepict::LIST_PAIR_DII</a></div><div class="ttdeci">std::list&lt; PAIR_D_I_I &gt; LIST_PAIR_DII</div><div class="ttdef"><b>Definition:</b> <a href="DepictUtils_8h_source.html#l00044">DepictUtils.h:44</a></div></div>
<div class="ttc" id="namespaceRDDepict_html_aa535f505e1fcc5defd3f92c50f6e846a"><div class="ttname"><a href="namespaceRDDepict.html#aa535f505e1fcc5defd3f92c50f6e846a">RDDepict::getAllRotatableBonds</a></div><div class="ttdeci">RDKit::INT_VECT getAllRotatableBonds(const RDKit::ROMol &amp;mol)</div><div class="ttdoc">find all the rotatable bonds in a molecule we will ignore ring atoms, and double bonds which are mark...</div></div>
<div class="ttc" id="classRDKit_1_1Atom_html"><div class="ttname"><a href="classRDKit_1_1Atom.html">RDKit::Atom</a></div><div class="ttdoc">The class for representing atoms. </div><div class="ttdef"><b>Definition:</b> <a href="Atom_8h_source.html#l00068">Atom.h:68</a></div></div>
<div class="ttc" id="MMFF_2Params_8h_html_ae71449b1cc6e6250b91f539153a7a0d3"><div class="ttname"><a href="MMFF_2Params_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a></div><div class="ttdeci">#define M_PI</div><div class="ttdef"><b>Definition:</b> <a href="MMFF_2Params_8h_source.html#l00025">MMFF/Params.h:25</a></div></div>
<div class="ttc" id="RWMol_8h_html"><div class="ttname"><a href="RWMol_8h.html">RWMol.h</a></div><div class="ttdoc">Defines the editable molecule class RWMol. </div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_7405883c90e3ba906164954ba668c0d7.html">GraphMol</a></li><li class="navelem"><a class="el" href="dir_50572f68a649c99eadd26d1a058244cd.html">Depictor</a></li><li class="navelem"><a class="el" href="DepictUtils_8h.html">DepictUtils.h</a></li>
    <li class="footer">Generated on Tue Jan 23 2018 11:03:06 for RDKit by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
