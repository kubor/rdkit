<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>RDKit: Catalog.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo_plain.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">RDKit
   </div>
   <div id="projectbrief">Open-source cheminformatics and machine learning.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('Catalog_8h_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Catalog.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="Catalog_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//  Copyright (C) 2003-2006 Rational Discovery LLC</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//  @@ All Rights Reserved @@</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//  This file is part of the RDKit.</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//  The contents are covered by the terms of the BSD license</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//  which is included in the file license.txt, found at the root</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//  of the RDKit source tree.</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#ifndef __RD_CATALOG_H__</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#define __RD_CATALOG_H__</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">// Boost graph stuff</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="BoostStartInclude_8h.html">RDGeneral/BoostStartInclude.h</a>&gt;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &lt;boost/graph/graph_traits.hpp&gt;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;boost/graph/adjacency_list.hpp&gt;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;boost/version.hpp&gt;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#if BOOST_VERSION &gt;= 104000</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &lt;boost/property_map/property_map.hpp&gt;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &lt;boost/property_map.hpp&gt;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="BoostEndInclude_8h.html">RDGeneral/BoostEndInclude.h</a>&gt;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">// for some typedefs</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="types_8h.html">RDGeneral/types.h</a>&gt;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="StreamOps_8h.html">RDGeneral/StreamOps.h</a>&gt;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div><div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="namespaceRDCatalog.html">   30</a></span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceRDCatalog.html">RDCatalog</a> {</div><div class="line"><a name="l00031"></a><span class="lineno"><a class="line" href="namespaceRDCatalog.html#a7c4ea39e05b3a9041523cdc7f54d0de9">   31</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="namespaceRDCatalog.html#a7c4ea39e05b3a9041523cdc7f54d0de9">versionMajor</a> = 1;</div><div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="namespaceRDCatalog.html#a3437dcfc90c18c2ae6e11a9cf4a1c2da">   32</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="namespaceRDCatalog.html#a3437dcfc90c18c2ae6e11a9cf4a1c2da">versionMinor</a> = 0;</div><div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="namespaceRDCatalog.html#a955c419c8f44f391f84b3d570831a031">   33</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="namespaceRDCatalog.html#a955c419c8f44f391f84b3d570831a031">versionPatch</a> = 0;</div><div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="namespaceRDCatalog.html#a2f96f9f0ed5f13ba820a8c1b17e41b45">   34</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="namespaceRDCatalog.html#a2f96f9f0ed5f13ba820a8c1b17e41b45">endianId</a> = 0xDEADBEEF;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">//-----------------------------------------------------------------------------</span><span class="comment"></span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">//! abstract base class for a catalog object</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment"></span><span class="keyword">template</span> &lt;<span class="keyword">class</span> entryType, <span class="keyword">class</span> paramType&gt;</div><div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="classRDCatalog_1_1Catalog.html">   39</a></span>&#160;<span class="keyword">class </span><a class="code" href="classRDCatalog_1_1Catalog.html">Catalog</a> {</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="classRDCatalog_1_1Catalog.html#a55774178758e0b135ad6d6d32193586e">   41</a></span>&#160;  <span class="keyword">typedef</span> entryType <a class="code" href="classRDCatalog_1_1Catalog.html#a55774178758e0b135ad6d6d32193586e">entryType_t</a>;</div><div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="classRDCatalog_1_1Catalog.html#ae53f636049a2abfe83061e06596b040a">   42</a></span>&#160;  <span class="keyword">typedef</span> paramType <a class="code" href="classRDCatalog_1_1Catalog.html#ae53f636049a2abfe83061e06596b040a">paramType_t</a>;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="comment">//------------------------------------</span></div><div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="classRDCatalog_1_1Catalog.html#abd1479db0176fbe70ea4be82786b36b6">   45</a></span>&#160;  <a class="code" href="classRDCatalog_1_1Catalog.html#abd1479db0176fbe70ea4be82786b36b6">Catalog</a>() : <a class="code" href="classRDCatalog_1_1Catalog.html#aca46b909f065692080fbdf3593e5dc2d">d_fpLength</a>(0), <a class="code" href="classRDCatalog_1_1Catalog.html#aa4e97ddc394fa23da4466784d84da290">dp_cParams</a>(0){};</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="comment">//------------------------------------</span></div><div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="classRDCatalog_1_1Catalog.html#a9eb2ad9bb8ad739f3673901af6d3c48e">   48</a></span>&#160;  <span class="keyword">virtual</span> <a class="code" href="classRDCatalog_1_1Catalog.html#a9eb2ad9bb8ad739f3673901af6d3c48e">~Catalog</a>() { <span class="keyword">delete</span> <a class="code" href="classRDCatalog_1_1Catalog.html#aa4e97ddc394fa23da4466784d84da290">dp_cParams</a>; }</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="comment">//------------------------------------</span><span class="comment"></span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">  //! return a serialized form of the Catalog as an std::string</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> std::string <a class="code" href="classRDCatalog_1_1Catalog.html#a065fd05bc4c0d272424a07d793a97e15">Serialize</a>() <span class="keyword">const</span> = 0;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="comment">//------------------------------------</span><span class="comment"></span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">  //! adds an entry to the catalog</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment"></span><span class="comment">  /*!</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">    \param entry          the entry to be added</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">    \param updateFPLength (optional) if this is true, our internal</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">    fingerprint length will also be updated.</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classRDCatalog_1_1Catalog.html#a0807840de7e8b4f4a298e3d30576d7c5">addEntry</a>(entryType *entry,</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                                <span class="keywordtype">bool</span> updateFPLength = <span class="keyword">true</span>) = 0;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="comment">//------------------------------------</span><span class="comment"></span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">  //! returns a particular entry in the Catalog</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keyword">const</span> entryType *<a class="code" href="classRDCatalog_1_1Catalog.html#a19d94805a1b0e9bc565fcaab09b5fec4">getEntryWithIdx</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> idx) <span class="keyword">const</span> = 0;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="comment">//------------------------------------</span><span class="comment"></span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">  //! returns the number of entries</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classRDCatalog_1_1Catalog.html#a87425c9095c3c14266f21e9e033bbb1a">getNumEntries</a>() <span class="keyword">const</span> = 0;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="comment">//------------------------------------</span><span class="comment"></span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">  //! returns the length of our fingerprint</span></div><div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="classRDCatalog_1_1Catalog.html#a3c3947d2cc254fef9791ba99fb04e00b">   76</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classRDCatalog_1_1Catalog.html#a3c3947d2cc254fef9791ba99fb04e00b">getFPLength</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classRDCatalog_1_1Catalog.html#aca46b909f065692080fbdf3593e5dc2d">d_fpLength</a>; }</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="comment">//------------------------------------</span><span class="comment"></span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">  //! sets our fingerprint length</span></div><div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="classRDCatalog_1_1Catalog.html#ae20801408f3e87ee2993c1ba43f5cb90">   80</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classRDCatalog_1_1Catalog.html#ae20801408f3e87ee2993c1ba43f5cb90">setFPLength</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> val) { <a class="code" href="classRDCatalog_1_1Catalog.html#aca46b909f065692080fbdf3593e5dc2d">d_fpLength</a> = val; }</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="comment">//------------------------------------</span><span class="comment"></span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">  //! sets our parameters by copying the \c params argument</span></div><div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="classRDCatalog_1_1Catalog.html#aae0faa196e834e6561e2a2724fc9c19a">   84</a></span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classRDCatalog_1_1Catalog.html#aae0faa196e834e6561e2a2724fc9c19a">setCatalogParams</a>(paramType *params) {</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <a class="code" href="Invariant_8h.html#a8508523356cb237df34d08a9fcba9ec5">PRECONDITION</a>(params, <span class="stringliteral">&quot;bad parameter object&quot;</span>);</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="comment">// if we already have a paramter object throw an exception</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="Invariant_8h.html#a8508523356cb237df34d08a9fcba9ec5">PRECONDITION</a>(!<a class="code" href="classRDCatalog_1_1Catalog.html#aa4e97ddc394fa23da4466784d84da290">dp_cParams</a>,</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                 <span class="stringliteral">&quot;A parameter object already exists on the catalog&quot;</span>);</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">      if (dp_cParams) {</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">      // we already have parameter object on the catalog</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">      // can&#39;t overwrite it</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">      PRECONDITION(0, &quot;A parameter object already exist on the catalog&quot;);</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">      }*/</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <a class="code" href="classRDCatalog_1_1Catalog.html#aa4e97ddc394fa23da4466784d84da290">dp_cParams</a> = <span class="keyword">new</span> paramType(*params);</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  }</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="comment">//------------------------------------</span><span class="comment"></span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">  //! returns a pointer to our parameters</span></div><div class="line"><a name="l00100"></a><span class="lineno"><a class="line" href="classRDCatalog_1_1Catalog.html#aa469a6ca9706b34f1a07f17ae1d45a8b">  100</a></span>&#160;<span class="comment"></span>  <span class="keyword">const</span> paramType *<a class="code" href="classRDCatalog_1_1Catalog.html#aa469a6ca9706b34f1a07f17ae1d45a8b">getCatalogParams</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classRDCatalog_1_1Catalog.html#aa4e97ddc394fa23da4466784d84da290">dp_cParams</a>; }</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; <span class="keyword">protected</span>:</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="comment">// this is the ID that will be assigned to the next entry</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="comment">// added to the catalog - need not be same as the number of entries</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="comment">// in the catalog and does not correspond with the</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="comment">// id of the entry in the catalog.</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="comment">// this is more along the lines of bitId</span></div><div class="line"><a name="l00108"></a><span class="lineno"><a class="line" href="classRDCatalog_1_1Catalog.html#aca46b909f065692080fbdf3593e5dc2d">  108</a></span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classRDCatalog_1_1Catalog.html#aca46b909f065692080fbdf3593e5dc2d">d_fpLength</a>;  <span class="comment">//!&lt; the length of our fingerprint</span></div><div class="line"><a name="l00109"></a><span class="lineno"><a class="line" href="classRDCatalog_1_1Catalog.html#aa4e97ddc394fa23da4466784d84da290">  109</a></span>&#160;<span class="comment"></span>  paramType *<a class="code" href="classRDCatalog_1_1Catalog.html#aa4e97ddc394fa23da4466784d84da290">dp_cParams</a>;    <span class="comment">//!&lt; our params object</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment"></span>};</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">//-----------------------------------------------------------------------------</span><span class="comment"></span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">//! A Catalog with a hierarchical structure</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment"></span><span class="comment">/*!</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">  The entries of a HierarchCatalog are arranged in a directed graph</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">  &lt;b&gt;The difference between &lt;i&gt;Indices&lt;/i&gt; and &lt;i&gt;Bit Ids&lt;/i&gt;&lt;/b&gt;</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">  A HierarchCatalog may contain more entries than the user is actually</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">  interested in.  For example a HierarchCatalog constructed to contain</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">  orders 5 through 8 may well contain information about orders 1-5,</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">  in order to facilitate some search optimizations.</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">  - &lt;i&gt;Bit Ids&lt;/i&gt; refer to the &quot;interesting&quot; bits.</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">  So, in the above example, Bit Id \c 0 will be the first entry</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">  with order 5.</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">  - &lt;i&gt;Indices&lt;/i&gt; refer to the underlying structure of the catalog.</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">  So, in the above example, the entry with index \c 0 will be</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">  the first entry with order 1.</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> entryType, <span class="keyword">class</span> paramType, <span class="keyword">class</span> orderType&gt;</div><div class="line"><a name="l00134"></a><span class="lineno"><a class="line" href="classRDCatalog_1_1HierarchCatalog.html">  134</a></span>&#160;<span class="keyword">class </span><a class="code" href="classRDCatalog_1_1HierarchCatalog.html">HierarchCatalog</a> : <span class="keyword">public</span> <a class="code" href="classRDCatalog_1_1Catalog.html">Catalog</a>&lt;entryType, paramType&gt; {</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="comment">// the entries in the catalog can be traversed using the edges</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <span class="comment">// in a desired order</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; <span class="keyword">public</span>:<span class="comment"></span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">  //! used by the BGL to set up the node properties in our graph</span></div><div class="line"><a name="l00139"></a><span class="lineno"><a class="line" href="structRDCatalog_1_1HierarchCatalog_1_1vertex__entry__t.html">  139</a></span>&#160;<span class="comment"></span>  <span class="keyword">struct </span><a class="code" href="structRDCatalog_1_1HierarchCatalog_1_1vertex__entry__t.html">vertex_entry_t</a> {</div><div class="line"><a name="l00140"></a><span class="lineno"><a class="line" href="structRDCatalog_1_1HierarchCatalog_1_1vertex__entry__t.html#a7a8ac80a3e230a878bf7a8139f1a509fa31d78174c34018c757e4b611b8e13d64">  140</a></span>&#160;    <span class="keyword">enum</span> { num = 1003 };</div><div class="line"><a name="l00141"></a><span class="lineno"><a class="line" href="structRDCatalog_1_1HierarchCatalog_1_1vertex__entry__t.html#a48afd5f52629363a3ea7df8fca7b4544">  141</a></span>&#160;    <span class="keyword">typedef</span> boost::vertex_property_tag <a class="code" href="structRDCatalog_1_1HierarchCatalog_1_1vertex__entry__t.html#a48afd5f52629363a3ea7df8fca7b4544">kind</a>;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  };</div><div class="line"><a name="l00143"></a><span class="lineno"><a class="line" href="classRDCatalog_1_1HierarchCatalog.html#ab67ded8a194ce44b8a9475df43499b5f">  143</a></span>&#160;  <span class="keyword">typedef</span> boost::property&lt;vertex_entry_t, entryType *&gt; <a class="code" href="classRDCatalog_1_1HierarchCatalog.html#ab67ded8a194ce44b8a9475df43499b5f">EntryProperty</a>;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">  //! the type of the graph itself:</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment"></span>  <span class="keyword">typedef</span> boost::adjacency_list&lt;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      boost::vecS,</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      boost::vecS,  <span class="comment">// FIX: should be using setS for edges so that parallel</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                    <span class="comment">// edges are never added (page 225 BGL book)</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <span class="comment">// but that seems result in compile errors</span></div><div class="line"><a name="l00151"></a><span class="lineno"><a class="line" href="classRDCatalog_1_1HierarchCatalog.html#a87d59c32d2c18885a0b456fe7cfd7057">  151</a></span>&#160;      boost::bidirectionalS, EntryProperty&gt; <a class="code" href="classRDCatalog_1_1HierarchCatalog.html#a87d59c32d2c18885a0b456fe7cfd7057">CatalogGraph</a>;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div><div class="line"><a name="l00153"></a><span class="lineno"><a class="line" href="classRDCatalog_1_1HierarchCatalog.html#a089d81495a21014d7705822e12381218">  153</a></span>&#160;  <span class="keyword">typedef</span> boost::graph_traits&lt;CatalogGraph&gt; <a class="code" href="classRDCatalog_1_1HierarchCatalog.html#a089d81495a21014d7705822e12381218">CAT_GRAPH_TRAITS</a>;</div><div class="line"><a name="l00154"></a><span class="lineno"><a class="line" href="classRDCatalog_1_1HierarchCatalog.html#a3259eac3ceff5c12a103e8895214b06b">  154</a></span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> CAT_GRAPH_TRAITS::vertex_iterator <a class="code" href="classRDCatalog_1_1HierarchCatalog.html#a3259eac3ceff5c12a103e8895214b06b">VER_ITER</a>;</div><div class="line"><a name="l00155"></a><span class="lineno"><a class="line" href="classRDCatalog_1_1HierarchCatalog.html#a976ad400d1bb1c2919a193b87e0dc362">  155</a></span>&#160;  <span class="keyword">typedef</span> std::pair&lt;VER_ITER, VER_ITER&gt; <a class="code" href="classRDCatalog_1_1HierarchCatalog.html#a976ad400d1bb1c2919a193b87e0dc362">ENT_ITER_PAIR</a>;</div><div class="line"><a name="l00156"></a><span class="lineno"><a class="line" href="classRDCatalog_1_1HierarchCatalog.html#a368a0ffe44a9d08a0721c0d46bf67a64">  156</a></span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> CAT_GRAPH_TRAITS::adjacency_iterator <a class="code" href="classRDCatalog_1_1HierarchCatalog.html#a368a0ffe44a9d08a0721c0d46bf67a64">DOWN_ENT_ITER</a>;</div><div class="line"><a name="l00157"></a><span class="lineno"><a class="line" href="classRDCatalog_1_1HierarchCatalog.html#ac1593a7b8757c9a6175e9f9a16dfab50">  157</a></span>&#160;  <span class="keyword">typedef</span> std::pair&lt;DOWN_ENT_ITER, DOWN_ENT_ITER&gt; <a class="code" href="classRDCatalog_1_1HierarchCatalog.html#ac1593a7b8757c9a6175e9f9a16dfab50">DOWN_ENT_ITER_PAIR</a>;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <span class="comment">//------------------------------------</span></div><div class="line"><a name="l00160"></a><span class="lineno"><a class="line" href="classRDCatalog_1_1HierarchCatalog.html#af09db48bb4392b2f2643608c946c5dfe">  160</a></span>&#160;  <a class="code" href="classRDCatalog_1_1HierarchCatalog.html">HierarchCatalog&lt;entryType, paramType, orderType&gt;</a>(){};</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <span class="comment">//------------------------------------</span><span class="comment"></span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">  //! Construct by making a copy of the input \c params object</span></div><div class="line"><a name="l00164"></a><span class="lineno"><a class="line" href="classRDCatalog_1_1HierarchCatalog.html#a24631c3c301f1b33fffdbd6ec761938d">  164</a></span>&#160;<span class="comment"></span>  <a class="code" href="classRDCatalog_1_1HierarchCatalog.html">HierarchCatalog&lt;entryType, paramType, orderType&gt;</a>(paramType *params)</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      : <a class="code" href="classRDCatalog_1_1Catalog.html">Catalog&lt;entryType, paramType&gt;</a>() {</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    this-&gt;<a class="code" href="classRDCatalog_1_1Catalog.html#aae0faa196e834e6561e2a2724fc9c19a">setCatalogParams</a>(params);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  }</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="comment">//------------------------------------</span><span class="comment"></span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">  //! Construct from a \c pickle (a serialized form of the HierarchCatalog)</span></div><div class="line"><a name="l00171"></a><span class="lineno"><a class="line" href="classRDCatalog_1_1HierarchCatalog.html#a856acb7dd4cf762eb5ee1713700a9f6f">  171</a></span>&#160;<span class="comment"></span>  <a class="code" href="classRDCatalog_1_1HierarchCatalog.html">HierarchCatalog&lt;entryType, paramType, orderType&gt;</a>(<span class="keyword">const</span> std::string &amp;<a class="code" href="namespaceRDKit_1_1EnumerationStrategyPickler.html#aee2e7efc329d5ef918764c5aa5ce7836">pickle</a>) {</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    this-&gt;initFromString(<a class="code" href="namespaceRDKit_1_1EnumerationStrategyPickler.html#aee2e7efc329d5ef918764c5aa5ce7836">pickle</a>);</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  }</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="comment">//------------------------------------</span></div><div class="line"><a name="l00176"></a><span class="lineno"><a class="line" href="classRDCatalog_1_1HierarchCatalog.html#a24a2ca3195acc0e14adbfdda89462f0f">  176</a></span>&#160;  <a class="code" href="classRDCatalog_1_1HierarchCatalog.html#a24a2ca3195acc0e14adbfdda89462f0f">~HierarchCatalog</a>() { destroy(); }</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="comment">//------------------------------------</span><span class="comment"></span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">  //! serializes this object to a stream</span></div><div class="line"><a name="l00180"></a><span class="lineno"><a class="line" href="classRDCatalog_1_1HierarchCatalog.html#afb66201eea33105fa71af2e66ecc5d38">  180</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classRDCatalog_1_1HierarchCatalog.html#afb66201eea33105fa71af2e66ecc5d38">toStream</a>(std::ostream &amp;ss)<span class="keyword"> const </span>{</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <a class="code" href="Invariant_8h.html#a8508523356cb237df34d08a9fcba9ec5">PRECONDITION</a>(this-&gt;<a class="code" href="classRDCatalog_1_1Catalog.html#aa469a6ca9706b34f1a07f17ae1d45a8b">getCatalogParams</a>(), <span class="stringliteral">&quot;NULL parameter object&quot;</span>);</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="comment">// the i/o header:</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <a class="code" href="namespaceRDKit.html#ae03a38eb30281348650ad88b4a29f9d1">RDKit::streamWrite</a>(ss, endianId);</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <a class="code" href="namespaceRDKit.html#ae03a38eb30281348650ad88b4a29f9d1">RDKit::streamWrite</a>(ss, versionMajor);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <a class="code" href="namespaceRDKit.html#ae03a38eb30281348650ad88b4a29f9d1">RDKit::streamWrite</a>(ss, versionMinor);</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <a class="code" href="namespaceRDKit.html#ae03a38eb30281348650ad88b4a29f9d1">RDKit::streamWrite</a>(ss, versionPatch);</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="comment">// information about the catalog itself:</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordtype">int</span> tmpUInt;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    tmpUInt = this-&gt;<a class="code" href="classRDCatalog_1_1Catalog.html#a3c3947d2cc254fef9791ba99fb04e00b">getFPLength</a>();</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <a class="code" href="namespaceRDKit.html#ae03a38eb30281348650ad88b4a29f9d1">RDKit::streamWrite</a>(ss, tmpUInt);</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    tmpUInt = this-&gt;<a class="code" href="classRDCatalog_1_1Catalog.html#a87425c9095c3c14266f21e9e033bbb1a">getNumEntries</a>();</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <a class="code" href="namespaceRDKit.html#ae03a38eb30281348650ad88b4a29f9d1">RDKit::streamWrite</a>(ss, tmpUInt);</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="comment">// std::cout &lt;&lt; &quot;&gt;&gt;&gt;&gt;-------------------------------&quot; &lt;&lt; std::endl;</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="comment">// std::cout &lt;&lt; &quot;\tlength: &quot; &lt;&lt; getFPLength() &lt;&lt; &quot; &quot; &lt;&lt; getNumEntries() &lt;&lt;</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="comment">// std::endl;</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="comment">// add the params object:</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    this-&gt;<a class="code" href="classRDCatalog_1_1Catalog.html#aa469a6ca9706b34f1a07f17ae1d45a8b">getCatalogParams</a>()-&gt;toStream(ss);</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="comment">// std::cout &lt;&lt; &quot;\tparams: &quot; &lt;&lt; getCatalogParams()-&gt;getLowerFragLength();</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="comment">// std::cout &lt;&lt; &quot; &quot; &lt;&lt; getCatalogParams()-&gt;getUpperFragLength();</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="comment">// std::cout &lt;&lt; &quot; &quot; &lt;&lt; getCatalogParams()-&gt;getNumFuncGroups();</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="comment">// std::cout &lt;&lt; std::endl;</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="comment">// write the entries in order:</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classRDCatalog_1_1Catalog.html#a87425c9095c3c14266f21e9e033bbb1a">getNumEntries</a>(); i++) {</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      this-&gt;<a class="code" href="classRDCatalog_1_1Catalog.html#a19d94805a1b0e9bc565fcaab09b5fec4">getEntryWithIdx</a>(i)-&gt;toStream(ss);</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    }</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="comment">// finally the adjacency list:</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classRDCatalog_1_1Catalog.html#a87425c9095c3c14266f21e9e033bbb1a">getNumEntries</a>(); i++) {</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      <a class="code" href="namespaceRDKit.html#a1d1aa140f55ea44f46af9ff22bfcaf8d">RDKit::INT_VECT</a> children = this-&gt;getDownEntryList(i);</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      tmpUInt = <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span><span class="keyword">&gt;</span>(children.size());</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      <a class="code" href="namespaceRDKit.html#ae03a38eb30281348650ad88b4a29f9d1">RDKit::streamWrite</a>(ss, tmpUInt);</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      <span class="keywordflow">for</span> (RDKit::INT_VECT::const_iterator ivci = children.begin();</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;           ivci != children.end(); ivci++) {</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <a class="code" href="namespaceRDKit.html#ae03a38eb30281348650ad88b4a29f9d1">RDKit::streamWrite</a>(ss, *ivci);</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      }</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    }</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  }</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <span class="comment">//------------------------------------</span><span class="comment"></span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">  //! serializes this object and returns the resulting \c pickle</span></div><div class="line"><a name="l00226"></a><span class="lineno"><a class="line" href="classRDCatalog_1_1HierarchCatalog.html#a72173404e2aa65f2c927f75ea2d2d157">  226</a></span>&#160;<span class="comment"></span>  std::string <a class="code" href="classRDCatalog_1_1HierarchCatalog.html#a72173404e2aa65f2c927f75ea2d2d157">Serialize</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    std::stringstream ss(std::ios_base::binary | std::ios_base::out |</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                         std::ios_base::in);</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    this-&gt;<a class="code" href="namespaceRDLog.html#abf23166b30ebfbb5ed4de1be67122963">toStream</a>(ss);</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="keywordflow">return</span> ss.str();</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  }</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="comment">//------------------------------------</span><span class="comment"></span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">  //! fills the contents of this object from a stream containing a \c pickle</span></div><div class="line"><a name="l00235"></a><span class="lineno"><a class="line" href="classRDCatalog_1_1HierarchCatalog.html#a84fd4a9eb686be240349ba9c9e45273b">  235</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classRDCatalog_1_1HierarchCatalog.html#a84fd4a9eb686be240349ba9c9e45273b">initFromStream</a>(std::istream &amp;ss) {</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordtype">int</span> tmpInt;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="comment">// FIX: at the moment we ignore the header info:</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <a class="code" href="namespaceRDKit.html#a70ac943a46f2915ec70072b6ac0be473">RDKit::streamRead</a>(ss, tmpInt);</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <a class="code" href="namespaceRDKit.html#a70ac943a46f2915ec70072b6ac0be473">RDKit::streamRead</a>(ss, tmpInt);</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <a class="code" href="namespaceRDKit.html#a70ac943a46f2915ec70072b6ac0be473">RDKit::streamRead</a>(ss, tmpInt);</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <a class="code" href="namespaceRDKit.html#a70ac943a46f2915ec70072b6ac0be473">RDKit::streamRead</a>(ss, tmpInt);</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmpUInt;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <a class="code" href="namespaceRDKit.html#a70ac943a46f2915ec70072b6ac0be473">RDKit::streamRead</a>(ss, tmpUInt);  <span class="comment">// fp length</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    this-&gt;<a class="code" href="classRDCatalog_1_1Catalog.html#ae20801408f3e87ee2993c1ba43f5cb90">setFPLength</a>(tmpUInt);</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> numEntries;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <a class="code" href="namespaceRDKit.html#a70ac943a46f2915ec70072b6ac0be473">RDKit::streamRead</a>(ss, numEntries);</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="comment">// std::cout &lt;&lt; &quot;&lt;&lt;&lt;-------------------------------&quot; &lt;&lt; std::endl;</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="comment">// std::cout &lt;&lt; &quot;\tlength: &quot; &lt;&lt; getFPLength() &lt;&lt; &quot; &quot; &lt;&lt; numEntries &lt;&lt;</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="comment">// std::endl;</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="comment">// grab the params:</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    paramType *params = <span class="keyword">new</span> paramType();</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    params-&gt;initFromStream(ss);</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    this-&gt;<a class="code" href="classRDCatalog_1_1Catalog.html#aae0faa196e834e6561e2a2724fc9c19a">setCatalogParams</a>(params);</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="comment">// std::cout &lt;&lt; &quot;\tparams: &quot; &lt;&lt; getCatalogParams()-&gt;getLowerFragLength();</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="comment">// std::cout &lt;&lt; &quot; &quot; &lt;&lt; getCatalogParams()-&gt;getUpperFragLength();</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="comment">// std::cout &lt;&lt; &quot; &quot; &lt;&lt; getCatalogParams()-&gt;getNumFuncGroups();</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="comment">// std::cout &lt;&lt; std::endl;</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="comment">// now all of the entries:</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; numEntries; i++) {</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      entryType *entry = <span class="keyword">new</span> entryType();</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      entry-&gt;initFromStream(ss);</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      this-&gt;<a class="code" href="classRDCatalog_1_1Catalog.html#a0807840de7e8b4f4a298e3d30576d7c5">addEntry</a>(entry, <span class="keyword">false</span>);</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    }</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="comment">// and, finally, the adjacency list:</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; numEntries; i++) {</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nNeighbors;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      <a class="code" href="namespaceRDKit.html#a70ac943a46f2915ec70072b6ac0be473">RDKit::streamRead</a>(ss, nNeighbors);</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; nNeighbors; j++) {</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        <a class="code" href="namespaceRDKit.html#a70ac943a46f2915ec70072b6ac0be473">RDKit::streamRead</a>(ss, tmpInt);</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        this-&gt;addEdge(i, tmpInt);</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      }</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    }</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  }</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <span class="comment">//------------------------------------</span></div><div class="line"><a name="l00282"></a><span class="lineno"><a class="line" href="classRDCatalog_1_1HierarchCatalog.html#a83abfa32279f67857c75a8a7a05e9319">  282</a></span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classRDCatalog_1_1HierarchCatalog.html#a83abfa32279f67857c75a8a7a05e9319">getNumEntries</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span><span class="keyword">&gt;</span>(boost::num_vertices(d_graph)); }</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <span class="comment">//------------------------------------</span><span class="comment"></span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">  //! fills the contents of this object from a string containing a \c pickle</span></div><div class="line"><a name="l00286"></a><span class="lineno"><a class="line" href="classRDCatalog_1_1HierarchCatalog.html#ab4e6b23b59d95205f82735009e0d44ee">  286</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classRDCatalog_1_1HierarchCatalog.html#ab4e6b23b59d95205f82735009e0d44ee">initFromString</a>(<span class="keyword">const</span> std::string &amp;text) {</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    std::stringstream ss(std::ios_base::binary | std::ios_base::out |</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                         std::ios_base::in);</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="comment">// initialize the stream:</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    ss.write(text.c_str(), text.length());</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="comment">// now start reading out values:</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    this-&gt;initFromStream(ss);</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  }</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <span class="comment">//------------------------------------</span><span class="comment"></span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">  //! add a new entry to the catalog</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment"></span><span class="comment">  /*!</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">    \param entry          the entry to be added</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">    \param updateFPLength (optional) if this is true, our internal</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">    fingerprint length will also be updated.</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00304"></a><span class="lineno"><a class="line" href="classRDCatalog_1_1HierarchCatalog.html#a2bf566008659ca0981121e61fbd4ea88">  304</a></span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classRDCatalog_1_1HierarchCatalog.html#a2bf566008659ca0981121e61fbd4ea88">addEntry</a>(entryType *entry, <span class="keywordtype">bool</span> updateFPLength = <span class="keyword">true</span>) {</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <a class="code" href="Invariant_8h.html#a8508523356cb237df34d08a9fcba9ec5">PRECONDITION</a>(entry, <span class="stringliteral">&quot;bad arguments&quot;</span>);</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keywordflow">if</span> (updateFPLength) {</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> fpl = this-&gt;<a class="code" href="classRDCatalog_1_1Catalog.html#a3c3947d2cc254fef9791ba99fb04e00b">getFPLength</a>();</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      entry-&gt;setBitId(fpl);</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      fpl++;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      this-&gt;<a class="code" href="classRDCatalog_1_1Catalog.html#ae20801408f3e87ee2993c1ba43f5cb90">setFPLength</a>(fpl);</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    }</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> eid = <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span><span class="keyword">&gt;</span>(boost::add_vertex(EntryProperty(entry), d_graph));</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    orderType etype = entry-&gt;getOrder();</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="comment">// REVIEW: this initialization is not required: the STL map, in</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="comment">// theory, will create a new object when operator[] is called</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="comment">// for a new item</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="keywordflow">if</span> (d_orderMap.find(etype) == d_orderMap.end()) {</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      <a class="code" href="namespaceRDKit.html#a1d1aa140f55ea44f46af9ff22bfcaf8d">RDKit::INT_VECT</a> nets;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      d_orderMap[etype] = nets;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    }</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    d_orderMap[etype].push_back(eid);</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="keywordflow">return</span> eid;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  }</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="comment">//------------------------------------</span><span class="comment"></span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">  //! adds an edge between two entries in the catalog</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment"></span><span class="comment">  /*!</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">    Since we are using a bidirectional graph - the order in</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">    which the ids are supplied here makes a difference</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">    \param id1 index of the edge&#39;s beginning</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">    \param id2 index of the edge&#39;s end</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00335"></a><span class="lineno"><a class="line" href="classRDCatalog_1_1HierarchCatalog.html#add3b428e0161127fc771c4d18fafee0c">  335</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classRDCatalog_1_1HierarchCatalog.html#add3b428e0161127fc771c4d18fafee0c">addEdge</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> id1, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> id2) {</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nents = <a class="code" href="classRDCatalog_1_1Catalog.html#a87425c9095c3c14266f21e9e033bbb1a">getNumEntries</a>();</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <a class="code" href="Invariant_8h.html#a7c39e1a89e9af8a0bb1fda77bcbc26c5">URANGE_CHECK</a>(id1, nents);</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <a class="code" href="Invariant_8h.html#a7c39e1a89e9af8a0bb1fda77bcbc26c5">URANGE_CHECK</a>(id2, nents);</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="comment">// FIX: if we boost::setS for the edgeList BGL will</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="comment">// do the checking for duplicity (parallel edges)</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="comment">// But for reasons unknown setS results in compile</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="comment">// errors while using adjacent_vertices.</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keyword">typename</span> CAT_GRAPH_TRAITS::edge_descriptor edge;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="keywordtype">bool</span> found;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    boost::tie(edge, found) = boost::edge(boost::vertex(id1, d_graph),</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                                          boost::vertex(id2, d_graph), d_graph);</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="keywordflow">if</span> (!found) {</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      boost::add_edge(id1, id2, d_graph);</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    }</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  }</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <span class="comment">//------------------------------------</span><span class="comment"></span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">  //! returns a pointer to our entry with a particular index</span></div><div class="line"><a name="l00354"></a><span class="lineno"><a class="line" href="classRDCatalog_1_1HierarchCatalog.html#a0a776fe5b47f40680ed94a216909fc17">  354</a></span>&#160;<span class="comment"></span>  <span class="keyword">const</span> entryType *<a class="code" href="classRDCatalog_1_1HierarchCatalog.html#a0a776fe5b47f40680ed94a216909fc17">getEntryWithIdx</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> idx)<span class="keyword"> const </span>{</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <a class="code" href="Invariant_8h.html#a7c39e1a89e9af8a0bb1fda77bcbc26c5">URANGE_CHECK</a>(idx, <a class="code" href="classRDCatalog_1_1Catalog.html#a87425c9095c3c14266f21e9e033bbb1a">getNumEntries</a>());</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keywordtype">int</span> vd = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(boost::vertex(idx, d_graph));</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="keyword">typename</span> boost::property_map&lt;CatalogGraph, vertex_entry_t&gt;::const_type</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        pMap = boost::get(<a class="code" href="structRDCatalog_1_1HierarchCatalog_1_1vertex__entry__t.html">vertex_entry_t</a>(), d_graph);</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="keywordflow">return</span> pMap[vd];</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  }</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <span class="comment">//------------------------------------</span><span class="comment"></span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">  //! returns a pointer to our entry with a particular bit ID</span></div><div class="line"><a name="l00364"></a><span class="lineno"><a class="line" href="classRDCatalog_1_1HierarchCatalog.html#a4b1e51f4928e469bcd9660906fa2714d">  364</a></span>&#160;<span class="comment"></span>  <span class="keyword">const</span> entryType *<a class="code" href="classRDCatalog_1_1HierarchCatalog.html#a4b1e51f4928e469bcd9660906fa2714d">getEntryWithBitId</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> idx)<span class="keyword"> const </span>{</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <a class="code" href="Invariant_8h.html#a7c39e1a89e9af8a0bb1fda77bcbc26c5">URANGE_CHECK</a>(idx, this-&gt;<a class="code" href="classRDCatalog_1_1Catalog.html#a3c3947d2cc254fef9791ba99fb04e00b">getFPLength</a>());</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="keyword">typename</span> boost::property_map&lt;CatalogGraph, vertex_entry_t&gt;::const_type</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        pMap = boost::get(<a class="code" href="structRDCatalog_1_1HierarchCatalog_1_1vertex__entry__t.html">vertex_entry_t</a>(), d_graph);</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keyword">const</span> entryType *res = NULL;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = idx; i &lt; this-&gt;<a class="code" href="classRDCatalog_1_1Catalog.html#a87425c9095c3c14266f21e9e033bbb1a">getNumEntries</a>(); i++) {</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      <span class="keyword">const</span> entryType *e = pMap[i];</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      <span class="keywordflow">if</span> (e-&gt;getBitId() == <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(idx)) {</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        res = e;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      }</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    }</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  }</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  <span class="comment">//------------------------------------</span><span class="comment"></span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">  //! returns the index of the entry with a particular bit ID</span></div><div class="line"><a name="l00381"></a><span class="lineno"><a class="line" href="classRDCatalog_1_1HierarchCatalog.html#ad986252485448c67e250c84090fd702a">  381</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">int</span> <a class="code" href="classRDCatalog_1_1HierarchCatalog.html#ad986252485448c67e250c84090fd702a">getIdOfEntryWithBitId</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> idx)<span class="keyword"> const </span>{</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <a class="code" href="Invariant_8h.html#a7c39e1a89e9af8a0bb1fda77bcbc26c5">URANGE_CHECK</a>(idx, this-&gt;<a class="code" href="classRDCatalog_1_1Catalog.html#a3c3947d2cc254fef9791ba99fb04e00b">getFPLength</a>());</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keyword">typename</span> boost::property_map&lt;CatalogGraph, vertex_entry_t&gt;::const_type</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        pMap = boost::get(<a class="code" href="structRDCatalog_1_1HierarchCatalog_1_1vertex__entry__t.html">vertex_entry_t</a>(), d_graph);</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keywordtype">int</span> res = -1;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = idx; i &lt; this-&gt;<a class="code" href="classRDCatalog_1_1Catalog.html#a87425c9095c3c14266f21e9e033bbb1a">getNumEntries</a>(); i++) {</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      <span class="keyword">const</span> entryType *e = pMap[i];</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      <span class="keywordflow">if</span> (static_cast&lt;unsigned int&gt;(e-&gt;getBitId()) == idx) {</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        res = i;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      }</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    }</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  }</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <span class="comment">//------------------------------------</span><span class="comment"></span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment">  //! returns a list of the indices of entries below the one passed in</span></div><div class="line"><a name="l00398"></a><span class="lineno"><a class="line" href="classRDCatalog_1_1HierarchCatalog.html#abf2a09798165a8696e1302da0015215e">  398</a></span>&#160;<span class="comment"></span>  <a class="code" href="namespaceRDKit.html#a1d1aa140f55ea44f46af9ff22bfcaf8d">RDKit::INT_VECT</a> <a class="code" href="classRDCatalog_1_1HierarchCatalog.html#abf2a09798165a8696e1302da0015215e">getDownEntryList</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> idx)<span class="keyword"> const </span>{</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <a class="code" href="namespaceRDKit.html#a1d1aa140f55ea44f46af9ff22bfcaf8d">RDKit::INT_VECT</a> res;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    DOWN_ENT_ITER nbrIdx, endIdx;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    boost::tie(nbrIdx, endIdx) = boost::adjacent_vertices(idx, d_graph);</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="keywordflow">while</span> (nbrIdx != endIdx) {</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;      res.push_back(static_cast&lt;int&gt;(*nbrIdx));</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      nbrIdx++;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    }</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="comment">// std::cout &lt;&lt; res.size() &lt;&lt; &quot;\n&quot;;</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  }</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  <span class="comment">//------------------------------------</span><span class="comment"></span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">  //! returns a list of the indices that have a particular order</span></div><div class="line"><a name="l00412"></a><span class="lineno"><a class="line" href="classRDCatalog_1_1HierarchCatalog.html#ad321a57a9256842fa0d990174c4a0a23">  412</a></span>&#160;<span class="comment"></span>  <span class="keyword">const</span> <a class="code" href="namespaceRDKit.html#a1d1aa140f55ea44f46af9ff22bfcaf8d">RDKit::INT_VECT</a> &amp;<a class="code" href="classRDCatalog_1_1HierarchCatalog.html#ad321a57a9256842fa0d990174c4a0a23">getEntriesOfOrder</a>(orderType ord) {</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keywordflow">return</span> d_orderMap[ord];</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  }</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <span class="comment">//------------------------------------</span><span class="comment"></span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">  //! returns a list of the indices that have a particular order</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment"></span><span class="comment">  /*!</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment">    \overload</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00421"></a><span class="lineno"><a class="line" href="classRDCatalog_1_1HierarchCatalog.html#a580e9bb279cfdd62ba74f9e627d8c2b4">  421</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="namespaceRDKit.html#a1d1aa140f55ea44f46af9ff22bfcaf8d">RDKit::INT_VECT</a> &amp;<a class="code" href="classRDCatalog_1_1HierarchCatalog.html#a580e9bb279cfdd62ba74f9e627d8c2b4">getEntriesOfOrder</a>(orderType ord)<span class="keyword"> const </span>{</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="keyword">typename</span> std::map&lt;orderType, RDKit::INT_VECT&gt;::const_iterator elem;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    elem = d_orderMap.find(ord);</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <a class="code" href="Invariant_8h.html#a48af30912cdae8cf6efe6b71c9c5a9b0">CHECK_INVARIANT</a>(</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        elem != d_orderMap.end(),</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        <span class="stringliteral">&quot; catalog does not contain any entries of the order specified&quot;</span>);</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="keywordflow">return</span> elem-&gt;second;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  }</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160; <span class="keyword">private</span>:</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  <span class="comment">// graphs that store the entries in the catalog in a hierachical manner</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  CatalogGraph d_graph;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  <span class="comment">// a  map that maps the order type of entries in the catalog to</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  <span class="comment">// a vector of vertex indices in the graphs above</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  <span class="comment">// e.g.  for a catalog with molecular fragments, the order of a fragment can</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  <span class="comment">// simply be the number of bond in it. The list this oder maps to is all the</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  <span class="comment">// vertex ids of these fragment in the catalog that have this many bonds in</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  <span class="comment">// them</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  std::map&lt;orderType, RDKit::INT_VECT&gt; d_orderMap;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <span class="comment">//------------------------------------</span><span class="comment"></span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">  //! clear any memory that we&#39;ve used</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> destroy() {</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    ENT_ITER_PAIR entItP = boost::vertices(d_graph);</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="keyword">typename</span> boost::property_map&lt;CatalogGraph, vertex_entry_t&gt;::type pMap =</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        boost::get(<a class="code" href="structRDCatalog_1_1HierarchCatalog_1_1vertex__entry__t.html">vertex_entry_t</a>(), d_graph);</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="keywordflow">while</span> (entItP.first != entItP.second) {</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;      <span class="keyword">delete</span> pMap[*(entItP.first++)];</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    }</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  }</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;};</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">//-----------------------------------------------------------------------------</span><span class="comment"></span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">//! a linear Catalog (analogous to an std::vector)</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment"></span><span class="comment">/*!</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">  Here there is no particular hierarchy, simply a</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment">  collection of entries.</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> entryType, <span class="keyword">class</span> orderType&gt;</div><div class="line"><a name="l00460"></a><span class="lineno"><a class="line" href="classRDCatalog_1_1LinearCatalog.html">  460</a></span>&#160;<span class="keyword">class </span><a class="code" href="classRDCatalog_1_1LinearCatalog.html">LinearCatalog</a> : <span class="keyword">public</span> <a class="code" href="classRDCatalog_1_1Catalog.html">Catalog</a>&lt;entryType, orderType&gt; {</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  <span class="comment">// here there is no particular hierarchy of entries</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  <span class="comment">// we simply model it as a vector of entries</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  <span class="comment">// FIX: for retrieval purposes a better model map be std::map</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  std::string <a class="code" href="classRDCatalog_1_1Catalog.html#a065fd05bc4c0d272424a07d793a97e15">Serialize</a>();</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classRDCatalog_1_1Catalog.html#a0807840de7e8b4f4a298e3d30576d7c5">addEntry</a>(entryType *entry, <span class="keywordtype">bool</span> updateFPLength = <span class="keyword">true</span>);</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  <span class="keyword">const</span> entryType *<a class="code" href="classRDCatalog_1_1Catalog.html#a19d94805a1b0e9bc565fcaab09b5fec4">getEntryWithIdx</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> idx) <span class="keyword">const</span>;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160; <span class="keyword">private</span>:</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  std::vector&lt;entryType *&gt; d_vector;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;};</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;}</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="preprocessor">#endif</span></div><div class="ttc" id="classRDCatalog_1_1Catalog_html_a19d94805a1b0e9bc565fcaab09b5fec4"><div class="ttname"><a href="classRDCatalog_1_1Catalog.html#a19d94805a1b0e9bc565fcaab09b5fec4">RDCatalog::Catalog::getEntryWithIdx</a></div><div class="ttdeci">virtual const entryType * getEntryWithIdx(unsigned int idx) const =0</div><div class="ttdoc">returns a particular entry in the Catalog </div></div>
<div class="ttc" id="namespaceRDCatalog_html_a3437dcfc90c18c2ae6e11a9cf4a1c2da"><div class="ttname"><a href="namespaceRDCatalog.html#a3437dcfc90c18c2ae6e11a9cf4a1c2da">RDCatalog::versionMinor</a></div><div class="ttdeci">const int versionMinor</div><div class="ttdef"><b>Definition:</b> <a href="Catalog_8h_source.html#l00032">Catalog.h:32</a></div></div>
<div class="ttc" id="classRDCatalog_1_1HierarchCatalog_html_ab4e6b23b59d95205f82735009e0d44ee"><div class="ttname"><a href="classRDCatalog_1_1HierarchCatalog.html#ab4e6b23b59d95205f82735009e0d44ee">RDCatalog::HierarchCatalog::initFromString</a></div><div class="ttdeci">void initFromString(const std::string &amp;text)</div><div class="ttdoc">fills the contents of this object from a string containing a pickle </div><div class="ttdef"><b>Definition:</b> <a href="Catalog_8h_source.html#l00286">Catalog.h:286</a></div></div>
<div class="ttc" id="classRDCatalog_1_1HierarchCatalog_html_a368a0ffe44a9d08a0721c0d46bf67a64"><div class="ttname"><a href="classRDCatalog_1_1HierarchCatalog.html#a368a0ffe44a9d08a0721c0d46bf67a64">RDCatalog::HierarchCatalog::DOWN_ENT_ITER</a></div><div class="ttdeci">CAT_GRAPH_TRAITS::adjacency_iterator DOWN_ENT_ITER</div><div class="ttdef"><b>Definition:</b> <a href="Catalog_8h_source.html#l00156">Catalog.h:156</a></div></div>
<div class="ttc" id="types_8h_html"><div class="ttname"><a href="types_8h.html">types.h</a></div></div>
<div class="ttc" id="structRDCatalog_1_1HierarchCatalog_1_1vertex__entry__t_html"><div class="ttname"><a href="structRDCatalog_1_1HierarchCatalog_1_1vertex__entry__t.html">RDCatalog::HierarchCatalog::vertex_entry_t</a></div><div class="ttdoc">used by the BGL to set up the node properties in our graph </div><div class="ttdef"><b>Definition:</b> <a href="Catalog_8h_source.html#l00139">Catalog.h:139</a></div></div>
<div class="ttc" id="BoostStartInclude_8h_html"><div class="ttname"><a href="BoostStartInclude_8h.html">BoostStartInclude.h</a></div></div>
<div class="ttc" id="classRDCatalog_1_1Catalog_html_ae53f636049a2abfe83061e06596b040a"><div class="ttname"><a href="classRDCatalog_1_1Catalog.html#ae53f636049a2abfe83061e06596b040a">RDCatalog::Catalog::paramType_t</a></div><div class="ttdeci">paramType paramType_t</div><div class="ttdef"><b>Definition:</b> <a href="Catalog_8h_source.html#l00042">Catalog.h:42</a></div></div>
<div class="ttc" id="classRDCatalog_1_1Catalog_html_a3c3947d2cc254fef9791ba99fb04e00b"><div class="ttname"><a href="classRDCatalog_1_1Catalog.html#a3c3947d2cc254fef9791ba99fb04e00b">RDCatalog::Catalog::getFPLength</a></div><div class="ttdeci">unsigned int getFPLength() const </div><div class="ttdoc">returns the length of our fingerprint </div><div class="ttdef"><b>Definition:</b> <a href="Catalog_8h_source.html#l00076">Catalog.h:76</a></div></div>
<div class="ttc" id="classRDCatalog_1_1HierarchCatalog_html_ad986252485448c67e250c84090fd702a"><div class="ttname"><a href="classRDCatalog_1_1HierarchCatalog.html#ad986252485448c67e250c84090fd702a">RDCatalog::HierarchCatalog::getIdOfEntryWithBitId</a></div><div class="ttdeci">int getIdOfEntryWithBitId(unsigned int idx) const </div><div class="ttdoc">returns the index of the entry with a particular bit ID </div><div class="ttdef"><b>Definition:</b> <a href="Catalog_8h_source.html#l00381">Catalog.h:381</a></div></div>
<div class="ttc" id="classRDCatalog_1_1Catalog_html_a065fd05bc4c0d272424a07d793a97e15"><div class="ttname"><a href="classRDCatalog_1_1Catalog.html#a065fd05bc4c0d272424a07d793a97e15">RDCatalog::Catalog::Serialize</a></div><div class="ttdeci">virtual std::string Serialize() const =0</div><div class="ttdoc">return a serialized form of the Catalog as an std::string </div></div>
<div class="ttc" id="Invariant_8h_html_a48af30912cdae8cf6efe6b71c9c5a9b0"><div class="ttname"><a href="Invariant_8h.html#a48af30912cdae8cf6efe6b71c9c5a9b0">CHECK_INVARIANT</a></div><div class="ttdeci">#define CHECK_INVARIANT(expr, mess)</div><div class="ttdef"><b>Definition:</b> <a href="Invariant_8h_source.html#l00099">Invariant.h:99</a></div></div>
<div class="ttc" id="structRDCatalog_1_1HierarchCatalog_1_1vertex__entry__t_html_a48afd5f52629363a3ea7df8fca7b4544"><div class="ttname"><a href="structRDCatalog_1_1HierarchCatalog_1_1vertex__entry__t.html#a48afd5f52629363a3ea7df8fca7b4544">RDCatalog::HierarchCatalog::vertex_entry_t::kind</a></div><div class="ttdeci">boost::vertex_property_tag kind</div><div class="ttdef"><b>Definition:</b> <a href="Catalog_8h_source.html#l00141">Catalog.h:141</a></div></div>
<div class="ttc" id="namespaceRDCatalog_html"><div class="ttname"><a href="namespaceRDCatalog.html">RDCatalog</a></div><div class="ttdef"><b>Definition:</b> <a href="Catalog_8h_source.html#l00030">Catalog.h:30</a></div></div>
<div class="ttc" id="classRDCatalog_1_1Catalog_html_aae0faa196e834e6561e2a2724fc9c19a"><div class="ttname"><a href="classRDCatalog_1_1Catalog.html#aae0faa196e834e6561e2a2724fc9c19a">RDCatalog::Catalog::setCatalogParams</a></div><div class="ttdeci">virtual void setCatalogParams(paramType *params)</div><div class="ttdoc">sets our parameters by copying the params argument </div><div class="ttdef"><b>Definition:</b> <a href="Catalog_8h_source.html#l00084">Catalog.h:84</a></div></div>
<div class="ttc" id="classRDCatalog_1_1Catalog_html_a0807840de7e8b4f4a298e3d30576d7c5"><div class="ttname"><a href="classRDCatalog_1_1Catalog.html#a0807840de7e8b4f4a298e3d30576d7c5">RDCatalog::Catalog::addEntry</a></div><div class="ttdeci">virtual unsigned int addEntry(entryType *entry, bool updateFPLength=true)=0</div><div class="ttdoc">adds an entry to the catalog </div></div>
<div class="ttc" id="namespaceRDKit_html_a70ac943a46f2915ec70072b6ac0be473"><div class="ttname"><a href="namespaceRDKit.html#a70ac943a46f2915ec70072b6ac0be473">RDKit::streamRead</a></div><div class="ttdeci">void streamRead(std::istream &amp;ss, T &amp;loc)</div><div class="ttdoc">does a binary read of an object from a stream </div><div class="ttdef"><b>Definition:</b> <a href="StreamOps_8h_source.html#l00243">StreamOps.h:243</a></div></div>
<div class="ttc" id="classRDCatalog_1_1HierarchCatalog_html_a089d81495a21014d7705822e12381218"><div class="ttname"><a href="classRDCatalog_1_1HierarchCatalog.html#a089d81495a21014d7705822e12381218">RDCatalog::HierarchCatalog::CAT_GRAPH_TRAITS</a></div><div class="ttdeci">boost::graph_traits&lt; CatalogGraph &gt; CAT_GRAPH_TRAITS</div><div class="ttdef"><b>Definition:</b> <a href="Catalog_8h_source.html#l00153">Catalog.h:153</a></div></div>
<div class="ttc" id="classRDCatalog_1_1HierarchCatalog_html_a83abfa32279f67857c75a8a7a05e9319"><div class="ttname"><a href="classRDCatalog_1_1HierarchCatalog.html#a83abfa32279f67857c75a8a7a05e9319">RDCatalog::HierarchCatalog::getNumEntries</a></div><div class="ttdeci">unsigned int getNumEntries() const </div><div class="ttdoc">returns the number of entries </div><div class="ttdef"><b>Definition:</b> <a href="Catalog_8h_source.html#l00282">Catalog.h:282</a></div></div>
<div class="ttc" id="namespaceRDCatalog_html_a2f96f9f0ed5f13ba820a8c1b17e41b45"><div class="ttname"><a href="namespaceRDCatalog.html#a2f96f9f0ed5f13ba820a8c1b17e41b45">RDCatalog::endianId</a></div><div class="ttdeci">const int endianId</div><div class="ttdef"><b>Definition:</b> <a href="Catalog_8h_source.html#l00034">Catalog.h:34</a></div></div>
<div class="ttc" id="classRDCatalog_1_1Catalog_html_a87425c9095c3c14266f21e9e033bbb1a"><div class="ttname"><a href="classRDCatalog_1_1Catalog.html#a87425c9095c3c14266f21e9e033bbb1a">RDCatalog::Catalog::getNumEntries</a></div><div class="ttdeci">virtual unsigned int getNumEntries() const =0</div><div class="ttdoc">returns the number of entries </div></div>
<div class="ttc" id="classRDCatalog_1_1HierarchCatalog_html_ac1593a7b8757c9a6175e9f9a16dfab50"><div class="ttname"><a href="classRDCatalog_1_1HierarchCatalog.html#ac1593a7b8757c9a6175e9f9a16dfab50">RDCatalog::HierarchCatalog::DOWN_ENT_ITER_PAIR</a></div><div class="ttdeci">std::pair&lt; DOWN_ENT_ITER, DOWN_ENT_ITER &gt; DOWN_ENT_ITER_PAIR</div><div class="ttdef"><b>Definition:</b> <a href="Catalog_8h_source.html#l00157">Catalog.h:157</a></div></div>
<div class="ttc" id="classRDCatalog_1_1LinearCatalog_html"><div class="ttname"><a href="classRDCatalog_1_1LinearCatalog.html">RDCatalog::LinearCatalog</a></div><div class="ttdoc">a linear Catalog (analogous to an std::vector) </div><div class="ttdef"><b>Definition:</b> <a href="Catalog_8h_source.html#l00460">Catalog.h:460</a></div></div>
<div class="ttc" id="classRDCatalog_1_1HierarchCatalog_html"><div class="ttname"><a href="classRDCatalog_1_1HierarchCatalog.html">RDCatalog::HierarchCatalog</a></div><div class="ttdoc">A Catalog with a hierarchical structure. </div><div class="ttdef"><b>Definition:</b> <a href="Catalog_8h_source.html#l00134">Catalog.h:134</a></div></div>
<div class="ttc" id="classRDCatalog_1_1HierarchCatalog_html_a976ad400d1bb1c2919a193b87e0dc362"><div class="ttname"><a href="classRDCatalog_1_1HierarchCatalog.html#a976ad400d1bb1c2919a193b87e0dc362">RDCatalog::HierarchCatalog::ENT_ITER_PAIR</a></div><div class="ttdeci">std::pair&lt; VER_ITER, VER_ITER &gt; ENT_ITER_PAIR</div><div class="ttdef"><b>Definition:</b> <a href="Catalog_8h_source.html#l00155">Catalog.h:155</a></div></div>
<div class="ttc" id="classRDCatalog_1_1HierarchCatalog_html_a84fd4a9eb686be240349ba9c9e45273b"><div class="ttname"><a href="classRDCatalog_1_1HierarchCatalog.html#a84fd4a9eb686be240349ba9c9e45273b">RDCatalog::HierarchCatalog::initFromStream</a></div><div class="ttdeci">void initFromStream(std::istream &amp;ss)</div><div class="ttdoc">fills the contents of this object from a stream containing a pickle </div><div class="ttdef"><b>Definition:</b> <a href="Catalog_8h_source.html#l00235">Catalog.h:235</a></div></div>
<div class="ttc" id="BoostEndInclude_8h_html"><div class="ttname"><a href="BoostEndInclude_8h.html">BoostEndInclude.h</a></div></div>
<div class="ttc" id="classRDCatalog_1_1HierarchCatalog_html_a0a776fe5b47f40680ed94a216909fc17"><div class="ttname"><a href="classRDCatalog_1_1HierarchCatalog.html#a0a776fe5b47f40680ed94a216909fc17">RDCatalog::HierarchCatalog::getEntryWithIdx</a></div><div class="ttdeci">const entryType * getEntryWithIdx(unsigned int idx) const </div><div class="ttdoc">returns a pointer to our entry with a particular index </div><div class="ttdef"><b>Definition:</b> <a href="Catalog_8h_source.html#l00354">Catalog.h:354</a></div></div>
<div class="ttc" id="classRDCatalog_1_1Catalog_html"><div class="ttname"><a href="classRDCatalog_1_1Catalog.html">RDCatalog::Catalog</a></div><div class="ttdoc">abstract base class for a catalog object </div><div class="ttdef"><b>Definition:</b> <a href="Catalog_8h_source.html#l00039">Catalog.h:39</a></div></div>
<div class="ttc" id="classRDCatalog_1_1HierarchCatalog_html_afb66201eea33105fa71af2e66ecc5d38"><div class="ttname"><a href="classRDCatalog_1_1HierarchCatalog.html#afb66201eea33105fa71af2e66ecc5d38">RDCatalog::HierarchCatalog::toStream</a></div><div class="ttdeci">void toStream(std::ostream &amp;ss) const </div><div class="ttdoc">serializes this object to a stream </div><div class="ttdef"><b>Definition:</b> <a href="Catalog_8h_source.html#l00180">Catalog.h:180</a></div></div>
<div class="ttc" id="classRDCatalog_1_1Catalog_html_aa469a6ca9706b34f1a07f17ae1d45a8b"><div class="ttname"><a href="classRDCatalog_1_1Catalog.html#aa469a6ca9706b34f1a07f17ae1d45a8b">RDCatalog::Catalog::getCatalogParams</a></div><div class="ttdeci">const paramType * getCatalogParams() const </div><div class="ttdoc">returns a pointer to our parameters </div><div class="ttdef"><b>Definition:</b> <a href="Catalog_8h_source.html#l00100">Catalog.h:100</a></div></div>
<div class="ttc" id="classRDCatalog_1_1HierarchCatalog_html_a72173404e2aa65f2c927f75ea2d2d157"><div class="ttname"><a href="classRDCatalog_1_1HierarchCatalog.html#a72173404e2aa65f2c927f75ea2d2d157">RDCatalog::HierarchCatalog::Serialize</a></div><div class="ttdeci">std::string Serialize() const </div><div class="ttdoc">serializes this object and returns the resulting pickle </div><div class="ttdef"><b>Definition:</b> <a href="Catalog_8h_source.html#l00226">Catalog.h:226</a></div></div>
<div class="ttc" id="classRDCatalog_1_1Catalog_html_abd1479db0176fbe70ea4be82786b36b6"><div class="ttname"><a href="classRDCatalog_1_1Catalog.html#abd1479db0176fbe70ea4be82786b36b6">RDCatalog::Catalog::Catalog</a></div><div class="ttdeci">Catalog()</div><div class="ttdef"><b>Definition:</b> <a href="Catalog_8h_source.html#l00045">Catalog.h:45</a></div></div>
<div class="ttc" id="namespaceRDKit_html_a1d1aa140f55ea44f46af9ff22bfcaf8d"><div class="ttname"><a href="namespaceRDKit.html#a1d1aa140f55ea44f46af9ff22bfcaf8d">RDKit::INT_VECT</a></div><div class="ttdeci">std::vector&lt; int &gt; INT_VECT</div><div class="ttdef"><b>Definition:</b> <a href="types_8h_source.html#l00191">types.h:191</a></div></div>
<div class="ttc" id="classRDCatalog_1_1HierarchCatalog_html_a3259eac3ceff5c12a103e8895214b06b"><div class="ttname"><a href="classRDCatalog_1_1HierarchCatalog.html#a3259eac3ceff5c12a103e8895214b06b">RDCatalog::HierarchCatalog::VER_ITER</a></div><div class="ttdeci">CAT_GRAPH_TRAITS::vertex_iterator VER_ITER</div><div class="ttdef"><b>Definition:</b> <a href="Catalog_8h_source.html#l00154">Catalog.h:154</a></div></div>
<div class="ttc" id="classRDCatalog_1_1Catalog_html_a9eb2ad9bb8ad739f3673901af6d3c48e"><div class="ttname"><a href="classRDCatalog_1_1Catalog.html#a9eb2ad9bb8ad739f3673901af6d3c48e">RDCatalog::Catalog::~Catalog</a></div><div class="ttdeci">virtual ~Catalog()</div><div class="ttdef"><b>Definition:</b> <a href="Catalog_8h_source.html#l00048">Catalog.h:48</a></div></div>
<div class="ttc" id="namespaceRDCatalog_html_a955c419c8f44f391f84b3d570831a031"><div class="ttname"><a href="namespaceRDCatalog.html#a955c419c8f44f391f84b3d570831a031">RDCatalog::versionPatch</a></div><div class="ttdeci">const int versionPatch</div><div class="ttdef"><b>Definition:</b> <a href="Catalog_8h_source.html#l00033">Catalog.h:33</a></div></div>
<div class="ttc" id="classRDCatalog_1_1HierarchCatalog_html_ab67ded8a194ce44b8a9475df43499b5f"><div class="ttname"><a href="classRDCatalog_1_1HierarchCatalog.html#ab67ded8a194ce44b8a9475df43499b5f">RDCatalog::HierarchCatalog::EntryProperty</a></div><div class="ttdeci">boost::property&lt; vertex_entry_t, entryType * &gt; EntryProperty</div><div class="ttdef"><b>Definition:</b> <a href="Catalog_8h_source.html#l00143">Catalog.h:143</a></div></div>
<div class="ttc" id="classRDCatalog_1_1HierarchCatalog_html_a4b1e51f4928e469bcd9660906fa2714d"><div class="ttname"><a href="classRDCatalog_1_1HierarchCatalog.html#a4b1e51f4928e469bcd9660906fa2714d">RDCatalog::HierarchCatalog::getEntryWithBitId</a></div><div class="ttdeci">const entryType * getEntryWithBitId(unsigned int idx) const </div><div class="ttdoc">returns a pointer to our entry with a particular bit ID </div><div class="ttdef"><b>Definition:</b> <a href="Catalog_8h_source.html#l00364">Catalog.h:364</a></div></div>
<div class="ttc" id="Invariant_8h_html_a7c39e1a89e9af8a0bb1fda77bcbc26c5"><div class="ttname"><a href="Invariant_8h.html#a7c39e1a89e9af8a0bb1fda77bcbc26c5">URANGE_CHECK</a></div><div class="ttdeci">#define URANGE_CHECK(x, hi)</div><div class="ttdef"><b>Definition:</b> <a href="Invariant_8h_source.html#l00140">Invariant.h:140</a></div></div>
<div class="ttc" id="classRDCatalog_1_1HierarchCatalog_html_a87d59c32d2c18885a0b456fe7cfd7057"><div class="ttname"><a href="classRDCatalog_1_1HierarchCatalog.html#a87d59c32d2c18885a0b456fe7cfd7057">RDCatalog::HierarchCatalog::CatalogGraph</a></div><div class="ttdeci">boost::adjacency_list&lt; boost::vecS, boost::vecS, boost::bidirectionalS, EntryProperty &gt; CatalogGraph</div><div class="ttdoc">the type of the graph itself: </div><div class="ttdef"><b>Definition:</b> <a href="Catalog_8h_source.html#l00151">Catalog.h:151</a></div></div>
<div class="ttc" id="namespaceRDCatalog_html_a7c4ea39e05b3a9041523cdc7f54d0de9"><div class="ttname"><a href="namespaceRDCatalog.html#a7c4ea39e05b3a9041523cdc7f54d0de9">RDCatalog::versionMajor</a></div><div class="ttdeci">const int versionMajor</div><div class="ttdef"><b>Definition:</b> <a href="Catalog_8h_source.html#l00031">Catalog.h:31</a></div></div>
<div class="ttc" id="namespaceRDKit_html_ae03a38eb30281348650ad88b4a29f9d1"><div class="ttname"><a href="namespaceRDKit.html#ae03a38eb30281348650ad88b4a29f9d1">RDKit::streamWrite</a></div><div class="ttdeci">void streamWrite(std::ostream &amp;ss, const T &amp;val)</div><div class="ttdoc">does a binary write of an object to a stream </div><div class="ttdef"><b>Definition:</b> <a href="StreamOps_8h_source.html#l00222">StreamOps.h:222</a></div></div>
<div class="ttc" id="Invariant_8h_html_a8508523356cb237df34d08a9fcba9ec5"><div class="ttname"><a href="Invariant_8h.html#a8508523356cb237df34d08a9fcba9ec5">PRECONDITION</a></div><div class="ttdeci">#define PRECONDITION(expr, mess)</div><div class="ttdef"><b>Definition:</b> <a href="Invariant_8h_source.html#l00107">Invariant.h:107</a></div></div>
<div class="ttc" id="classRDCatalog_1_1Catalog_html_aca46b909f065692080fbdf3593e5dc2d"><div class="ttname"><a href="classRDCatalog_1_1Catalog.html#aca46b909f065692080fbdf3593e5dc2d">RDCatalog::Catalog::d_fpLength</a></div><div class="ttdeci">unsigned int d_fpLength</div><div class="ttdoc">the length of our fingerprint </div><div class="ttdef"><b>Definition:</b> <a href="Catalog_8h_source.html#l00108">Catalog.h:108</a></div></div>
<div class="ttc" id="classRDCatalog_1_1Catalog_html_aa4e97ddc394fa23da4466784d84da290"><div class="ttname"><a href="classRDCatalog_1_1Catalog.html#aa4e97ddc394fa23da4466784d84da290">RDCatalog::Catalog::dp_cParams</a></div><div class="ttdeci">paramType * dp_cParams</div><div class="ttdoc">our params object </div><div class="ttdef"><b>Definition:</b> <a href="Catalog_8h_source.html#l00109">Catalog.h:109</a></div></div>
<div class="ttc" id="StreamOps_8h_html"><div class="ttname"><a href="StreamOps_8h.html">StreamOps.h</a></div></div>
<div class="ttc" id="classRDCatalog_1_1HierarchCatalog_html_ad321a57a9256842fa0d990174c4a0a23"><div class="ttname"><a href="classRDCatalog_1_1HierarchCatalog.html#ad321a57a9256842fa0d990174c4a0a23">RDCatalog::HierarchCatalog::getEntriesOfOrder</a></div><div class="ttdeci">const RDKit::INT_VECT &amp; getEntriesOfOrder(orderType ord)</div><div class="ttdoc">returns a list of the indices that have a particular order </div><div class="ttdef"><b>Definition:</b> <a href="Catalog_8h_source.html#l00412">Catalog.h:412</a></div></div>
<div class="ttc" id="namespaceRDLog_html_abf23166b30ebfbb5ed4de1be67122963"><div class="ttname"><a href="namespaceRDLog.html#abf23166b30ebfbb5ed4de1be67122963">RDLog::toStream</a></div><div class="ttdeci">std::ostream &amp; toStream(std::ostream &amp;)</div></div>
<div class="ttc" id="classRDCatalog_1_1HierarchCatalog_html_add3b428e0161127fc771c4d18fafee0c"><div class="ttname"><a href="classRDCatalog_1_1HierarchCatalog.html#add3b428e0161127fc771c4d18fafee0c">RDCatalog::HierarchCatalog::addEdge</a></div><div class="ttdeci">void addEdge(unsigned int id1, unsigned int id2)</div><div class="ttdoc">adds an edge between two entries in the catalog </div><div class="ttdef"><b>Definition:</b> <a href="Catalog_8h_source.html#l00335">Catalog.h:335</a></div></div>
<div class="ttc" id="classRDCatalog_1_1HierarchCatalog_html_a580e9bb279cfdd62ba74f9e627d8c2b4"><div class="ttname"><a href="classRDCatalog_1_1HierarchCatalog.html#a580e9bb279cfdd62ba74f9e627d8c2b4">RDCatalog::HierarchCatalog::getEntriesOfOrder</a></div><div class="ttdeci">const RDKit::INT_VECT &amp; getEntriesOfOrder(orderType ord) const </div><div class="ttdoc">returns a list of the indices that have a particular order </div><div class="ttdef"><b>Definition:</b> <a href="Catalog_8h_source.html#l00421">Catalog.h:421</a></div></div>
<div class="ttc" id="classRDCatalog_1_1HierarchCatalog_html_a2bf566008659ca0981121e61fbd4ea88"><div class="ttname"><a href="classRDCatalog_1_1HierarchCatalog.html#a2bf566008659ca0981121e61fbd4ea88">RDCatalog::HierarchCatalog::addEntry</a></div><div class="ttdeci">unsigned int addEntry(entryType *entry, bool updateFPLength=true)</div><div class="ttdoc">add a new entry to the catalog </div><div class="ttdef"><b>Definition:</b> <a href="Catalog_8h_source.html#l00304">Catalog.h:304</a></div></div>
<div class="ttc" id="classRDCatalog_1_1HierarchCatalog_html_a24a2ca3195acc0e14adbfdda89462f0f"><div class="ttname"><a href="classRDCatalog_1_1HierarchCatalog.html#a24a2ca3195acc0e14adbfdda89462f0f">RDCatalog::HierarchCatalog::~HierarchCatalog</a></div><div class="ttdeci">~HierarchCatalog()</div><div class="ttdef"><b>Definition:</b> <a href="Catalog_8h_source.html#l00176">Catalog.h:176</a></div></div>
<div class="ttc" id="classRDCatalog_1_1Catalog_html_ae20801408f3e87ee2993c1ba43f5cb90"><div class="ttname"><a href="classRDCatalog_1_1Catalog.html#ae20801408f3e87ee2993c1ba43f5cb90">RDCatalog::Catalog::setFPLength</a></div><div class="ttdeci">void setFPLength(unsigned int val)</div><div class="ttdoc">sets our fingerprint length </div><div class="ttdef"><b>Definition:</b> <a href="Catalog_8h_source.html#l00080">Catalog.h:80</a></div></div>
<div class="ttc" id="namespaceRDKit_1_1EnumerationStrategyPickler_html_aee2e7efc329d5ef918764c5aa5ce7836"><div class="ttname"><a href="namespaceRDKit_1_1EnumerationStrategyPickler.html#aee2e7efc329d5ef918764c5aa5ce7836">RDKit::EnumerationStrategyPickler::pickle</a></div><div class="ttdeci">void pickle(const boost::shared_ptr&lt; EnumerationStrategyBase &gt; &amp;enumerator, std::ostream &amp;ss)</div><div class="ttdoc">pickles a EnumerationStrategy and adds the results to a stream ss </div></div>
<div class="ttc" id="classRDCatalog_1_1HierarchCatalog_html_abf2a09798165a8696e1302da0015215e"><div class="ttname"><a href="classRDCatalog_1_1HierarchCatalog.html#abf2a09798165a8696e1302da0015215e">RDCatalog::HierarchCatalog::getDownEntryList</a></div><div class="ttdeci">RDKit::INT_VECT getDownEntryList(unsigned int idx) const </div><div class="ttdoc">returns a list of the indices of entries below the one passed in </div><div class="ttdef"><b>Definition:</b> <a href="Catalog_8h_source.html#l00398">Catalog.h:398</a></div></div>
<div class="ttc" id="classRDCatalog_1_1Catalog_html_a55774178758e0b135ad6d6d32193586e"><div class="ttname"><a href="classRDCatalog_1_1Catalog.html#a55774178758e0b135ad6d6d32193586e">RDCatalog::Catalog::entryType_t</a></div><div class="ttdeci">entryType entryType_t</div><div class="ttdef"><b>Definition:</b> <a href="Catalog_8h_source.html#l00041">Catalog.h:41</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b04e06d76e30353185e7a4d309c539aa.html">Catalogs</a></li><li class="navelem"><a class="el" href="Catalog_8h.html">Catalog.h</a></li>
    <li class="footer">Generated on Tue Jan 23 2018 11:03:06 for RDKit by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
