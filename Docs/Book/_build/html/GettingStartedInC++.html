
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="ja">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Getting Started with the RDKit in C++ &#8212; The RDKit 2017.09.2 ドキュメント</title>
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '2017.09.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/translations.js"></script>
    <link rel="index" title="索引" href="genindex.html" />
    <link rel="search" title="検索" href="search.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="総合索引"
             accesskey="I">索引</a></li>
        <li class="nav-item nav-item-0"><a href="index.html">The RDKit 2017.09.2 ドキュメント</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="index.html">目次</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Overview.html">An overview of the RDKit</a></li>
<li class="toctree-l1"><a class="reference internal" href="Install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="GettingStartedInPython.html">Getting Started with the RDKit in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="RDKit_Book.html">The RDKit Book</a></li>
<li class="toctree-l1"><a class="reference internal" href="Cookbook.html">RDKit Cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="Cartridge.html">The RDKit database cartridge</a></li>
</ul>

  <div role="note" aria-label="source link">
    <h3>このページ</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/GettingStartedInC++.md.txt"
            rel="nofollow">ソースコードを表示</a></li>
    </ul>
   </div>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="getting-started-with-the-rdkit-in-c">
<span id="getting-started-with-the-rdkit-in-c"></span><h1>Getting Started with the RDKit in C++<a class="headerlink" href="#getting-started-with-the-rdkit-in-c" title="このヘッドラインへのパーマリンク">¶</a></h1>
<div class="section" id="what-is-this">
<span id="what-is-this"></span><h2>What is this?<a class="headerlink" href="#what-is-this" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>This document is intended to provide an overview of how one can use
the RDKit functionality from C++. Like the 『Getting Started with the
RDKit in Python』 it is not comprehensive and it’s not a manual.  It is
modelled very closely on the Python version, and most of the text will
be similar if not identical.  It is a work-in-progress, and will be
added to over the coming months.</p>
</div>
<div class="section" id="building-and-running-c-rdkit-programs">
<span id="building-and-running-c-rdkit-programs"></span><h2>Building and Running C++ RDKit Programs<a class="headerlink" href="#building-and-running-c-rdkit-programs" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Unlike Python scripts, which, once the environment is setup up
correctly, can be run directly from a script or Jupyter notebook
session, the C++ programs must be compiled and linked before they can
be run. This creates an additional step, which varies with operating
system.  Using the program cmake makes it easier, but you may need to
experiment and change settings to get this working.  You will
need a reasonably modern C++ compiler. On linux systems this will most
likely be the GNU compiler gcc, although it could be Clang.  On Macs,
the opposite is true, and on Windows machines it will probably be
Visual C++.  At present, RDKit uses a relatively old-fashioned (or, as
Greg prefers, 「maximally backwards compatible」) dialect
of C++, so gcc version 3.4 or higher is adequate, but this is due to
change within the next year.</p>
<p>C++ programs generally have quite a lot of extra verbiage in them
compared to, for example, python scripts, that is similar or identical
in all programs.  The would produce extraneous clutter in the example
code in this document.  Because of this, only the minimum code to
exemplify the point being made is shown in the text. Full programs for
all the examples (generally with multiple examples in the same
program) are given in the <code class="docutils literal"><span class="pre">$RDBASE/Docs/Book/C++Examples</span></code> directory in
the distribution. The particular program will be mentioned in the text.</p>
<p>The functions of the RDKit system are declared in a large number of
different header files spread across several directories in the
system, and defined across a number of different libraries.  The right
headers will need to be included in the source code, and libraries
linked to during linking.  Whilst it’s possible to include all headers
and libraries in all executables this will result in slower compile
times, especially
if you are doing static linking.  When linking to the static (.a)
libraries rather than the shared-object (.so) ones, the order the
libraries appear in linking list can be important.  See the
CMakeLists.txt file in C++Examples directory for a good order.  In
this case, the same library list is used for all examples, so some
will be unnecessary for some of the programs. The first 3 programs
don’t need the Depictor and SubstructMatch libraries, for instance,
although on my Ubuntu 16.04 system, the RDGeometryLib appears to need
to be included twice. Working out which libraries need to be linked to
and in what order can involve a tedious amount of trial and error.</p>
</div>
<div class="section" id="should-you-use-c-or-python">
<span id="should-you-use-c-or-python"></span><h2>Should You Use C++ or Python?<a class="headerlink" href="#should-you-use-c-or-python" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>There is no doubt that it is much easier get started with
Python.  If you follow the installation instructions, you will be able
to start programming and using scripts straightaway.  If all you are
going to do is use scripts to do relatively simple things,
essentially stitching RDKit function calls together, there should be
little or no speed issues with using the Python interpreted language,
as all the RDKit functions are compiled C++ and well optimised.
However, if you are going to do more complicated things, using a lot
of your own programming logic and only using the RDKit for peripheral
things like I/O, SMARTS matching, preparing 2D images and the like,
then it is likely that you will have good performance gains if you
write in C++ and compile to a native executable.  One reason for
faster executables from C++ is that because the code is only compiled
once, it can be worth the compiler spending more time optimising the
code for speed.  In Python, where the compilation is done each time at
run-time, this overhead is less acceptable.  Writing inefficient code
is relatively easy in any language, but the C++ compiler can save you
from yourself-at higher optimisation levels, it will re-arrange loops,
factorise expressions etc., so that the final executable may be
difficult to align with the original source code.  For example
(Huw!), the gcc will change sqrt(a) * sqrt(b) to sqrt(a*b) removing an
expensive square root operation.</p>
<p>Another consideration is the completeness of the API.  A lot of the
higher level functionality in RDKit is developed in Python, and
back-porting to C++ occurs on a demand-driven basis.  There are
therefore examples of quite useful functionality, such as computing
the RMS differences between conformers that are not available in C++.
Of course, if this affects you you can always implement the C++ version
and submit a Pull Request. Indeed, the RMS calculation is on its way.</p>
</div>
<div class="section" id="memory-management">
<span id="memory-management"></span><h2>Memory Management<a class="headerlink" href="#memory-management" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Memory leaks (where objects are created using <code class="docutils literal"><span class="pre">new</span></code> but never
destroyed using <code class="docutils literal"><span class="pre">delete</span></code>) are particularly insidious bugs that can be
difficult to track down
(<a class="reference external" href="http://valgrind.org">Valgrind is your friend!</a>) and may be a
surprise to people used to managed-memory languages like python and
java.  In RDKit, many of the functions return pointers to molecules
and accept such pointers as arguments.  The
<a class="reference external" href="http://boost.org">Boost libraries</a> provide tools such as shared
(<code class="docutils literal"><span class="pre">boost::shared_ptr</span></code>) and scoped (<code class="docutils literal"><span class="pre">boost::scoped_ptr</span></code>) pointers that
can be very helpful in preventing memory leaks.  If an object is
created and a pointer to it is stored in a shared pointer, for
example, then when the shared pointer goes out of scope, the object
is automatically deleted.  Otherwise, the shared pointer is used
exactly as one would use an ordinary pointer.  To save some typing,
RDKit has a number of typedefs for shared pointers to its objects,
defined in the relevant header files.  Two particularly useful ones
are <code class="docutils literal"><span class="pre">RDKit::ROMOL_SPTR</span></code> and <code class="docutils literal"><span class="pre">RDKit::RWMOL_SPTR</span></code>, for <code class="docutils literal"><span class="pre">RDKit::ROMol</span></code>
and <code class="docutils literal"><span class="pre">RDKit::RWMol</span></code> objects respectively.</p>
<p>Something that isn’t just relevant to the RDKit, but worth noting
generally, is that the new C++
standard also has <code class="docutils literal"><span class="pre">shared_ptr</span></code> and <code class="docutils literal"><span class="pre">scoped_ptr</span></code> in the standard
namespace (essentially, they’ve adopted the boost libraries).  As I
discovered the hard way, if you put <code class="docutils literal"><span class="pre">using</span> <span class="pre">namespace</span> <span class="pre">boost</span></code> and <code class="docutils literal"><span class="pre">using</span> <span class="pre">namespace</span> <span class="pre">std</span></code> at the top of your source file (and let’s face it, who
doesn’t?), and use the unqualified name <code class="docutils literal"><span class="pre">shared_ptr</span></code> in your
code, then, when you start using C++11, you’ll have to go all through
your code explicitly stating whether you’re using <code class="docutils literal"><span class="pre">std::shared_ptr</span></code> or
<code class="docutils literal"><span class="pre">boost::shared_ptr</span></code>.  Worth getting in the habit now!</p>
</div>
<div class="section" id="the-molecule-classes">
<span id="the-molecule-classes"></span><h2>The Molecule Classes<a class="headerlink" href="#the-molecule-classes" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Unlike in the Python libraries, in C++ there are two different
molecule classes, <code class="docutils literal"><span class="pre">RDKit::ROMol</span></code> and <code class="docutils literal"><span class="pre">RDKit::RWMol</span></code>.  They are both
declared in GraphMol.h. ROMol (the Read-Only molecule) is used in
most instances. It can’t be edited.  On those occasions where you will
need to edit the molecule, you’ll need to use the RWMol (Read-Write).</p>
</div>
<div class="section" id="reading-and-writing-molecules">
<span id="reading-and-writing-molecules"></span><h2>Reading and Writing Molecules<a class="headerlink" href="#reading-and-writing-molecules" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>The majority of basic molecular functionality is found in the RDKit
namespace, and only a small number of header files will need to be included
to cover most use cases:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;GraphMol/GraphMol.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;GraphMol/FileParsers/MolSupplier.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;GraphMol/FileParsers/MolWriters.h&gt;</span><span class="cp"></span>
</pre></div>
</div>
<div class="section" id="reading-single-molecules">
<span id="reading-single-molecules"></span><h3>Reading Single Molecules<a class="headerlink" href="#reading-single-molecules" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Individual molecules can be constructed using a variety of approaches <a class="reference external" href="./C++Examples/example1.cpp">(example1)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">file_root</span> <span class="o">=</span> <span class="n">getenv</span><span class="p">(</span> <span class="s">&quot;RDBASE&quot;</span> <span class="p">);</span>
<span class="n">file_root</span> <span class="o">+=</span> <span class="s">&quot;/Docs/Book&quot;</span><span class="p">;</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">ROMol</span> <span class="o">*</span><span class="n">mol1</span> <span class="o">=</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SmilesToMol</span><span class="p">(</span> <span class="s">&quot;Cc1ccccc1&quot;</span> <span class="p">);</span>

<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">mol_file</span> <span class="o">=</span> <span class="n">file_root</span> <span class="o">+</span> <span class="s">&quot;/data/input.mol&quot;</span><span class="p">;</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">ROMOL_SPTR</span> <span class="n">mol2</span><span class="p">(</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">MolFileToMol</span><span class="p">(</span> <span class="n">mol_file</span> <span class="p">)</span> <span class="p">);</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="o">*</span><span class="n">mol2</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

<span class="n">RDKit</span><span class="o">::</span><span class="n">ROMOL_SPTR</span> <span class="n">mol3</span><span class="p">(</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SmilesToMol</span><span class="p">(</span> <span class="s">&quot;Cc1cccc&quot;</span> <span class="p">)</span> <span class="p">);</span>
</pre></div>
</div>
<p>All these return a pointer to an ROMol on success, or NULL on
failure. Obviously, the object must be deleted when finished with to
prevent memory leaks. In the example above, and henceforth in this
document, the molecules, apart from mol1, are wrapped in shared
pointers so that the objects are deleted as soon as the shared pointer
goes out of scope.</p>
<p>If the molecule can’t be sanitized after SMILES parsing, an
<code class="docutils literal"><span class="pre">RDKit::MolSanitizeException</span></code> (derived
from <code class="docutils literal"><span class="pre">std::exception</span></code>) is thrown, and an attempt is made to provide
sensible error messages <a class="reference external" href="./C++Examples/example1.cpp">(example1)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="k">try</span> <span class="p">{</span>
   <span class="n">RDKit</span><span class="o">::</span><span class="n">ROMOL_SPTR</span> <span class="n">mol</span><span class="p">(</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SmilesToMol</span><span class="p">(</span> <span class="s">&quot;CO(C)C&quot;</span> <span class="p">)</span> <span class="p">);</span>
<span class="p">}</span> <span class="k">catch</span><span class="p">(</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">MolSanitizeException</span> <span class="o">&amp;</span><span class="n">e</span> <span class="p">)</span> <span class="p">{</span>
   <span class="c1">// empty catch</span>
<span class="p">}</span>
</pre></div>
</div>
<p>displays something like <code class="docutils literal"><span class="pre">[15:58:22]</span> <span class="pre">Explicit</span> <span class="pre">valence</span> <span class="pre">of</span> <span class="pre">atom</span> <span class="pre">#</span> <span class="pre">1</span> <span class="pre">O,</span> <span class="pre">3,</span> <span class="pre">is</span> <span class="pre">greater</span> <span class="pre">than</span> <span class="pre">permitted</span></code> and <a class="reference external" href="./C++Examples/example1.cpp">(example1)</a></p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="k">try</span> <span class="p">{</span>
   <span class="n">RDKit</span><span class="o">::</span><span class="n">ROMOL_SPTR</span> <span class="n">mol</span><span class="p">(</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SmilesToMol</span><span class="p">(</span> <span class="s">&quot;c1cc1&quot;</span> <span class="p">)</span> <span class="p">);</span>
<span class="p">}</span> <span class="k">catch</span><span class="p">(</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">MolSanitizeException</span> <span class="o">&amp;</span><span class="n">e</span> <span class="p">)</span> <span class="p">{</span>
   <span class="c1">// empty catch</span>
<span class="p">}</span>
</pre></div>
</div>
<p>displays something like: <code class="docutils literal"><span class="pre">[12:20:41]</span> <span class="pre">Can't</span> <span class="pre">kekulize</span> <span class="pre">mol</span></code>.</p>
</div>
<div class="section" id="reading-sets-of-molecules">
<span id="reading-sets-of-molecules"></span><h3>Reading sets of molecules<a class="headerlink" href="#reading-sets-of-molecules" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Groups of molecules are read using a Supplier (for example, an
<code class="docutils literal"><span class="pre">RDKit::SDMolSupplier</span></code> or an <code class="docutils literal"><span class="pre">RDKit::SmilesMolSupplier</span></code>)
<a class="reference external" href="./C++Examples/example2.cpp">(example2)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="n">RDKit</span><span class="o">::</span><span class="n">ROMOL_SPTR</span> <span class="n">mol</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">file_root</span> <span class="o">=</span> <span class="n">getenv</span><span class="p">(</span> <span class="s">&quot;RDBASE&quot;</span> <span class="p">);</span>
<span class="n">file_root</span> <span class="o">+=</span> <span class="s">&quot;/Docs/Book&quot;</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">sdf_file</span> <span class="o">=</span> <span class="n">file_root</span> <span class="o">+</span> <span class="s">&quot;/data/5ht3ligs.sdf&quot;</span><span class="p">;</span>
<span class="kt">bool</span> <span class="n">takeOwnership</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">SDMolSupplier</span> <span class="n">mol_supplier</span><span class="p">(</span> <span class="n">sdf_file</span> <span class="p">,</span> <span class="n">takeOwnership</span> <span class="p">);</span>
<span class="k">while</span><span class="p">(</span> <span class="o">!</span><span class="n">mol_supplier</span><span class="p">.</span><span class="n">atEnd</span><span class="p">()</span> <span class="p">)</span> <span class="p">{</span>
  <span class="n">mol</span><span class="p">.</span><span class="n">reset</span><span class="p">(</span> <span class="n">mol_supplier</span><span class="p">.</span><span class="n">next</span><span class="p">()</span> <span class="p">);</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">mol</span><span class="o">-&gt;</span><span class="n">getProp</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span><span class="p">(</span> <span class="s">&quot;_Name&quot;</span> <span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; has &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">mol</span><span class="o">-&gt;</span><span class="n">getNumAtoms</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; atoms.&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>gives</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">20</span>
<span class="mi">24</span>
<span class="mi">24</span>
<span class="mi">26</span>
</pre></div>
</div>
<p>The supplier can be treated as a random-access object <a class="reference external" href="./C++Examples/example2.cpp">(example2)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="n">RDKit</span><span class="o">::</span><span class="n">SDMolSupplier</span> <span class="n">mol_supplier</span><span class="p">(</span> <span class="s">&quot;data/5ht3ligs.sdf&quot;</span> <span class="p">,</span> <span class="n">takeOwnership</span> <span class="p">);</span>
<span class="k">for</span><span class="p">(</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="kt">int</span><span class="p">(</span> <span class="n">mol_supplier</span><span class="p">.</span><span class="n">length</span><span class="p">()</span> <span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span>  <span class="p">;</span> <span class="o">--</span><span class="n">i</span> <span class="p">)</span> <span class="p">{</span>
  <span class="n">RDKit</span><span class="o">::</span><span class="n">ROMOL_SPTR</span> <span class="n">mol</span><span class="p">(</span> <span class="n">mol_supplier</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">);</span>
  <span class="k">if</span><span class="p">(</span> <span class="n">mol</span> <span class="p">)</span> <span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">mol</span><span class="o">-&gt;</span><span class="n">getProp</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span><span class="p">(</span> <span class="s">&quot;_Name&quot;</span> <span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; has &quot;</span>
              <span class="o">&lt;&lt;</span> <span class="n">mol</span><span class="o">-&gt;</span><span class="n">getNumAtoms</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; atoms.&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>gives</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">mol</span><span class="o">-</span><span class="mi">732</span> <span class="n">has</span> <span class="mi">26</span> <span class="n">atoms</span><span class="o">.</span>
<span class="n">mol</span><span class="o">-</span><span class="mi">15</span> <span class="n">has</span> <span class="mi">24</span> <span class="n">atoms</span><span class="o">.</span>
<span class="n">mol</span><span class="o">-</span><span class="mi">54</span> <span class="n">has</span> <span class="mi">24</span> <span class="n">atoms</span><span class="o">.</span>
<span class="n">mol</span><span class="o">-</span><span class="mi">295</span> <span class="n">has</span> <span class="mi">20</span> <span class="n">atoms</span><span class="o">.</span>
</pre></div>
</div>
<p>A good practice is to test each molecule to see if it was correctly
read before working with it <a class="reference external" href="./C++Examples/example2.cpp">(example2)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="kt">bool</span> <span class="n">takeOwnership</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">SDMolSupplier</span> <span class="o">*</span><span class="n">mol_supplier</span> <span class="o">=</span> <span class="k">new</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SDMolSupplier</span><span class="p">(</span> <span class="s">&quot;data/5ht3ligs.sdf&quot;</span> <span class="p">,</span> <span class="n">takeOwnership</span> <span class="p">);</span>

<span class="k">for</span><span class="p">(</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="kt">int</span><span class="p">(</span> <span class="n">mol_supplier</span><span class="o">-&gt;</span><span class="n">length</span><span class="p">()</span> <span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="p">;</span> <span class="o">--</span><span class="n">i</span> <span class="p">)</span> <span class="p">{</span>
  <span class="n">RDKit</span><span class="o">::</span><span class="n">ROMOL_SPTR</span> <span class="n">mol</span><span class="p">(</span> <span class="p">(</span><span class="o">*</span><span class="n">mol_supplier</span><span class="p">)[</span><span class="n">i</span><span class="p">]</span> <span class="p">);</span>
  <span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="n">mol</span> <span class="p">)</span> <span class="p">{</span>
    <span class="k">continue</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">mol</span><span class="o">-&gt;</span><span class="n">getProp</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span><span class="p">(</span> <span class="s">&quot;_Name&quot;</span> <span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; has &quot;</span>
            <span class="o">&lt;&lt;</span> <span class="n">mol</span><span class="o">-&gt;</span><span class="n">getNumAtoms</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; atoms.&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>An alternative type of Supplier, the <code class="docutils literal"><span class="pre">RDKit::ForwardMolSupplier</span></code>
can be used to read from file-like objects.  This allows the reading
of compressed files, using, for example, the <code class="docutils literal"><span class="pre">boost::iostreams</span></code>
objects <a class="reference external" href="./C++Examples/example2.cpp">(example2)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">file_root</span> <span class="o">=</span> <span class="n">getenv</span><span class="p">(</span> <span class="s">&quot;RDBASE&quot;</span> <span class="p">);</span>
<span class="n">file_root</span> <span class="o">+=</span> <span class="s">&quot;/Docs/Book&quot;</span><span class="p">;</span>
<span class="n">boost</span><span class="o">::</span><span class="n">iostreams</span><span class="o">::</span><span class="n">filtering_istream</span> <span class="n">ins</span><span class="p">;</span>
<span class="n">ins</span><span class="p">.</span><span class="n">push</span><span class="p">(</span> <span class="n">boost</span><span class="o">::</span><span class="n">iostreams</span><span class="o">::</span><span class="n">gzip_decompressor</span><span class="p">()</span> <span class="p">);</span>
<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">comp_sdf_file</span> <span class="o">=</span> <span class="n">file_root</span> <span class="o">+</span> <span class="s">&quot;/data/actives_5ht3.sdf.gz&quot;</span><span class="p">;</span>
<span class="n">ins</span><span class="p">.</span><span class="n">push</span><span class="p">(</span> <span class="n">boost</span><span class="o">::</span><span class="n">iostreams</span><span class="o">::</span><span class="n">file_source</span><span class="p">(</span> <span class="n">comp_sdf_file</span> <span class="p">)</span> <span class="p">);</span>
<span class="c1">// takeOwnership must be false for this, as we don&#39;t want the SDWriter trying</span>
<span class="c1">// to delete the boost::iostream</span>
<span class="kt">bool</span> <span class="n">takeOwnership</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">ForwardSDMolSupplier</span> <span class="n">forward_supplier</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">ins</span> <span class="p">,</span> <span class="n">takeOwnership</span> <span class="p">);</span>
<span class="k">while</span><span class="p">(</span> <span class="o">!</span><span class="n">forward_supplier</span><span class="p">.</span><span class="n">atEnd</span><span class="p">()</span> <span class="p">)</span> <span class="p">{</span>
  <span class="n">mol</span><span class="p">.</span><span class="n">reset</span><span class="p">(</span> <span class="n">forward_supplier</span><span class="p">.</span><span class="n">next</span><span class="p">()</span> <span class="p">);</span>
  <span class="k">if</span><span class="p">(</span> <span class="n">mol</span> <span class="p">)</span> <span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">mol</span><span class="o">-&gt;</span><span class="n">getProp</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span><span class="p">(</span> <span class="s">&quot;_Name&quot;</span> <span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; has &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">mol</span><span class="o">-&gt;</span><span class="n">getNumAtoms</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; atoms.&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Note that the forward suppliers cannot be used in random-access mode,
and a compile-time error will result if you attempt to <a class="reference external" href="./C++Examples/example2.cpp">(example2)</a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>error: no match for ‘operator[]’ (operand types are
‘RDKit::ForwardSDMolSupplier’ and ‘int’) 
   mol = forward_supplier[1];
</pre></div>
</div>
</div>
<div class="section" id="writing-molecules">
<span id="writing-molecules"></span><h3>Writing molecules<a class="headerlink" href="#writing-molecules" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Single molecules can be converted to text using several functions
present in the <code class="docutils literal"><span class="pre">RDKit</span></code> namespace.</p>
<p>For example, for SMILES <a class="reference external" href="./C++Examples/example3.cpp">(example3)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;GraphMol/SmilesParse/SmilesWrite.h&gt;</span><span class="cp"></span>
<span class="p">.</span>
<span class="p">.</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">ROMOL_SPTR</span> <span class="n">mol</span><span class="p">(</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">MolFromMolFile</span><span class="p">(</span> <span class="s">&quot;data/chiral.mol&quot;</span> <span class="p">)</span> <span class="p">);</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">MolToSmiles</span><span class="p">(</span> <span class="o">*</span><span class="n">mol</span> <span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>gives</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">CC</span><span class="p">(</span><span class="n">O</span><span class="p">)</span><span class="n">c1ccccc1</span>
</pre></div>
</div>
<p>and <a class="reference external" href="./C++Examples/example3.cpp">(example3)</a></p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="kt">bool</span> <span class="n">isomeric</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">MolToSmiles</span><span class="p">(</span> <span class="o">*</span><span class="n">mol</span> <span class="p">,</span> <span class="n">isomeric</span> <span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>produces</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">C</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">O</span><span class="p">)</span><span class="n">c1ccccc1</span>
</pre></div>
</div>
<p>where the <code class="docutils literal"><span class="pre">isomeric</span></code> in the second function call specifies that isomeric
SMILES should be produced.
Note that the SMILES produced is canonical, so the output should be
the same no matter how a particular molecule is input.  For example
<a class="reference external" href="./C++Examples/example3.cpp">(example3)</a></p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="n">RDKit</span><span class="o">::</span><span class="n">ROMOL_SPTR</span> <span class="n">mol1</span><span class="p">(</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SmilesToMol</span><span class="p">(</span> <span class="s">&quot;C1=CC=CN=C1&quot;</span> <span class="p">)</span> <span class="p">);</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">MolToSmiles</span><span class="p">(</span> <span class="o">*</span><span class="n">mol1</span> <span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

<span class="n">RDKit</span><span class="o">::</span><span class="n">ROMOL_SPTR</span> <span class="n">mol2</span><span class="p">(</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SmilesToMol</span><span class="p">(</span> <span class="s">&quot;c1cccnc1&quot;</span> <span class="p">)</span> <span class="p">);</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">MolToSmiles</span><span class="p">(</span> <span class="o">*</span><span class="n">mol2</span> <span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

<span class="n">RDKit</span><span class="o">::</span><span class="n">ROMOL_SPTR</span> <span class="n">mol3</span><span class="p">(</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SmilesToMol</span><span class="p">(</span> <span class="s">&quot;n1ccccc1&quot;</span> <span class="p">)</span> <span class="p">);</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">MolToSmiles</span><span class="p">(</span> <span class="o">*</span><span class="n">mol3</span> <span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>all produce <code class="docutils literal"><span class="pre">c1ccncc1</span></code> as output.</p>
<p>If you’d like to have the Kekule form of the SMILES, you need to Kekulize
an RWMol copy of the molecule, using the Kekulize function declared in
MolOps.h <a class="reference external" href="./C++Examples/example3.cpp">(example3)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;GraphMol/MolOps.h&gt;</span><span class="cp"></span>
<span class="p">.</span>
<span class="p">.</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">RWMOL_SPTR</span> <span class="n">mol4</span><span class="p">(</span> <span class="k">new</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">RWMol</span><span class="p">(</span> <span class="o">*</span><span class="n">mol</span> <span class="p">)</span> <span class="p">);</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">MolOps</span><span class="o">::</span><span class="n">Kekulize</span><span class="p">(</span> <span class="o">*</span><span class="n">mol4</span> <span class="p">);</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">MolToSmiles</span><span class="p">(</span> <span class="o">*</span><span class="n">mol4</span> <span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>gives</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">CC</span><span class="p">(</span><span class="n">O</span><span class="p">)</span><span class="n">C1</span><span class="o">=</span><span class="n">CC</span><span class="o">=</span><span class="n">CC</span><span class="o">=</span><span class="n">C1</span>
</pre></div>
</div>
<p>Note: as of March 2017, the SMILES provided when one
requests kekuleSmiles are not canonical. The limitation is not in the
SMILES generation, but in the kekulization itself.</p>
<p>MDL Mol blocks are also available <a class="reference external" href="./C++Examples/example3.cpp">(example3)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="n">RDKit</span><span class="o">::</span><span class="n">ROMOL_SPTR</span> <span class="n">mol1</span><span class="p">(</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SmilesToMol</span><span class="p">(</span> <span class="s">&quot;C1=CC=CN=C1&quot;</span> <span class="p">)</span> <span class="p">);</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">MolToMolBlock</span><span class="p">(</span> <span class="o">*</span><span class="n">mol1</span> <span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>gives</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>
    <span class="n">RDKit</span>
    
  <span class="mi">6</span>  <span class="mi">6</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0999</span> <span class="n">V2000</span>
    <span class="mf">0.0000</span>    <span class="mf">0.0000</span>    <span class="mf">0.0000</span> <span class="n">C</span>   <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
    <span class="mf">0.0000</span>    <span class="mf">0.0000</span>    <span class="mf">0.0000</span> <span class="n">C</span>   <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
    <span class="mf">0.0000</span>    <span class="mf">0.0000</span>    <span class="mf">0.0000</span> <span class="n">C</span>   <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
    <span class="mf">0.0000</span>    <span class="mf">0.0000</span>    <span class="mf">0.0000</span> <span class="n">C</span>   <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
    <span class="mf">0.0000</span>    <span class="mf">0.0000</span>    <span class="mf">0.0000</span> <span class="n">N</span>   <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
    <span class="mf">0.0000</span>    <span class="mf">0.0000</span>    <span class="mf">0.0000</span> <span class="n">C</span>   <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
  <span class="mi">1</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">0</span>
  <span class="mi">2</span>  <span class="mi">3</span>  <span class="mi">1</span>  <span class="mi">0</span>
  <span class="mi">3</span>  <span class="mi">4</span>  <span class="mi">2</span>  <span class="mi">0</span>
  <span class="mi">4</span>  <span class="mi">5</span>  <span class="mi">1</span>  <span class="mi">0</span>
  <span class="mi">5</span>  <span class="mi">6</span>  <span class="mi">2</span>  <span class="mi">0</span>
  <span class="mi">6</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">0</span>
<span class="n">M</span>  <span class="n">END</span>
</pre></div>
</div>
<p>To include names in the mol blocks, set the molecule’s “_Name”
property <a class="reference external" href="./C++Examples/example3.cpp">(example3)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="n">mol1</span> <span class="o">=</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SmilesToMol</span><span class="p">(</span> <span class="s">&quot;C1CCC1&quot;</span> <span class="p">);</span>
<span class="n">mol1</span><span class="o">-&gt;</span><span class="n">setProp</span><span class="p">(</span> <span class="s">&quot;_Name&quot;</span> <span class="p">,</span> <span class="s">&quot;cyclobutane&quot;</span> <span class="p">);</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">MolToMolBlock</span><span class="p">(</span> <span class="o">*</span><span class="n">mol1</span> <span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>gives</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cyclobutane</span>
     <span class="n">RDKit</span>
  <span class="mi">4</span>  <span class="mi">4</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0999</span> <span class="n">V2000</span>
    <span class="mf">0.0000</span>    <span class="mf">0.0000</span>    <span class="mf">0.0000</span> <span class="n">C</span>   <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
    <span class="mf">0.0000</span>    <span class="mf">0.0000</span>    <span class="mf">0.0000</span> <span class="n">C</span>   <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
    <span class="mf">0.0000</span>    <span class="mf">0.0000</span>    <span class="mf">0.0000</span> <span class="n">C</span>   <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
    <span class="mf">0.0000</span>    <span class="mf">0.0000</span>    <span class="mf">0.0000</span> <span class="n">C</span>   <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
  <span class="mi">1</span>  <span class="mi">2</span>  <span class="mi">1</span>  <span class="mi">0</span>
  <span class="mi">2</span>  <span class="mi">3</span>  <span class="mi">1</span>  <span class="mi">0</span>
  <span class="mi">3</span>  <span class="mi">4</span>  <span class="mi">1</span>  <span class="mi">0</span>
  <span class="mi">4</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">0</span>
<span class="n">M</span>  <span class="n">END</span>
</pre></div>
</div>
<p>Note that setProp, which is a general function, can be called on an
ROMol as well as an RWMol, which came as a surprise to me as I had
assumed a read-only molecule would be less changeable than that.</p>
<p>In order for atom or bond stereochemistry to be recognised correctly by most
software, it’s essential that the Mol block have atomic coordinates.
It’s also convenient for many reasons, such as drawing the molecules.</p>
<p>You can either include 2D coordinates (i.e. a depiction), using the
function in the RDDepict namespace and declared in RDDepictor.h
<a class="reference external" href="./C++Examples/example4.cpp">(example4)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;GraphMol/Depictor/RDDepictor.h&gt;</span><span class="cp"></span>
<span class="p">.</span>
<span class="p">.</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">ROMOL_SPTR</span> <span class="n">mol1</span><span class="p">(</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SmilesToMol</span><span class="p">(</span> <span class="s">&quot;C1CCC1&quot;</span> <span class="p">)</span> <span class="p">);</span>
<span class="n">RDDepict</span><span class="o">::</span><span class="n">compute2DCoords</span><span class="p">(</span> <span class="o">*</span><span class="n">mol1</span> <span class="p">);</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">MolToMolBlock</span><span class="p">(</span> <span class="o">*</span><span class="n">mol1</span> <span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>gives</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>
     <span class="n">RDKit</span>          <span class="mi">2</span><span class="n">D</span>

  <span class="mi">4</span>  <span class="mi">4</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0999</span> <span class="n">V2000</span>
    <span class="mf">1.0607</span>    <span class="mf">0.0000</span>    <span class="mf">0.0000</span> <span class="n">C</span>   <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
   <span class="o">-</span><span class="mf">0.0000</span>   <span class="o">-</span><span class="mf">1.0607</span>    <span class="mf">0.0000</span> <span class="n">C</span>   <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
   <span class="o">-</span><span class="mf">1.0607</span>    <span class="mf">0.0000</span>    <span class="mf">0.0000</span> <span class="n">C</span>   <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
    <span class="mf">0.0000</span>    <span class="mf">1.0607</span>    <span class="mf">0.0000</span> <span class="n">C</span>   <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
  <span class="mi">1</span>  <span class="mi">2</span>  <span class="mi">1</span>  <span class="mi">0</span>
  <span class="mi">2</span>  <span class="mi">3</span>  <span class="mi">1</span>  <span class="mi">0</span>
  <span class="mi">3</span>  <span class="mi">4</span>  <span class="mi">1</span>  <span class="mi">0</span>
  <span class="mi">4</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">0</span>
<span class="n">M</span>  <span class="n">END</span>
</pre></div>
</div>
<p>Or you can add 3D coordinates by embedding the molecule <a class="reference external" href="./C++Examples/example4.cpp">(example4)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;GraphMol/DistGeomHelpers/Embedder.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;GraphMol/ForceFieldHelpers/MMFF/MMFF.h&gt;</span><span class="cp"></span>
<span class="p">.</span>
<span class="p">.</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">ROMOL_SPTR</span> <span class="n">mol2</span><span class="p">(</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SmilesToMol</span><span class="p">(</span> <span class="s">&quot;C1CCC1&quot;</span> <span class="p">)</span> <span class="p">);</span>
<span class="n">mol2</span><span class="o">-&gt;</span><span class="n">setProp</span><span class="p">(</span> <span class="s">&quot;_Name&quot;</span> <span class="p">,</span> <span class="s">&quot;cyclobutane3D&quot;</span> <span class="p">);</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">DGeomHelpers</span><span class="o">::</span><span class="n">EmbedMolecule</span><span class="p">(</span> <span class="o">*</span><span class="n">mol2</span> <span class="p">);</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">MMFF</span><span class="o">::</span><span class="n">MMFFOptimizeMolecule</span><span class="p">(</span> <span class="o">*</span><span class="n">mol2</span> <span class="p">,</span> <span class="mi">1000</span> <span class="p">,</span> <span class="s">&quot;MMFF94s&quot;</span> <span class="p">);</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">MolToMolBlock</span><span class="p">(</span> <span class="o">*</span><span class="n">mol2</span> <span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>gives</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cyclobutane3D</span>
     <span class="n">RDKit</span>          <span class="mi">3</span><span class="n">D</span>

  <span class="mi">4</span>  <span class="mi">4</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0999</span> <span class="n">V2000</span>
   <span class="o">-</span><span class="mf">0.8321</span>    <span class="mf">0.5405</span>   <span class="o">-</span><span class="mf">0.1981</span> <span class="n">C</span>   <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
   <span class="o">-</span><span class="mf">0.3456</span>   <span class="o">-</span><span class="mf">0.8799</span>   <span class="o">-</span><span class="mf">0.2639</span> <span class="n">C</span>   <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
    <span class="mf">0.7190</span>   <span class="o">-</span><span class="mf">0.5613</span>    <span class="mf">0.7314</span> <span class="n">C</span>   <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
    <span class="mf">0.4587</span>    <span class="mf">0.9006</span>    <span class="mf">0.5008</span> <span class="n">C</span>   <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
  <span class="mi">1</span>  <span class="mi">2</span>  <span class="mi">1</span>  <span class="mi">0</span>
  <span class="mi">2</span>  <span class="mi">3</span>  <span class="mi">1</span>  <span class="mi">0</span>
  <span class="mi">3</span>  <span class="mi">4</span>  <span class="mi">1</span>  <span class="mi">0</span>
  <span class="mi">4</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">0</span>
<span class="n">M</span>  <span class="n">END</span>
</pre></div>
</div>
<p>The optimization step isn’t necessary, but it substantially improves
the quality of the conformation.</p>
<p>To get good 3D conformations, it’s almost always a good idea to add
hydrogens to the molecule first <a class="reference external" href="./C++Examples/example4.cpp">(example4)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="n">RDKit</span><span class="o">::</span><span class="n">ROMOL_SPTR</span> <span class="n">mol3</span><span class="p">(</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">MolOps</span><span class="o">::</span><span class="n">addHs</span><span class="p">(</span> <span class="o">*</span><span class="n">mol2</span> <span class="p">)</span> <span class="p">);</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">MMFF</span><span class="o">::</span><span class="n">MMFFOptimizeMolecule</span><span class="p">(</span> <span class="o">*</span><span class="n">mol3</span> <span class="p">,</span> <span class="mi">1000</span> <span class="p">,</span> <span class="s">&quot;MMFF94s&quot;</span> <span class="p">);</span>

<span class="n">RDKit</span><span class="o">::</span><span class="n">RWMOL_SPTR</span> <span class="n">mol4</span><span class="p">(</span> <span class="k">new</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">RWMol</span><span class="p">(</span> <span class="o">*</span><span class="n">mol3</span> <span class="p">)</span> <span class="p">);</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">MolOps</span><span class="o">::</span><span class="n">addHs</span><span class="p">(</span> <span class="o">*</span><span class="n">mol4</span> <span class="p">);</span>
</pre></div>
</div>
<p><a name="twoAddHs"></a>Note that there are 2 overloaded versions of
addHs. The first takes an
ROMol and, because that can’t be edited, returns a pointer to a new
ROMol with the result.  If you use this version be careful not to leak
memory by not deleting mol2 when you are finished with it. The second
takes an RWMol which it is able to modify in place.  With shared
pointers, memory leaks can be avoided <a class="reference external" href="./C++Examples/example4.cpp">(example4)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="n">RDKit</span><span class="o">::</span><span class="n">ROMOL_SPTR</span> <span class="n">mol3sp</span><span class="p">(</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">MolOps</span><span class="o">::</span><span class="n">addHs</span><span class="p">(</span> <span class="o">*</span><span class="n">mol2</span> <span class="p">)</span> <span class="p">);</span>
<span class="n">mol3sp</span><span class="o">-&gt;</span><span class="n">setProp</span><span class="p">(</span> <span class="s">&quot;_Name&quot;</span> <span class="p">,</span> <span class="s">&quot;cyclobutaneSP&quot;</span> <span class="p">);</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">MMFF</span><span class="o">::</span><span class="n">MMFFOptimizeMolecule</span><span class="p">(</span> <span class="o">*</span><span class="n">mol3sp</span> <span class="p">,</span> <span class="mi">1000</span> <span class="p">,</span> <span class="s">&quot;MMFF94s&quot;</span> <span class="p">);</span>
</pre></div>
</div>
<p>Once the optimisation is complete, the hydrogens can be removed
again <a class="reference external" href="./C++Examples/example4.cpp">(example4)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="n">RDKit</span><span class="o">::</span><span class="n">ROMOL_SPTR</span> <span class="n">mol5</span><span class="p">(</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">MolOps</span><span class="o">::</span><span class="n">removeHs</span><span class="p">(</span> <span class="o">*</span><span class="n">mol3</span> <span class="p">);</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">MolOps</span><span class="o">::</span><span class="n">removeHs</span><span class="p">(</span> <span class="o">*</span><span class="n">mol4</span> <span class="p">);</span>
</pre></div>
</div>
<p>Again, there are two versions, one of which has an opportunity for a
memory leak.</p>
<p>If you’d like write the molecules to file, use the normal C++
streams <a class="reference external" href="./C++Examples/example4.cpp">(example4)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span>    <span class="cp">#include</span> <span class="cpf">&lt;fstream&gt;</span><span class="cp"></span>
    <span class="p">.</span>
    <span class="p">.</span>
    <span class="n">std</span><span class="o">::</span><span class="n">ofstream</span> <span class="n">ofs</span><span class="p">(</span> <span class="s">&quot;data/foo.mol&quot;</span> <span class="p">);</span>
    <span class="n">ofs</span> <span class="o">&lt;&lt;</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">MolToMolBlock</span><span class="p">(</span> <span class="o">*</span><span class="n">mol5</span> <span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="writing-sets-of-molecules">
<span id="writing-sets-of-molecules"></span><h3>Writing sets of molecules<a class="headerlink" href="#writing-sets-of-molecules" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Multiple molecules can be written to a file using an object of a
concrete subclass of the <code class="docutils literal"><span class="pre">MolWriter</span></code> class <a class="reference external" href="./C++Examples/example5.cpp">(example5)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;GraphMol/FileParsers/MolWriters.h&gt;</span><span class="cp"></span>
<span class="p">.</span>
<span class="p">.</span>
<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">file_root</span> <span class="o">=</span> <span class="n">getenv</span><span class="p">(</span> <span class="s">&quot;RDBASE&quot;</span> <span class="p">);</span>
<span class="n">file_root</span> <span class="o">+=</span> <span class="s">&quot;/Docs/Book&quot;</span><span class="p">;</span>

<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">sdf_file</span> <span class="o">=</span> <span class="n">file_root</span> <span class="o">+</span> <span class="s">&quot;/data/5ht3ligs.sdf&quot;</span><span class="p">;</span>
<span class="kt">bool</span> <span class="n">takeOwnership</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">SDMolSupplier</span> <span class="n">mol_supplier</span><span class="p">(</span> <span class="n">sdf_file</span> <span class="p">,</span> <span class="n">takeOwnership</span> <span class="p">);</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">RDKit</span><span class="o">::</span><span class="n">ROMOL_SPTR</span><span class="o">&gt;</span> <span class="n">mols</span><span class="p">;</span>
<span class="k">while</span><span class="p">(</span> <span class="o">!</span><span class="n">mol_supplier</span><span class="p">.</span><span class="n">atEnd</span><span class="p">()</span> <span class="p">)</span> <span class="p">{</span>
  <span class="n">RDKit</span><span class="o">::</span><span class="n">ROMOL_SPTR</span> <span class="n">mol</span><span class="p">(</span> <span class="n">mol_supplier</span><span class="p">.</span><span class="n">next</span><span class="p">()</span> <span class="p">);</span>
  <span class="k">if</span><span class="p">(</span> <span class="n">mol</span> <span class="p">)</span> <span class="p">{</span>
    <span class="n">mols</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span> <span class="n">mol</span> <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="n">RDKit</span><span class="o">::</span><span class="n">PDBWriter</span> <span class="n">pdb_writer</span><span class="p">(</span> <span class="s">&quot;data/5ht3ligs.pdb&quot;</span> <span class="p">);</span>
<span class="k">for</span><span class="p">(</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">,</span> <span class="n">is</span> <span class="o">=</span> <span class="n">mols</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">is</span> <span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span> <span class="p">{</span>
  <span class="n">pdb_writer</span><span class="p">.</span><span class="n">write</span><span class="p">(</span> <span class="o">*</span><span class="n">mols</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>A MolWriter can also be initialised to a file-like object, so
compressed files can be written or molecules can be written to a
string in memory <a class="reference external" href="./C++Examples/example5.cpp">(example5)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;sstream&gt;</span><span class="cp"></span>
<span class="p">.</span>
<span class="p">.</span>
<span class="n">std</span><span class="o">::</span><span class="n">ostringstream</span> <span class="n">oss</span><span class="p">;</span>
<span class="c1">// takeOwnership must be false for this, as we don&#39;t want the SDWriter trying</span>
<span class="c1">// to delete the std::ostringstream.</span>
<span class="n">takeOwnership</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
<span class="n">boost</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">RDKit</span><span class="o">::</span><span class="n">SDWriter</span><span class="o">&gt;</span> <span class="n">sdf_writer</span><span class="p">(</span> <span class="k">new</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SDWriter</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">oss</span> <span class="p">,</span> <span class="n">takeOwnership</span> <span class="p">)</span> <span class="p">);</span>
<span class="k">for</span><span class="p">(</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">RDKit</span><span class="o">::</span><span class="n">ROMOL_SPTR</span><span class="o">&gt;::</span><span class="n">iterator</span> <span class="n">it</span> <span class="o">=</span> <span class="n">mols</span><span class="p">.</span><span class="n">begin</span><span class="p">()</span> <span class="p">;</span> <span class="n">it</span> <span class="o">!=</span> <span class="n">mols</span><span class="p">.</span><span class="n">end</span><span class="p">()</span> <span class="p">;</span> <span class="o">++</span><span class="n">it</span> <span class="p">)</span> <span class="p">{</span>
  <span class="n">sdf_writer</span><span class="o">-&gt;</span><span class="n">write</span><span class="p">(</span> <span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="n">it</span><span class="p">)</span> <span class="p">);</span>
<span class="p">}</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">oss</span><span class="p">.</span><span class="n">str</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>Other available writers include SmilesWriter and TDTWriter (for those
of you with an interest in historical Cheminformatics).</p>
</div>
</div>
<div class="section" id="working-with-molecules">
<span id="working-with-molecules"></span><h2>Working with Molecules<a class="headerlink" href="#working-with-molecules" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="section" id="looping-over-atoms-and-bonds">
<span id="looping-over-atoms-and-bonds"></span><h3>Looping over Atoms and Bonds<a class="headerlink" href="#looping-over-atoms-and-bonds" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Once you have a molecule, it’s relatively easy to loop over its atoms
and bonds so long as you remember that an atom is a Vertex and a bond
is an Edge and accept the odd syntax <a class="reference external" href="./C++Examples/example6.cpp">(example6)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="n">RDKit</span><span class="o">::</span><span class="n">ROMOL_SPTR</span> <span class="n">mol</span><span class="p">(</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SmilesToMol</span><span class="p">(</span> <span class="s">&quot;C1OC1&quot;</span> <span class="p">)</span> <span class="p">);</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">ROMol</span><span class="o">::</span><span class="n">VERTEX_ITER</span> <span class="n">it</span> <span class="p">,</span> <span class="n">end</span><span class="p">;</span>
<span class="n">boost</span><span class="o">::</span><span class="n">tie</span><span class="p">(</span> <span class="n">it</span> <span class="p">,</span> <span class="n">end</span> <span class="p">)</span> <span class="o">=</span> <span class="n">mol</span><span class="o">-&gt;</span><span class="n">getVertices</span><span class="p">();</span>
<span class="k">while</span><span class="p">(</span> <span class="n">it</span> <span class="o">!=</span> <span class="n">end</span> <span class="p">)</span> <span class="p">{</span>
  <span class="k">const</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">Atom</span> <span class="o">*</span><span class="n">atom</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="n">mol</span><span class="p">)[</span><span class="o">*</span><span class="n">it</span><span class="p">].</span><span class="n">get</span><span class="p">();</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">atom</span><span class="o">-&gt;</span><span class="n">getAtomicNum</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="o">++</span><span class="n">it</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>gives</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">6</span> <span class="mi">8</span> <span class="mi">6</span>
</pre></div>
</div>
<p>As an alternative, there are AtomIterators and
BondIterators<a class="reference external" href="./C++Examples/example6.cpp">(example6)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;GraphMol/AtomIterators.h&gt;</span><span class="cp"></span>
<span class="p">.</span>
<span class="p">.</span>
<span class="k">for</span><span class="p">(</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">ROMol</span><span class="o">::</span><span class="n">AtomIterator</span> <span class="n">ai</span> <span class="o">=</span> <span class="n">mol</span><span class="o">-&gt;</span><span class="n">beginAtoms</span><span class="p">()</span> <span class="p">;</span> <span class="n">ai</span> <span class="o">!=</span> <span class="n">mol</span><span class="o">-&gt;</span><span class="n">endAtoms</span><span class="p">()</span> <span class="p">;</span> <span class="o">++</span><span class="n">ai</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="o">*</span><span class="n">ai</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">getAtomicNum</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; &quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>   
</pre></div>
</div>
<p>which is functionally equivalent to the above.
Finally, there’s a method that uses the fact that atoms and bonds
can be selected by index number
<a class="reference external" href="./C++Examples/example6.cpp">(example6)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="k">for</span><span class="p">(</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">,</span> <span class="n">is</span> <span class="o">=</span> <span class="n">mol</span><span class="o">-&gt;</span><span class="n">getNumAtoms</span><span class="p">()</span> <span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">is</span> <span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span> <span class="p">{</span>
  <span class="k">const</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">Atom</span> <span class="o">*</span><span class="n">atom</span> <span class="o">=</span> <span class="n">mol</span><span class="o">-&gt;</span><span class="n">getAtomWithIdx</span><span class="p">(</span> <span class="n">i</span> <span class="p">);</span> 
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">atom</span><span class="o">-&gt;</span><span class="n">getAtomicNum</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Likewise with bonds <a class="reference external" href="./C++Examples/example6.cpp">(example6)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="n">RDKit</span><span class="o">::</span><span class="n">ROMol</span><span class="o">::</span><span class="n">EDGE_ITER</span> <span class="n">bond_it</span> <span class="p">,</span> <span class="n">bond_end</span><span class="p">;</span>
<span class="n">boost</span><span class="o">::</span><span class="n">tie</span><span class="p">(</span> <span class="n">bond_it</span> <span class="p">,</span> <span class="n">bond_end</span> <span class="p">)</span> <span class="o">=</span> <span class="n">mol</span><span class="o">-&gt;</span><span class="n">getEdges</span><span class="p">();</span>
<span class="k">while</span><span class="p">(</span> <span class="n">bond_it</span> <span class="o">!=</span> <span class="n">bond_end</span> <span class="p">)</span> <span class="p">{</span>
  <span class="k">const</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">Bond</span> <span class="o">*</span><span class="n">bond</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="n">mol</span><span class="p">)[</span><span class="o">*</span><span class="n">bond_it</span><span class="p">].</span><span class="n">get</span><span class="p">();</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">bond</span><span class="o">-&gt;</span><span class="n">getBondType</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="o">++</span><span class="n">bond_it</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">for</span><span class="p">(</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">,</span> <span class="n">is</span> <span class="o">=</span> <span class="n">mol</span><span class="o">-&gt;</span><span class="n">getNumBonds</span><span class="p">()</span> <span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">is</span> <span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span> <span class="p">{</span>
  <span class="k">const</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">Bond</span> <span class="o">*</span><span class="n">bond</span> <span class="o">=</span> <span class="n">mol</span><span class="o">-&gt;</span><span class="n">getBondWithIdx</span><span class="p">(</span> <span class="n">i</span> <span class="p">);</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">bond</span><span class="o">-&gt;</span><span class="n">getIsAromatic</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>gives</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
</pre></div>
</div>
<p>A bond can be specified by the atoms at its ends, with
a NULL pointer being returned if there isn’t one <a class="reference external" href="./C++Examples/example6.cpp">(example6)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="n">RDKit</span><span class="o">::</span><span class="n">ROMOL_SPTR</span> <span class="n">mol2</span><span class="p">(</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SmilesToMol</span><span class="p">(</span> <span class="s">&quot;C1OC1Cl&quot;</span> <span class="p">)</span> <span class="p">);</span>
<span class="k">const</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">Bond</span> <span class="o">*</span><span class="n">bond</span> <span class="o">=</span> <span class="n">mol2</span><span class="o">-&gt;</span><span class="n">getBondBetweenAtoms</span><span class="p">(</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">1</span> <span class="p">);</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">bond</span><span class="o">-&gt;</span><span class="n">getBeginAtomIdx</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; to &quot;</span>
          <span class="o">&lt;&lt;</span> <span class="n">bond</span><span class="o">-&gt;</span><span class="n">getBeginAtomIdx</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; is &quot;</span>
          <span class="o">&lt;&lt;</span> <span class="n">bond</span><span class="o">-&gt;</span><span class="n">getBondType</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="n">mol2</span><span class="o">-&gt;</span><span class="n">getBondBetweenAtoms</span><span class="p">(</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">3</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;No bond between 0 and 3&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The neighbours of an atom can also be extracted, but note that you
need an ADJ_ITER rather than a VERTEX_ITER <a class="reference external" href="./C++Examples/example6.cpp">(example6)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="k">const</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">Atom</span> <span class="o">*</span><span class="n">atom</span> <span class="o">=</span> <span class="n">mol2</span><span class="o">-&gt;</span><span class="n">getAtomWithIdx</span><span class="p">(</span> <span class="mi">2</span> <span class="p">);</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">ROMol</span><span class="o">::</span><span class="n">ADJ_ITER</span> <span class="n">nbr</span> <span class="p">,</span> <span class="n">end_nbr</span><span class="p">;</span>
<span class="n">boost</span><span class="o">::</span><span class="n">tie</span><span class="p">(</span> <span class="n">nbr</span> <span class="p">,</span> <span class="n">end_nbr</span> <span class="p">)</span> <span class="o">=</span> <span class="n">mol2</span><span class="o">-&gt;</span><span class="n">getAtomNeighbors</span><span class="p">(</span> <span class="n">atom</span> <span class="p">);</span>
<span class="k">while</span><span class="p">(</span> <span class="n">nbr</span> <span class="o">!=</span> <span class="n">end_nbr</span> <span class="p">)</span> <span class="p">{</span>
  <span class="k">const</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">Atom</span> <span class="o">*</span><span class="n">nbr_atom</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="n">mol2</span><span class="p">)[</span><span class="o">*</span><span class="n">nbr</span><span class="p">].</span><span class="n">get</span><span class="p">();</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">nbr_atom</span><span class="o">-&gt;</span><span class="n">getIdx</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; : &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">nbr_atom</span><span class="o">-&gt;</span><span class="n">getAtomicNum</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="o">++</span><span class="n">nbr</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>gives</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="p">:</span> <span class="mi">8</span>
<span class="mi">3</span> <span class="p">:</span> <span class="mi">17</span>
<span class="mi">0</span> <span class="p">:</span> <span class="mi">6</span>
</pre></div>
</div>
</div>
<div class="section" id="ring-information">
<span id="ring-information"></span><h3>Ring Information<a class="headerlink" href="#ring-information" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>It is relatively easy to obtain ring information for atoms and bonds
<a class="reference external" href="./C++Examples/example7.cpp">(example7)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;GraphMol/MolOps.h&gt;</span><span class="cp"></span>
<span class="p">.</span>
<span class="p">.</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">ROMOL_SPTR</span> <span class="n">mol</span><span class="p">(</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SmilesToMol</span><span class="p">(</span> <span class="s">&quot;OC1C2C1CC2&quot;</span> <span class="p">)</span> <span class="p">);</span>

<span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="n">mol</span><span class="o">-&gt;</span><span class="n">getRingInfo</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">isInitialized</span><span class="p">()</span> <span class="p">)</span> <span class="p">{</span>
  <span class="n">RDKit</span><span class="o">::</span><span class="n">MolOps</span><span class="o">::</span><span class="n">findSSSR</span><span class="p">(</span> <span class="o">*</span><span class="n">mol</span> <span class="p">);</span>
<span class="p">}</span>
<span class="k">for</span><span class="p">(</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">,</span> <span class="n">is</span> <span class="o">=</span> <span class="n">mol</span><span class="o">-&gt;</span><span class="n">getNumAtoms</span><span class="p">()</span> <span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">is</span> <span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span> <span class="p">{</span>
  <span class="k">const</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">Atom</span> <span class="o">*</span><span class="n">atom</span> <span class="o">=</span> <span class="n">mol</span><span class="o">-&gt;</span><span class="n">getAtomWithIdx</span><span class="p">(</span> <span class="n">i</span> <span class="p">);</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">mol</span><span class="o">-&gt;</span><span class="n">getRingInfo</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">numAtomRings</span><span class="p">(</span> <span class="n">atom</span><span class="o">-&gt;</span><span class="n">getIdx</span><span class="p">()</span> <span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; &quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

<span class="k">for</span><span class="p">(</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">,</span> <span class="n">is</span> <span class="o">=</span> <span class="n">mol</span><span class="o">-&gt;</span><span class="n">getNumBonds</span><span class="p">()</span> <span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">is</span> <span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span> <span class="p">{</span>
  <span class="k">const</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">Bond</span> <span class="o">*</span><span class="n">bond</span> <span class="o">=</span> <span class="n">mol</span><span class="o">-&gt;</span><span class="n">getBondWithIdx</span><span class="p">(</span> <span class="n">i</span> <span class="p">);</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">mol</span><span class="o">-&gt;</span><span class="n">getRingInfo</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">numBondRings</span><span class="p">(</span> <span class="n">bond</span><span class="o">-&gt;</span><span class="n">getIdx</span><span class="p">()</span> <span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; &quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>gives</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
</pre></div>
</div>
<p>Obviously, findSSSR only needs to be called once for the molecule. If
you only need to know whether the atom or bond is in a ring, just test
whether or not the return value is zero <a class="reference external" href="./C++Examples/example7.cpp">(example7)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="k">const</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">Bond</span> <span class="o">*</span><span class="n">bond</span> <span class="o">=</span> <span class="n">mol</span><span class="o">-&gt;</span><span class="n">getBondWithIdx</span><span class="p">(</span> <span class="mi">1</span> <span class="p">);</span>
<span class="k">if</span><span class="p">(</span> <span class="n">mol</span><span class="o">-&gt;</span><span class="n">getRingInfo</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">numBondRings</span><span class="p">(</span> <span class="n">bond</span><span class="o">-&gt;</span><span class="n">getIdx</span><span class="p">()</span> <span class="p">))</span> <span class="p">{</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span>  <span class="s">&quot;Bond &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">bond</span><span class="o">-&gt;</span><span class="n">getIdx</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; is in a ring&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>gives</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Bond</span> <span class="mi">1</span> <span class="ow">is</span> <span class="ow">in</span> <span class="n">a</span> <span class="n">ring</span>
</pre></div>
</div>
<p>Other information about presence in smallest rings can also be
obtained from the RingInfo object of the molecule <a class="reference external" href="./C++Examples/example7.cpp">(example7)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Atom 2 is in ring of size 3 : &quot;</span>
          <span class="o">&lt;&lt;</span> <span class="n">mol</span><span class="o">-&gt;</span><span class="n">getRingInfo</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">isAtomInRingOfSize</span><span class="p">(</span> <span class="mi">2</span> <span class="p">,</span> <span class="mi">3</span> <span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Atom 2 is in ring of size 4 : &quot;</span>
          <span class="o">&lt;&lt;</span> <span class="n">mol</span><span class="o">-&gt;</span><span class="n">getRingInfo</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">isAtomInRingOfSize</span><span class="p">(</span> <span class="mi">2</span> <span class="p">,</span> <span class="mi">4</span> <span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Atom 2 is in ring of size 5 : &quot;</span>
          <span class="o">&lt;&lt;</span> <span class="n">mol</span><span class="o">-&gt;</span><span class="n">getRingInfo</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">isAtomInRingOfSize</span><span class="p">(</span> <span class="mi">2</span> <span class="p">,</span> <span class="mi">5</span> <span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Bond 1 is in ring of size 3 : &quot;</span>
          <span class="o">&lt;&lt;</span> <span class="n">mol</span><span class="o">-&gt;</span><span class="n">getRingInfo</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">isBondInRingOfSize</span><span class="p">(</span> <span class="mi">1</span> <span class="p">,</span> <span class="mi">3</span> <span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>gives</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Atom</span> <span class="mi">2</span> <span class="ow">is</span> <span class="ow">in</span> <span class="n">ring</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">3</span> <span class="p">:</span> <span class="mi">1</span>
<span class="n">Atom</span> <span class="mi">2</span> <span class="ow">is</span> <span class="ow">in</span> <span class="n">ring</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">4</span> <span class="p">:</span> <span class="mi">1</span>
<span class="n">Atom</span> <span class="mi">2</span> <span class="ow">is</span> <span class="ow">in</span> <span class="n">ring</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">5</span> <span class="p">:</span> <span class="mi">0</span>
<span class="n">Bond</span> <span class="mi">1</span> <span class="ow">is</span> <span class="ow">in</span> <span class="n">ring</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">3</span> <span class="p">:</span> <span class="mi">1</span>
</pre></div>
</div>
<p>More detail about the smallest set of smallest rings (SSSR) is
available <a class="reference external" href="./C++Examples/example7.cpp">(example7)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="n">RDKit</span><span class="o">::</span><span class="n">VECT_INT_VECT</span> <span class="n">rings</span><span class="p">;</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">MolOps</span><span class="o">::</span><span class="n">symmetrizeSSSR</span><span class="p">(</span> <span class="o">*</span><span class="n">mol</span> <span class="p">,</span> <span class="n">rings</span> <span class="p">);</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Number of symmetric SSSR rings : &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">rings</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="k">for</span><span class="p">(</span> <span class="k">auto</span> <span class="n">it1</span> <span class="o">=</span> <span class="n">rings</span><span class="p">.</span><span class="n">begin</span><span class="p">()</span> <span class="p">,</span> <span class="n">it1_end</span> <span class="o">=</span> <span class="n">rings</span><span class="p">.</span><span class="n">end</span><span class="p">()</span> <span class="p">;</span> <span class="n">it1</span> <span class="o">!=</span> <span class="n">it1_end</span> <span class="p">;</span> <span class="o">++</span><span class="n">it1</span> <span class="p">)</span> <span class="p">{</span>
  <span class="k">for</span><span class="p">(</span> <span class="k">auto</span> <span class="n">it2</span> <span class="o">=</span> <span class="n">it1</span><span class="o">-&gt;</span><span class="n">begin</span><span class="p">()</span> <span class="p">,</span> <span class="n">it2_end</span> <span class="o">=</span> <span class="n">it1</span><span class="o">-&gt;</span><span class="n">end</span><span class="p">()</span> <span class="p">;</span> <span class="n">it2</span> <span class="o">!=</span> <span class="n">it2_end</span> <span class="p">;</span> <span class="o">++</span><span class="n">it2</span> <span class="p">)</span> <span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="o">*</span><span class="n">it2</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; &quot;</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>gives</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Number</span> <span class="n">of</span> <span class="n">symmetric</span> <span class="n">SSSR</span> <span class="n">rings</span> <span class="p">:</span> <span class="mi">2</span>
<span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> 
<span class="mi">4</span> <span class="mi">5</span> <span class="mi">2</span> <span class="mi">3</span>
</pre></div>
</div>
<p>As the name suggests, this is a symmetrized SSSR; if you are
interested in the number of 「true」 SSSR, use the <code class="docutils literal"><span class="pre">findSSSR</span></code> function
<a class="reference external" href="./C++Examples/example7.cpp">(example7)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Number of SSSR rings : &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">MolOps</span><span class="o">::</span><span class="n">findSSSR</span><span class="p">(</span> <span class="o">*</span><span class="n">mol</span> <span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>gives</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">2</span>
</pre></div>
</div>
<p>The distinction between symmetrized and non-symmetrized SSSR is
discussed in more detail below in the section
<a class="reference external" href="#TheSSSRProblem">The SSSR Problem</a>.</p>
</div>
<div class="section" id="modifying-molecules">
<span id="modifying-molecules"></span><h3>Modifying molecules<a class="headerlink" href="#modifying-molecules" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Normally molecules are stored in the RDKit with the hydrogen atoms
implicit (i.e. not explicitly present in the molecular graph).  When
it is useful to have the hydrogens explicitly present, for example
when generating or optimizing the 3D geometry, the
<code class="docutils literal"><span class="pre">RDKit::MolOps::addHs</span></code> function can be used
<a class="reference external" href="./C++Examples/example8.cpp">(example8)</a>.</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="n">RDKit</span><span class="o">::</span><span class="n">ROMOL_SPTR</span> <span class="n">mol1</span><span class="p">(</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SmilesToMol</span><span class="p">(</span> <span class="s">&quot;CCO&quot;</span> <span class="p">)</span> <span class="p">);</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Number of atoms : &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">mol1</span><span class="o">-&gt;</span><span class="n">getNumAtoms</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">ROMOL_SPTR</span> <span class="n">mol2</span><span class="p">(</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">MolOps</span><span class="o">::</span><span class="n">addHs</span><span class="p">(</span> <span class="o">*</span><span class="n">mol1</span> <span class="p">)</span> <span class="p">);</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Number of atoms : &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">mol2</span><span class="o">-&gt;</span><span class="n">getNumAtoms</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>gives</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Number</span> <span class="n">of</span> <span class="n">atoms</span> <span class="p">:</span> <span class="mi">3</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">atoms</span> <span class="p">:</span> <span class="mi">9</span>
</pre></div>
</div>
<p>Recall that there are two versions of <code class="docutils literal"><span class="pre">RDKit::MolOps::addHs</span></code>, as
described <a class="reference external" href="#twoAddHs">above</a>.
The Hs can be removed again using the <code class="docutils literal"><span class="pre">RDKit::MolOps::RemoveHs</span></code>
function, which again has two forms
<a class="reference external" href="./C++Examples/example8.cpp">(example8)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="n">RDKit</span><span class="o">::</span><span class="n">RWMOL_SPTR</span> <span class="n">mol3</span><span class="p">(</span> <span class="k">new</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">RWMol</span><span class="p">(</span> <span class="o">*</span><span class="n">mol2</span> <span class="p">)</span> <span class="p">);</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">MolOps</span><span class="o">::</span><span class="n">removeHs</span><span class="p">(</span> <span class="o">*</span><span class="n">mol3</span> <span class="p">);</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Number of atoms : &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">mol3</span><span class="o">-&gt;</span><span class="n">getNumAtoms</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>which returns the atom count to 3.</p>
<p>RDKit molecules are usually stored with the bonds in aromatic rings
having aromatic bond types. This can be changed with the
<code class="docutils literal"><span class="pre">RDKit::MolOps::Kekulize</span></code> function, which must be called with an RWMol
<a class="reference external" href="./C++Examples/example9.cpp">(example9)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="n">RDKit</span><span class="o">::</span><span class="n">RWMOL_SPTR</span> <span class="n">mol</span><span class="p">(</span> <span class="k">new</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">RWMol</span><span class="p">(</span> <span class="o">*</span><span class="n">RDKit</span><span class="o">::</span><span class="n">SmilesToMol</span><span class="p">(</span> <span class="s">&quot;c1ccccc1&quot;</span> <span class="p">)</span> <span class="p">)</span> <span class="p">);</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Order : &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">mol</span><span class="o">-&gt;</span><span class="n">getBondWithIdx</span><span class="p">(</span> <span class="mi">0</span> <span class="p">)</span><span class="o">-&gt;</span><span class="n">getBondType</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Aromatic : &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">mol</span><span class="o">-&gt;</span><span class="n">getBondWithIdx</span><span class="p">(</span> <span class="mi">0</span> <span class="p">)</span><span class="o">-&gt;</span><span class="n">getIsAromatic</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

<span class="n">RDKit</span><span class="o">::</span><span class="n">MolOps</span><span class="o">::</span><span class="n">Kekulize</span><span class="p">(</span> <span class="o">*</span><span class="n">mol</span> <span class="p">);</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;After default Kekulize : Order : &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">mol</span><span class="o">-&gt;</span><span class="n">getBondWithIdx</span><span class="p">(</span> <span class="mi">0</span> <span class="p">)</span><span class="o">-&gt;</span><span class="n">getBondType</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;After default Kekulize : Aromatic : &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">mol</span><span class="o">-&gt;</span><span class="n">getBondWithIdx</span><span class="p">(</span> <span class="mi">0</span> <span class="p">)</span><span class="o">-&gt;</span><span class="n">getIsAromatic</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>gives</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Order</span> <span class="p">:</span> <span class="mi">12</span>
<span class="n">Aromatic</span> <span class="p">:</span> <span class="mi">1</span>
<span class="n">After</span> <span class="n">default</span> <span class="n">Kekulize</span> <span class="p">:</span> <span class="n">Order</span> <span class="p">:</span> <span class="mi">2</span>
<span class="n">After</span> <span class="n">default</span> <span class="n">Kekulize</span> <span class="p">:</span> <span class="n">Aromatic</span> <span class="p">:</span> <span class="mi">0</span>
</pre></div>
</div>
<p>The bond orders are defined as the enum BondType in
<a class="reference external" href="../../Code/GraphMol/Bond.h">Bond.h</a>, and an aromatic bond
currently has the value 12.
Note that by default the Kekulize function clears the aromatic flags
on the atoms and bonds. <strong>This is in contrast to the Python version of
Kekulize, which preserves the flags by default.</strong>  The behaviour can be
forced explicitly <a class="reference external" href="./C++Examples/example9.cpp">(example9.cpp)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="n">RDKit</span><span class="o">::</span><span class="n">RWMOL_SPTR</span> <span class="n">mol1</span><span class="p">(</span> <span class="k">new</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">RWMol</span><span class="p">(</span> <span class="o">*</span><span class="n">RDKit</span><span class="o">::</span><span class="n">SmilesToMol</span><span class="p">(</span> <span class="s">&quot;c1ccccc1&quot;</span> <span class="p">)</span> <span class="p">)</span> <span class="p">);</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">MolOps</span><span class="o">::</span><span class="n">Kekulize</span><span class="p">(</span> <span class="o">*</span><span class="n">mol1</span> <span class="p">,</span> <span class="nb">false</span> <span class="p">);</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;After Kekulize, markAtomsBonds false : Aromatic : &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">mol1</span><span class="o">-&gt;</span><span class="n">getBondWithIdx</span><span class="p">(</span> <span class="mi">0</span> <span class="p">)</span><span class="o">-&gt;</span><span class="n">getIsAromatic</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

<span class="n">RDKit</span><span class="o">::</span><span class="n">RWMOL_SPTR</span> <span class="n">mol2</span><span class="p">(</span> <span class="k">new</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">RWMol</span><span class="p">(</span> <span class="o">*</span><span class="n">RDKit</span><span class="o">::</span><span class="n">SmilesToMol</span><span class="p">(</span> <span class="s">&quot;c1ccccc1&quot;</span> <span class="p">)</span> <span class="p">)</span> <span class="p">);</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">MolOps</span><span class="o">::</span><span class="n">Kekulize</span><span class="p">(</span> <span class="o">*</span><span class="n">mol2</span> <span class="p">,</span> <span class="nb">true</span> <span class="p">);</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;After Kekulize, markAtomsBonds true : Aromatic : &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">mol2</span><span class="o">-&gt;</span><span class="n">getBondWithIdx</span><span class="p">(</span> <span class="mi">0</span> <span class="p">)</span><span class="o">-&gt;</span><span class="n">getIsAromatic</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>gives</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">After</span> <span class="n">Kekulize</span><span class="p">,</span> <span class="n">markAtomsBonds</span> <span class="n">false</span> <span class="p">:</span> <span class="n">Aromatic</span> <span class="p">:</span> <span class="mi">1</span>
<span class="n">After</span> <span class="n">Kekulize</span><span class="p">,</span> <span class="n">markAtomsBonds</span> <span class="n">true</span> <span class="p">:</span> <span class="n">Aromatic</span> <span class="p">:</span> <span class="mi">0</span>
</pre></div>
</div>
<p>Bonds can be restored to the aromatic bond type using the
<code class="docutils literal"><span class="pre">RDKit::MolOps::sanitizeMol</span></code> function:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="n">RDKit</span><span class="o">::</span><span class="n">MolOps</span><span class="o">::</span><span class="n">sanitizeMol</span><span class="p">(</span> <span class="o">*</span><span class="n">mol</span> <span class="p">);</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Order : &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">mol</span><span class="o">-&gt;</span><span class="n">getBondWithIdx</span><span class="p">(</span> <span class="mi">0</span> <span class="p">)</span><span class="o">-&gt;</span><span class="n">getBondType</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Aromatic : &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">mol</span><span class="o">-&gt;</span><span class="n">getBondWithIdx</span><span class="p">(</span> <span class="mi">0</span> <span class="p">)</span><span class="o">-&gt;</span><span class="n">getIsAromatic</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>gives</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Order</span> <span class="p">:</span> <span class="mi">12</span>
<span class="n">Aromatic</span> <span class="p">:</span> <span class="mi">1</span>
</pre></div>
</div>
<p>once more.</p>
</div>
<div class="section" id="working-with-2d-molecules-generating-depictions">
<span id="working-with-2d-molecules-generating-depictions"></span><h3>Working with 2D molecules: Generating Depictions<a class="headerlink" href="#working-with-2d-molecules-generating-depictions" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>The RDKit has a library for generating depictions (sets of 2D
coordinates) for molecules.  This library, which is part of the
RDDepict namespace, is accessed via the <code class="docutils literal"><span class="pre">RDDepict::Compute2DCoords</span></code>
function <a class="reference external" href="./C++Examples/example10.cpp">(example10.cpp)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;GraphMol/Depictor/RDDepictor.h&gt;</span><span class="cp"></span>
<span class="p">.</span>
<span class="p">.</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">RWMOL_SPTR</span> <span class="n">mol</span><span class="p">(</span> <span class="k">new</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">RWMol</span><span class="p">(</span> <span class="o">*</span><span class="n">RDKit</span><span class="o">::</span><span class="n">SmilesToMol</span><span class="p">(</span> <span class="s">&quot;c1nccc2n1ccc2&quot;</span> <span class="p">)</span> <span class="p">)</span> <span class="p">);</span>
<span class="n">RDDepict</span><span class="o">::</span><span class="n">compute2DCoords</span><span class="p">(</span> <span class="o">*</span><span class="n">mol</span> <span class="p">);</span>
</pre></div>
</div>
<p>The 2D conformation is constructed to minimize intramolecular clashes,
i.e. to maximize the clarity of the drawing.  Unlike the Python
equivalent, the depiction is not placed in a canonical orientation by
default. This can be forced by passing <code class="docutils literal"><span class="pre">true</span></code> as the third parameter
<a class="reference external" href="./C++Examples/example10.cpp">(example10.cpp)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;Geometry/point.h&gt;</span><span class="cp"></span>
<span class="p">.</span>
<span class="p">.</span>
<span class="n">RDDepict</span><span class="o">::</span><span class="n">compute2DCoords</span><span class="p">(</span> <span class="o">*</span><span class="n">mol</span> <span class="p">,</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="n">RDGeom</span><span class="o">::</span><span class="n">INT_POINT2D_MAP</span> <span class="o">*&gt;</span><span class="p">(</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">,</span> <span class="nb">true</span> <span class="p">);</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">point.h</span></code> must be included for the typedef that defines
<code class="docutils literal"><span class="pre">INT_POINT2D_MAP</span></code>, of which more later.
By default, all existing conformations are removed when the 2D
coordinates are created.  This can be changed by passing false as a
4th parameter.  The 2D coordinates are added as another conformation
of the molecule so it’s a bit tricky combining them both in the same
molecule, and probably best avoided.</p>
<p>The Python API has a convenience function
<code class="docutils literal"><span class="pre">GenerateDepictionMatching2DStructure</span></code> which forces the 2D coordinate
generation to orientate molecules according to a template structure.
A C++ version of the function, generateDepictionMatching2DStructure
was included in late December 2016.  If that is later than the version
of RDKit you are using, then the effect can be achieved thus:
<a class="reference external" href="./C++Examples/example10.cpp">(example10.cpp)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;GraphMol/Substruct/SubstructMatch.h&gt;</span><span class="cp"></span>
<span class="p">.</span>
<span class="p">.</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">ROMol</span> <span class="o">*</span><span class="n">templ</span> <span class="o">=</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SmilesToMol</span><span class="p">(</span> <span class="s">&quot;c1nccc2n1ccc2&quot;</span> <span class="p">);</span>
<span class="n">RDDepict</span><span class="o">::</span><span class="n">compute2DCoords</span><span class="p">(</span> <span class="o">*</span><span class="n">templ</span> <span class="p">);</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">ROMol</span> <span class="o">*</span><span class="n">mol1</span> <span class="o">=</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SmilesToMol</span><span class="p">(</span> <span class="s">&quot;c1cccc2ncn3cccc3c21&quot;</span> <span class="p">);</span>

<span class="n">RDKit</span><span class="o">::</span><span class="n">MatchVectType</span> <span class="n">matchVect</span><span class="p">;</span>
<span class="k">if</span><span class="p">(</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SubstructMatch</span><span class="p">(</span> <span class="o">*</span><span class="n">mol1</span> <span class="p">,</span> <span class="o">*</span><span class="n">templ</span> <span class="p">,</span> <span class="n">matchVect</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
  <span class="n">RDKit</span><span class="o">::</span><span class="n">Conformer</span> <span class="o">&amp;</span><span class="n">conf</span> <span class="o">=</span> <span class="n">templ</span><span class="o">-&gt;</span><span class="n">getConformer</span><span class="p">();</span>
  <span class="n">RDGeom</span><span class="o">::</span><span class="n">INT_POINT2D_MAP</span> <span class="n">coordMap</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">MatchVectType</span><span class="o">::</span><span class="n">const_iterator</span> <span class="n">mv</span> <span class="o">=</span> <span class="n">matchVect</span><span class="p">.</span><span class="n">begin</span><span class="p">()</span> <span class="p">;</span> <span class="n">mv</span> <span class="o">!=</span> <span class="n">matchVect</span><span class="p">.</span><span class="n">end</span><span class="p">()</span> <span class="p">;</span> <span class="o">++</span><span class="n">mv</span> <span class="p">)</span> <span class="p">{</span>
    <span class="n">RDGeom</span><span class="o">::</span><span class="n">Point3D</span> <span class="n">pt3</span> <span class="o">=</span> <span class="n">conf</span><span class="p">.</span><span class="n">getAtomPos</span><span class="p">(</span> <span class="n">mv</span><span class="o">-&gt;</span><span class="n">first</span> <span class="p">);</span>
    <span class="n">RDGeom</span><span class="o">::</span><span class="n">Point2D</span> <span class="n">pt2</span><span class="p">(</span> <span class="n">pt3</span><span class="p">.</span><span class="n">x</span> <span class="p">,</span> <span class="n">pt3</span><span class="p">.</span><span class="n">y</span> <span class="p">);</span>
    <span class="n">coordMap</span><span class="p">[</span><span class="n">mv</span><span class="o">-&gt;</span><span class="n">second</span><span class="p">]</span> <span class="o">=</span> <span class="n">pt2</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">RDDepict</span><span class="o">::</span><span class="n">compute2DCoords</span><span class="p">(</span> <span class="o">*</span><span class="n">mol1</span> <span class="p">,</span> <span class="o">&amp;</span><span class="n">coordMap</span> <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Here, <code class="docutils literal"><span class="pre">coordMap</span></code> maps the coordinates of atoms in the target
molecule templ onto corresponding atoms in the reference molecule.</p>
<p>It is also possible to produce a 2D picture that attempts to mimic as
closely as possible a 3D conformation.  Again, an equivalent of the
Python function
<code class="docutils literal"><span class="pre">rdkit.Chem.AllChem.GenerateDepictionMatching3DStructure</span></code> was
incorporated in December 2016.</p>
</div>
<div class="section" id="working-with-3d-molecules">
<span id="working-with-3d-molecules"></span><h3>Working with 3D Molecules<a class="headerlink" href="#working-with-3d-molecules" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>The RDKit can generate conformations for molecules using two different
methods.  The original method uses distance geometry <a class="reference external" href="#blaney">[1]</a>.
The algorithm followed is:</p>
<ol class="simple">
<li>The molecule’s distance bounds matrix is calculated based on the
connection table and a set of rules.</li>
<li>The bounds matrix is smoothed using a triangle-bounds smoothing
algorithm.</li>
<li>A random distance matrix that satisfies the bounds matrix is
generated.</li>
<li>This distance matrix is embedded in 3D dimensions (producing
coordinates for each atom).</li>
<li>The resulting coordinates are cleaned up somewhat using a crude
force field and the bounds matrix.</li>
</ol>
<p>Note that the conformations that result from this procedure tend to be
fairly ugly. They should be cleaned up using a force field.
This can be done within the RDKit using its implementation of the
Universal Force Field UFF<a class="reference external" href="#rappe">[2]</a>.</p>
<p>More recently, there is an implementation of the method of Riniker and
Landrum <a class="reference external" href="#riniker2">[3]</a> which uses torsion angle preferences from the
Cambridge Structural Database (CSD) to correct the conformers after
distance geometry has been used to generate them.  With this method,
there should be no need to use a minimisation step to clean up the
structures; indeed, it is often undesirable as it may move the
torsions away from the CSD-based distributions, somewhat negating the
point.</p>
<p>The full process of embedding and optimizing a molecule is easier than
all the above verbiage makes it sound
<a class="reference external" href="./C++Examples/example11.cpp">(example11.cpp)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;GraphMol/DistGeomHelpers/Embedder.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;GraphMol/ForceFieldHelpers/UFF/UFF.h&gt;</span><span class="cp"></span>
<span class="p">.</span>
<span class="p">.</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">ROMOL_SPTR</span> <span class="n">mol</span><span class="p">(</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SmilesToMol</span><span class="p">(</span> <span class="s">&quot;C1CCC1OC&quot;</span> <span class="p">)</span> <span class="p">);</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">ROMOL_SPTR</span> <span class="n">mol1</span><span class="p">(</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">MolOps</span><span class="o">::</span><span class="n">addHs</span><span class="p">(</span> <span class="o">*</span><span class="n">mol</span> <span class="p">)</span> <span class="p">);</span>
<span class="c1">// Original distance geometry embedding</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">DGeomHelpers</span><span class="o">::</span><span class="n">EmbedMolecule</span><span class="p">(</span> <span class="o">*</span><span class="n">mol1</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">1234</span> <span class="p">);</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">UFF</span><span class="o">::</span><span class="n">UFFOptimizeMolecule</span><span class="p">(</span> <span class="o">*</span><span class="n">mol1</span> <span class="p">);</span>

<span class="c1">// new Riniker and Landrum CSD-based method</span>
<span class="c1">// using the parameters class</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">DGeomHelpers</span><span class="o">::</span><span class="n">EmbedParameters</span> <span class="n">params</span><span class="p">(</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">DGeomHelpers</span><span class="o">::</span><span class="n">ETKDG</span> <span class="p">);</span>
<span class="n">params</span><span class="p">.</span><span class="n">randomSeed</span> <span class="o">=</span> <span class="mi">1234</span><span class="p">;</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">DGeomHelpers</span><span class="o">::</span><span class="n">EmbedMolecule</span><span class="p">(</span> <span class="o">*</span><span class="n">mol2</span> <span class="p">,</span> <span class="n">params</span> <span class="p">);</span>
</pre></div>
</div>
<p>The Riniker and Landrum method has a number of parameters that may be
altered for various reasons beyond the scope of this document. One
that you may want to alter is the random number seed; setting the
random number seed to other than the default -1 ensures that the same
conformations are produced each time the code is run.  This is
convenient when testing to ensure reproducibility of results.  To make
it easier to vary the parameters, there is the EmbedParameters class
which is initialised to the default values on construction, and whose
individual values can be varied as desired.</p>
<p>The RDKit also has an implementation of the MMFF94 force field
available <a class="reference external" href="#mmff1">[4]</a>, <a class="reference external" href="#mmff2">[5]</a>, <a class="reference external" href="#mmff3">[6]</a>,
<a class="reference external" href="#mmff4">[7]</a>, <a class="reference external" href="#mmffs">[8]</a>.
<a class="reference external" href="./C++Examples/example11.cpp">(example11.cpp)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;GraphMol/ForceFieldHelpers/MMFF/MMFF.h&gt;</span><span class="cp"></span>
<span class="p">.</span>
<span class="p">.</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">MMFF</span><span class="o">::</span><span class="n">MMFFOptimizeMolecule</span><span class="p">(</span> <span class="o">*</span><span class="n">mol2</span> <span class="p">,</span> <span class="mi">1000</span> <span class="p">,</span> <span class="s">&quot;MMFF94s&quot;</span> <span class="p">);</span>
</pre></div>
</div>
<p>Please note that the MMFF atom typing code uses its own aromaticity model,
so the aromaticity flags of the molecule will be modified after calling
MMFF-related methods.
Note the calls to <code class="docutils literal"><span class="pre">RDKit::MolOps::addHs()</span></code> in the examples above. By
default RDKit molecules do not have H atoms explicitly present in the
graph, but they are important for getting realistic geometries, so
they generally should be added.  They can always be removed afterwards
if necessary with a call to <code class="docutils literal"><span class="pre">RDKit::MolOps::removeHs()</span></code></p>
<p>With the RDKit, multiple conformers can also be generated using the two
different embedding methods. In both cases this is simply a matter of
running the distance geometry calculation multiple times from
different random start points. The 2nd parameter to
<code class="docutils literal"><span class="pre">EmbedMultipleConfs</span></code> allows the user to
set the number of conformers that should be generated.  Otherwise the
procedures are similar to before
<a class="reference external" href="./C++Examples/example11.cpp">(example11.cpp)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="n">RDKit</span><span class="o">::</span><span class="n">INT_VECT</span> <span class="n">mol1_cids</span> <span class="o">=</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">DGeomHelpers</span><span class="o">::</span><span class="n">EmbedMultipleConfs</span><span class="p">(</span> <span class="o">*</span><span class="n">mol1</span> <span class="p">,</span> <span class="mi">10</span> <span class="p">);</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Number of conformations : &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">mol1_cids</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

<span class="n">RDKit</span><span class="o">::</span><span class="n">INT_VECT</span> <span class="n">mol2_cids</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">numConfs</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">DGeomHelpers</span><span class="o">::</span><span class="n">EmbedMultipleConfs</span><span class="p">(</span> <span class="o">*</span><span class="n">mol2</span> <span class="p">,</span> <span class="n">mol2_cids</span> <span class="p">,</span> <span class="n">numConfs</span> <span class="p">,</span> <span class="n">params</span> <span class="p">);</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Number of conformations : &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">mol2_cids</span><span class="p">.</span><span class="n">size</span><span class="p">()</span>
          <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>The conformer ids are returned in <code class="docutils literal"><span class="pre">mol1_cids</span></code> and <code class="docutils literal"><span class="pre">mol2_cids</span></code> and
there are two overloaded functions with different ways of supplying
the information.  As before, the CSD-based method is invoked by
EmbedParameters object, and in the example above the default
number of conformations to be produced has been changed from 10 to 20.
The conformers so generated can be aligned
to each other and the RMS values calculated
<a class="reference external" href="./C++Examples/example11.cpp">(example11.cpp)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;GraphMol/MolAlign/AlignMolecules.h&gt;</span><span class="cp"></span>
<span class="p">.</span>
<span class="p">.</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="n">rms_list</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="o">&gt;</span> <span class="n">m2cids</span><span class="p">(</span> <span class="n">mol2_cids</span><span class="p">.</span><span class="n">begin</span><span class="p">()</span> <span class="p">,</span> <span class="n">mol2_cids</span><span class="p">.</span><span class="n">end</span><span class="p">()</span> <span class="p">);</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">MolAlign</span><span class="o">::</span><span class="n">alignMolConformers</span><span class="p">(</span> <span class="o">*</span><span class="n">mol2</span> <span class="p">,</span>
                                     <span class="k">static_cast</span><span class="o">&lt;</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="o">&gt;</span> <span class="o">*&gt;</span><span class="p">(</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">,</span>
                                     <span class="o">&amp;</span><span class="n">m2cids</span> <span class="p">,</span>
                                     <span class="k">static_cast</span><span class="o">&lt;</span><span class="k">const</span> <span class="n">RDNumeric</span><span class="o">::</span><span class="n">DoubleVector</span> <span class="o">*&gt;</span><span class="p">(</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">,</span>
                                     <span class="nb">false</span> <span class="p">,</span> <span class="mi">50</span> <span class="p">,</span> <span class="o">&amp;</span><span class="n">rms_list</span> <span class="p">);</span>
</pre></div>
</div>
<p>The RMS values for the overlays will be fed into rms_list on return.
Note the somewhat inconvenient issue that <code class="docutils literal"><span class="pre">EmbedMultipleConfs</span></code> returns
a vector of <code class="docutils literal"><span class="pre">ints</span></code> for the conformer ids, but <code class="docutils literal"><span class="pre">alignMolConformers</span></code>
requires a vector of <code class="docutils literal"><span class="pre">unsigned</span> <span class="pre">ints</span></code>. The reason for this is that
<code class="docutils literal"><span class="pre">EmbedMultipleConfs</span></code> uses -1 to denote a failed embedding.  The first
vector of <code class="docutils literal"><span class="pre">unsigned</span> <span class="pre">ints</span></code> in the <code class="docutils literal"><span class="pre">alignMolConformers</span></code> declaration is atom ids, and allows
the alignment to be performed on just a subset of atoms which can be
convenient for overlaying a core and seeing how the other bits of the
molecule varied in the different conformations.</p>
<p>There is no C++ equivalent to the Python function
<code class="docutils literal"><span class="pre">AllChem.GetConformerRMS()</span></code> to compute the RMS between two specific
conformers (e.g. 1 and 9) although it is coming.</p>
<p>It is important to remember that unless you specify a random number
seed, you will not necessarily get the same conformations each time
you run the embedding on the same molecule, especially if you only
generate a small number of conformations relative to the number of
torsions in the structure.  If it’s important in your use-case that
you have a good sampling of the conformations including all the
low-energy ones, you should be sure to
specify a large maximum number of conformations.</p>
<p><em>Disclaimer/Warning</em>: Conformation generation is a difficult and
subtle task. The original, default, 2D-&gt;3D conversion provided with
the RDKit is not intended to be a replacement for a “real”
conformational analysis tool; it merely provides quick 3D structures
for cases when they are required. On the other hand, the second
method, when a sufficiently large number of conformers are generated,
should be adequate for most purposes. It is probably better to ignore
the first, historical, method entirely. It is only left as the default
method to avoid breaking existing code.</p>
</div>
<div class="section" id="preserving-molecules">
<span id="preserving-molecules"></span><h3>Preserving Molecules<a class="headerlink" href="#preserving-molecules" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Molecules can be preserved, or serialised, or pickled, using the class
MolPickler in the namespace of the same name:
<a class="reference external" href="./C++Examples/example12.cpp">(example12.cpp)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;GraphMol/MolPickler.h&gt;</span><span class="cp"></span>
<span class="p">.</span>
<span class="p">.</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">ROMol</span> <span class="o">*</span><span class="n">mol1</span> <span class="o">=</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SmilesToMol</span><span class="p">(</span> <span class="s">&quot;c1ccncc1&quot;</span> <span class="p">);</span>
<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">pickle</span><span class="p">;</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">MolPickler</span><span class="o">::</span><span class="n">pickleMol</span><span class="p">(</span> <span class="o">*</span><span class="n">mol1</span> <span class="p">,</span> <span class="n">pickle</span> <span class="p">);</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">ROMol</span> <span class="n">mol2</span><span class="p">;</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">MolPickler</span><span class="o">::</span><span class="n">molFromPickle</span><span class="p">(</span> <span class="n">pickle</span> <span class="p">,</span> <span class="n">mol2</span> <span class="p">);</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">MolToSmiles</span><span class="p">(</span> <span class="n">mol2</span> <span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>Note that the string is in binary format and will appear
as gibberish if printed to a screen. The RDKit pickle format is fairly
compact and it is much, much faster to build a molecule from a pickle
than from a Mol file or SMILES string, so storing pickles of molecules
you will be working with repeatedly can be a good idea:
<a class="reference external" href="./C++Examples/example12.cpp">(example12.cpp)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="c1">// writing to pickle file</span>
<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">smi_file</span> <span class="o">=</span> <span class="n">getenv</span><span class="p">(</span><span class="s">&quot;RDBASE&quot;</span><span class="p">);</span>
<span class="n">smi_file</span> <span class="o">+=</span> <span class="s">&quot;/Code/GraphMol/test_data/canonSmiles.long.smi&quot;</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">pkl_name</span> <span class="o">=</span> <span class="s">&quot;canonSmiles.long.pkl&quot;</span><span class="p">;</span>

<span class="c1">// tab-delimited file, SMILES in column 0, name in 1, no title line</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">SmilesMolSupplier</span> <span class="n">suppl</span><span class="p">(</span> <span class="n">smi_file</span> <span class="p">,</span> <span class="s">&quot;</span><span class="se">\t</span><span class="s">&quot;</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">1</span> <span class="p">,</span> <span class="nb">false</span> <span class="p">);</span>
<span class="n">std</span><span class="o">::</span><span class="n">ofstream</span> <span class="n">pickle_ostream</span><span class="p">(</span> <span class="n">pkl_name</span> <span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">ios_base</span><span class="o">::</span><span class="n">binary</span> <span class="p">);</span>
<span class="kt">int</span> <span class="n">write_cnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">while</span><span class="p">(</span> <span class="o">!</span><span class="n">suppl</span><span class="p">.</span><span class="n">atEnd</span><span class="p">()</span> <span class="p">)</span> <span class="p">{</span>
  <span class="n">RDKit</span><span class="o">::</span><span class="n">ROMol</span> <span class="o">*</span><span class="n">mol</span> <span class="o">=</span> <span class="n">suppl</span><span class="p">.</span><span class="n">next</span><span class="p">();</span>
  <span class="n">RDKit</span><span class="o">::</span><span class="n">MolPickler</span><span class="o">::</span><span class="n">pickleMol</span><span class="p">(</span> <span class="o">*</span><span class="n">mol</span> <span class="p">,</span> <span class="n">pickle_ostream</span> <span class="p">);</span>
  <span class="k">delete</span> <span class="n">mol</span><span class="p">;</span>
  <span class="o">++</span><span class="n">write_cnt</span><span class="p">;</span>
<span class="p">}</span>
<span class="n">pickle_ostream</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>  
<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Wrote &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">write_cnt</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; molecules&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

<span class="c1">// reading from pickle file</span>
<span class="n">std</span><span class="o">::</span><span class="n">ifstream</span> <span class="n">pickle_istream</span><span class="p">(</span> <span class="n">pkl_name</span> <span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">ios_base</span><span class="o">::</span><span class="n">binary</span> <span class="p">);</span>
<span class="kt">int</span> <span class="n">read_cnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">while</span><span class="p">(</span> <span class="o">!</span><span class="n">pickle_istream</span><span class="p">.</span><span class="n">eof</span><span class="p">()</span> <span class="p">)</span> <span class="p">{</span>
  <span class="n">RDKit</span><span class="o">::</span><span class="n">ROMol</span> <span class="n">mol3</span><span class="p">;</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="n">RDKit</span><span class="o">::</span><span class="n">MolPickler</span><span class="o">::</span><span class="n">molFromPickle</span><span class="p">(</span> <span class="n">pickle_istream</span> <span class="p">,</span> <span class="n">mol3</span> <span class="p">);</span>
  <span class="p">}</span> <span class="k">catch</span><span class="p">(</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">MolPicklerException</span> <span class="o">&amp;</span><span class="n">e</span> <span class="p">)</span> <span class="p">{</span>
    <span class="k">break</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="o">++</span><span class="n">read_cnt</span><span class="p">;</span>
<span class="p">}</span>
<span class="n">pickle_istream</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Read &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">read_cnt</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; molecules.&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>However, currently the pickling process does not preserve and
properties attached to the molecule, which included the molecule name
(property 「_Name」). This will change in the 2017.03 release.</p>
</div>
<div class="section" id="drawing-molecules">
<span id="drawing-molecules"></span><h3>Drawing Molecules<a class="headerlink" href="#drawing-molecules" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>The RDKit has some built-in functionality for drawing molecules, found
in the RDKit namespace, with header files in
<code class="docutils literal"><span class="pre">$RDBASE/Code/GraphMol/MolDraw2D</span></code>.  There is an abstract base class
MolDraw2D which defines the interface and does the drawing, with
concrete classes for drawing to SVG or PNG files and Qt and wx
widgets.  Only the SVG output is built by default, Cairo support
requires the argument <code class="docutils literal"><span class="pre">-DRDK_BUILD_CAIRO_SUPPORT=ON</span></code> to cmake, and Qt
support <code class="docutils literal"><span class="pre">-DRDK_BUILD_QT_SUPPORT=ON</span></code>. To create an SVG file:
<a class="reference external" href="./C++Examples/example13.cpp">(example13.cpp)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;GraphMol/MolDraw2D/MolDraw2DSVG.h&gt;</span><span class="cp"></span>
<span class="p">.</span>
<span class="p">.</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">SDMolSupplier</span> <span class="n">mol_supplier</span><span class="p">(</span> <span class="s">&quot;data/cdk2.sdf&quot;</span> <span class="p">,</span> <span class="nb">true</span> <span class="p">);</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">ROMol</span> <span class="o">*</span><span class="n">mol1</span> <span class="o">=</span> <span class="n">mol_supplier</span><span class="p">.</span><span class="n">next</span><span class="p">();</span>
<span class="n">RDDepict</span><span class="o">::</span><span class="n">compute2DCoords</span><span class="p">(</span> <span class="o">*</span><span class="n">mol1</span> <span class="p">);</span>
<span class="n">std</span><span class="o">::</span><span class="n">ofstream</span> <span class="n">outs</span><span class="p">(</span><span class="s">&quot;cdk_mol1.svg&quot;</span><span class="p">);</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">MolDraw2DSVG</span> <span class="n">svg_drawer</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="n">outs</span><span class="p">);</span>
<span class="n">svg_drawer</span><span class="p">.</span><span class="n">drawMolecule</span><span class="p">(</span> <span class="o">*</span><span class="n">mol1</span> <span class="p">);</span>
<span class="n">svg_drawer</span><span class="p">.</span><span class="n">finishDrawing</span><span class="p">();</span>
<span class="n">outs</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>
</pre></div>
</div>
<p>The procedure for a PNG is slightly different:
<a class="reference external" href="./C++Examples/example13.cpp">(example13.cpp)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;GraphMol/MolDraw2D/MolDraw2DSVG.h&gt;</span><span class="cp"></span>
<span class="p">.</span>
<span class="p">.</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">MolDraw2DCairo</span> <span class="n">cairo_drawer</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">);</span>
<span class="n">cairo_drawer</span><span class="p">.</span><span class="n">drawMolecule</span><span class="p">(</span><span class="o">*</span><span class="n">mol1</span><span class="p">);</span>
<span class="n">cairo_drawer</span><span class="p">.</span><span class="n">finishDrawing</span><span class="p">();</span>
<span class="n">cairo_drawer</span><span class="p">.</span><span class="n">writeDrawingText</span><span class="p">(</span><span class="s">&quot;cdk_mol1.png&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>The Python wrapper includes the function <code class="docutils literal"><span class="pre">Chem.MolsToGridImage</span></code>.
There is, as yet, no equivalent in the C++ version although
<code class="docutils literal"><span class="pre">test11DrawMolGrid</span></code> in <code class="docutils literal"><span class="pre">$RDBASE/Code/GraphMol/MolDraw2D/test1.cpp</span></code>
shows that it can be achieved relatively simply.</p>
</div>
<div class="section" id="substructure-searching">
<span id="substructure-searching"></span><h3>Substructure Searching<a class="headerlink" href="#substructure-searching" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Substructure matching can be done using query molecules built from
SMARTS.
<a class="reference external" href="./C++Examples/example14.cpp">(example14.cpp)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;GraphMol/Substruct/SubstructMatch.h&gt;</span><span class="cp"></span>
<span class="p">.</span>
<span class="p">.</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">ROMol</span> <span class="o">*</span><span class="n">mol1</span> <span class="o">=</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SmilesToMol</span><span class="p">(</span> <span class="s">&quot;c1ccccc1O&quot;</span> <span class="p">);</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">RWMol</span> <span class="o">*</span><span class="n">patt</span> <span class="o">=</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SmartsToMol</span><span class="p">(</span> <span class="s">&quot;ccO&quot;</span> <span class="p">);</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">MatchVectType</span> <span class="n">res</span><span class="p">;</span>
<span class="k">if</span><span class="p">(</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SubstructMatch</span><span class="p">(</span> <span class="o">*</span><span class="n">mol1</span> <span class="p">,</span> <span class="o">*</span><span class="n">patt</span> <span class="p">,</span> <span class="n">res</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Pattern matched molecule&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">for</span><span class="p">(</span> <span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">res</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span> <span class="p">{</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;(&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">res</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;,&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">res</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">second</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;) &quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">SubstructMatch</span></code> returns a bool to flag whether there was a match, and
replaces the contents of <code class="docutils literal"><span class="pre">res</span></code> with a mapping of the atom indices in
the pattern and a set of atoms that match in the molecule. In the
above example, the output is:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Pattern</span> <span class="n">matched</span> <span class="n">molecule</span>
<span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)(</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
<p>showing that atoms 0, 5 and 6 in the phenol matched the query. If the
pattern matches multiple times (as in this case, where 4, 5, 6 is also
a match), a single arbitrary set is returned.</p>
<p>All possible matches can also be returned:
<a class="reference external" href="./C++Examples/example14.cpp">(example14.cpp)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">RDKit</span><span class="o">::</span><span class="n">MatchVectType</span><span class="o">&gt;</span> <span class="n">hits_vect</span><span class="p">;</span>
<span class="k">if</span><span class="p">(</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SubstructMatch</span><span class="p">(</span> <span class="o">*</span><span class="n">mol1</span> <span class="p">,</span> <span class="o">*</span><span class="n">patt</span> <span class="p">,</span> <span class="n">hits_vect</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
  <span class="k">for</span><span class="p">(</span> <span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">hits_vect</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span> <span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Match &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; : &quot;</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span> <span class="kt">size_t</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">hits_vect</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">size</span><span class="p">()</span> <span class="p">;</span> <span class="o">++</span><span class="n">j</span> <span class="p">)</span> <span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;(&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">hits_vect</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">].</span><span class="n">first</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;,&quot;</span>
          <span class="o">&lt;&lt;</span> <span class="n">hits_vect</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">].</span><span class="n">second</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;)&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This gives</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Match</span> <span class="mi">1</span> <span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)(</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<span class="n">Match</span> <span class="mi">2</span> <span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">)(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)(</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
<p>It is easy to filter lists of molecules:
<a class="reference external" href="./C++Examples/example14.cpp">(example14.cpp)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="n">RDKit</span><span class="o">::</span><span class="n">SDMolSupplier</span> <span class="n">mol_supplier</span><span class="p">(</span> <span class="s">&quot;data/actives_5ht3.sdf&quot;</span> <span class="p">,</span> <span class="nb">true</span> <span class="p">);</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">RWMol</span> <span class="o">*</span><span class="n">patt1</span> <span class="o">=</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SmartsToMol</span><span class="p">(</span> <span class="s">&quot;c[NH1]&quot;</span> <span class="p">);</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">RDKit</span><span class="o">::</span><span class="n">ROMol</span> <span class="o">*&gt;</span> <span class="n">matches</span><span class="p">;</span>
<span class="k">while</span><span class="p">(</span> <span class="o">!</span><span class="n">mol_supplier</span><span class="p">.</span><span class="n">atEnd</span><span class="p">()</span> <span class="p">)</span> <span class="p">{</span>
  <span class="n">RDKit</span><span class="o">::</span><span class="n">ROMol</span> <span class="o">*</span><span class="n">mol3</span> <span class="o">=</span> <span class="n">mol_supplier</span><span class="p">.</span><span class="n">next</span><span class="p">();</span>
  <span class="k">if</span><span class="p">(</span> <span class="n">mol3</span> <span class="o">&amp;&amp;</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SubstructMatch</span><span class="p">(</span> <span class="o">*</span><span class="n">mol3</span> <span class="p">,</span> <span class="o">*</span><span class="n">patt1</span> <span class="p">,</span> <span class="n">res</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
    <span class="n">matches</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span> <span class="n">mol3</span> <span class="p">);</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">delete</span> <span class="n">mol3</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;There were &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">matches</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; hits in the file.&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>There should be 22 matches in the file.</p>
<p>Substructure matching can also be done using molecules built from
SMILES instead of SMARTS:
<a class="reference external" href="./C++Examples/example14.cpp">(example14.cpp)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="n">RDKit</span><span class="o">::</span><span class="n">ROMol</span> <span class="o">*</span><span class="n">mol4</span> <span class="o">=</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SmilesToMol</span><span class="p">(</span> <span class="s">&quot;C1=CC=CC=C1OC&quot;</span> <span class="p">);</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">RWMol</span> <span class="o">*</span><span class="n">smi_mol1</span> <span class="o">=</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SmilesToMol</span><span class="p">(</span> <span class="s">&quot;CO&quot;</span> <span class="p">);</span>
<span class="k">if</span><span class="p">(</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SubstructMatch</span><span class="p">(</span> <span class="o">*</span><span class="n">mol4</span> <span class="p">,</span> <span class="o">*</span><span class="n">smi_mol1</span> <span class="p">,</span> <span class="n">res</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;SMILES match&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Not SMILES match&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">RWMol</span> <span class="o">*</span><span class="n">smt_mol1</span> <span class="o">=</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SmartsToMol</span><span class="p">(</span> <span class="s">&quot;CO&quot;</span> <span class="p">);</span>
<span class="k">if</span><span class="p">(</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SubstructMatch</span><span class="p">(</span> <span class="o">*</span><span class="n">mol4</span> <span class="p">,</span> <span class="o">*</span><span class="n">smt_mol1</span> <span class="p">,</span> <span class="n">res</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;SMARTS match&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Not SMARTS match&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>But don’t forget that the semantics of the two languages are not
exactly equivalent:
<a class="reference external" href="./C++Examples/example14.cpp">(example14.cpp)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="n">RDKit</span><span class="o">::</span><span class="n">ROMol</span> <span class="o">*</span><span class="n">mol4</span> <span class="o">=</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SmilesToMol</span><span class="p">(</span> <span class="s">&quot;C1=CC=CC=C1OC&quot;</span> <span class="p">);</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">RWMol</span> <span class="o">*</span><span class="n">smi_mol2</span> <span class="o">=</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SmilesToMol</span><span class="p">(</span> <span class="s">&quot;COC&quot;</span> <span class="p">);</span>
<span class="k">if</span><span class="p">(</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SubstructMatch</span><span class="p">(</span> <span class="o">*</span><span class="n">mol4</span> <span class="p">,</span> <span class="o">*</span><span class="n">smi_mol2</span> <span class="p">,</span> <span class="n">res</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;SMILES match&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Not SMILES match&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">RWMol</span> <span class="o">*</span><span class="n">smt_mol2</span> <span class="o">=</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SmartsToMol</span><span class="p">(</span> <span class="s">&quot;COC&quot;</span> <span class="p">);</span>
<span class="k">if</span><span class="p">(</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SubstructMatch</span><span class="p">(</span> <span class="o">*</span><span class="n">mol4</span> <span class="p">,</span> <span class="o">*</span><span class="n">smt_mol2</span> <span class="p">,</span> <span class="n">res</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;SMARTS match&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Not SMARTS match&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">// Needs aromatic C</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">RWMol</span> <span class="o">*</span><span class="n">smt_mol3</span> <span class="o">=</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SmartsToMol</span><span class="p">(</span> <span class="s">&quot;COc&quot;</span> <span class="p">);</span>
<span class="k">if</span><span class="p">(</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SubstructMatch</span><span class="p">(</span> <span class="o">*</span><span class="n">mol4</span> <span class="p">,</span> <span class="o">*</span><span class="n">smt_mol3</span> <span class="p">,</span> <span class="n">res</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;SMARTS match&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Not SMARTS match&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>gives</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">SMILES</span> <span class="n">match</span>
<span class="n">Not</span> <span class="n">SMARTS</span> <span class="n">match</span>
<span class="n">SMARTS</span> <span class="n">match</span>
</pre></div>
</div>
</div>
<div class="section" id="stereochemistry-in-substructure-matches">
<span id="stereochemistry-in-substructure-matches"></span><h3>Stereochemistry in substructure matches<a class="headerlink" href="#stereochemistry-in-substructure-matches" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>By default, information about stereochemistry is not used in
substructure searches:
<a class="reference external" href="./C++Examples/example15.cpp">(example15.cpp)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="n">RDKit</span><span class="o">::</span><span class="n">ROMol</span> <span class="o">*</span><span class="n">mol1</span> <span class="o">=</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SmilesToMol</span><span class="p">(</span> <span class="s">&quot;CC[C@H](F)Cl&quot;</span> <span class="p">);</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">RWMol</span> <span class="o">*</span><span class="n">patt1</span> <span class="o">=</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SmartsToMol</span><span class="p">(</span> <span class="s">&quot;C[C@H](F)Cl&quot;</span> <span class="p">);</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">MatchVectType</span> <span class="n">res</span><span class="p">;</span>
<span class="k">if</span><span class="p">(</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SubstructMatch</span><span class="p">(</span> <span class="o">*</span><span class="n">mol1</span> <span class="p">,</span> <span class="o">*</span><span class="n">patt1</span> <span class="p">,</span> <span class="n">res</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;SMARTS 1 match&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Not SMARTS 1 match&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">RWMol</span> <span class="o">*</span><span class="n">patt2</span> <span class="o">=</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SmartsToMol</span><span class="p">(</span> <span class="s">&quot;C[C@@H](F)Cl&quot;</span> <span class="p">);</span>
<span class="k">if</span><span class="p">(</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SubstructMatch</span><span class="p">(</span> <span class="o">*</span><span class="n">mol1</span> <span class="p">,</span> <span class="o">*</span><span class="n">patt2</span> <span class="p">,</span> <span class="n">res</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;SMARTS 2 match&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Not SMARTS 2 match&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">RWMol</span> <span class="o">*</span><span class="n">patt3</span> <span class="o">=</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SmartsToMol</span><span class="p">(</span> <span class="s">&quot;CC(F)Cl&quot;</span> <span class="p">);</span>
<span class="k">if</span><span class="p">(</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SubstructMatch</span><span class="p">(</span> <span class="o">*</span><span class="n">mol1</span> <span class="p">,</span> <span class="o">*</span><span class="n">patt3</span> <span class="p">,</span> <span class="n">res</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;SMARTS 3 match&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Not SMARTS 3 match&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>All 3 SMARTS patterns match the molecule. To use the chirality
information, you need to pass <code class="docutils literal"><span class="pre">true</span></code> as the optional fourth parameter,
corresponding to useChirality:
<a class="reference external" href="./C++Examples/example15.cpp">(example15.cpp)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="n">RDKit</span><span class="o">::</span><span class="n">ROMol</span> <span class="o">*</span><span class="n">mol1</span> <span class="o">=</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SmilesToMol</span><span class="p">(</span> <span class="s">&quot;CC[C@H](F)Cl&quot;</span> <span class="p">);</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">RWMol</span> <span class="o">*</span><span class="n">patt1</span> <span class="o">=</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SmartsToMol</span><span class="p">(</span> <span class="s">&quot;C[C@H](F)Cl&quot;</span> <span class="p">);</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">MatchVectType</span> <span class="n">res</span><span class="p">;</span>
<span class="k">if</span><span class="p">(</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SubstructMatch</span><span class="p">(</span> <span class="o">*</span><span class="n">mol1</span> <span class="p">,</span> <span class="o">*</span><span class="n">patt1</span> <span class="p">,</span> <span class="n">res</span> <span class="p">,</span> <span class="nb">true</span> <span class="p">,</span> <span class="nb">true</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;SMARTS 1 chiral match&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Not SMARTS 1 chiral match&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">RWMol</span> <span class="o">*</span><span class="n">patt2</span> <span class="o">=</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SmartsToMol</span><span class="p">(</span> <span class="s">&quot;C[C@@H](F)Cl&quot;</span> <span class="p">);</span>
<span class="k">if</span><span class="p">(</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SubstructMatch</span><span class="p">(</span> <span class="o">*</span><span class="n">mol1</span> <span class="p">,</span> <span class="o">*</span><span class="n">patt2</span> <span class="p">,</span> <span class="n">res</span> <span class="p">,</span> <span class="nb">true</span> <span class="p">,</span> <span class="nb">true</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;SMARTS 2 chiral match&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Not SMARTS 2 chiral match&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">RWMol</span> <span class="o">*</span><span class="n">patt3</span> <span class="o">=</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SmartsToMol</span><span class="p">(</span> <span class="s">&quot;CC(F)Cl&quot;</span> <span class="p">);</span>
<span class="k">if</span><span class="p">(</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SubstructMatch</span><span class="p">(</span> <span class="o">*</span><span class="n">mol1</span> <span class="p">,</span> <span class="o">*</span><span class="n">patt3</span> <span class="p">,</span> <span class="n">res</span> <span class="p">,</span> <span class="nb">true</span> <span class="p">,</span> <span class="nb">true</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;SMARTS 3 chiral match&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Not SMARTS 3 chiral match&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>gives</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">SMARTS</span> <span class="mi">1</span> <span class="n">chiral</span> <span class="n">match</span>
<span class="n">Not</span> <span class="n">SMARTS</span> <span class="mi">2</span> <span class="n">chiral</span> <span class="n">match</span>
<span class="n">SMARTS</span> <span class="mi">3</span> <span class="n">chiral</span> <span class="n">match</span>
</pre></div>
</div>
<p>Notice that when useChirality is true, a non-chiral query <strong>does</strong>
match a chiral molecule. The same is not true for a chiral query and a
non-chiral molecule:
<a class="reference external" href="./C++Examples/example15.cpp">(example15.cpp)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="n">RDKit</span><span class="o">::</span><span class="n">ROMol</span> <span class="o">*</span><span class="n">mol1</span> <span class="o">=</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SmilesToMol</span><span class="p">(</span> <span class="s">&quot;CC[C@H](F)Cl&quot;</span> <span class="p">);</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">RWMol</span> <span class="o">*</span><span class="n">mol2</span> <span class="o">=</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SmilesToMol</span><span class="p">(</span> <span class="s">&quot;CC(F)Cl&quot;</span> <span class="p">);</span>
<span class="k">if</span><span class="p">(</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SubstructMatch</span><span class="p">(</span> <span class="o">*</span><span class="n">mol1</span> <span class="p">,</span> <span class="o">*</span><span class="n">mol2</span> <span class="p">,</span> <span class="n">res</span> <span class="p">,</span> <span class="nb">true</span> <span class="p">,</span> <span class="nb">true</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Chiral mol, non-chiral query : match&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Chiral mol, non-chiral query : NO match&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">RDKit</span><span class="o">::</span><span class="n">RWMol</span> <span class="o">*</span><span class="n">patt5</span> <span class="o">=</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SmilesToMol</span><span class="p">(</span> <span class="s">&quot;C[C@H](F)Cl&quot;</span> <span class="p">);</span>
<span class="k">if</span><span class="p">(</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SubstructMatch</span><span class="p">(</span> <span class="o">*</span><span class="n">mol2</span> <span class="p">,</span> <span class="o">*</span><span class="n">patt5</span> <span class="p">,</span> <span class="n">res</span> <span class="p">,</span> <span class="nb">true</span> <span class="p">,</span> <span class="nb">true</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Non-chiral mol, chiral query : match&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Non-chiral mol, chiral query : NO match&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>gives</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Chiral</span> <span class="n">mol</span><span class="p">,</span> <span class="n">non</span><span class="o">-</span><span class="n">chiral</span> <span class="n">query</span> <span class="p">:</span> <span class="n">match</span>
<span class="n">Non</span><span class="o">-</span><span class="n">chiral</span> <span class="n">mol</span><span class="p">,</span> <span class="n">chiral</span> <span class="n">query</span> <span class="p">:</span> <span class="n">NO</span> <span class="n">match</span>
</pre></div>
</div>
</div>
<div class="section" id="atom-map-indices-in-smarts">
<span id="atom-map-indices-in-smarts"></span><h3>Atom Map Indices in SMARTS<a class="headerlink" href="#atom-map-indices-in-smarts" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>It is possible to attach indices to the atoms in the SMARTS
pattern. This is most often done in reaction SMARTS (see Chemical
Reactions), but is more general than that. For example, in the SMARTS
patterns for torsion angle analysis published by Guba et
al. <a class="reference external" href="#guba">[9]</a> indices are used to define the four atoms of the
torsion of interest. This allows additional atoms to be used to define
the environment of the four torsion atoms, as in
<code class="docutils literal"><span class="pre">[cH0:1][c:2]([cH0])!&#64;[CX3!r:3]=[NX2!r:4]</span></code> for an aromatic C=N
torsion. We might wonder in passing why they didn’t use recursive
SMARTS for this, which would have made life easier, but it is what it
is. The atom lists from GetSubstructureMatches are guaranteed to be in
order of the SMARTS, but in this case we’ll get five atoms so we need
a way of picking out, in the correct order, the four of interest. When
the SMARTS is parsed, the relevant atoms are assigned an atom map
number property that we can easily extract:
<a class="reference external" href="./C++Examples/example16.cpp">(example16.cpp)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="n">RDKit</span><span class="o">::</span><span class="n">RWMol</span> <span class="o">*</span><span class="n">patt1</span> <span class="o">=</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SmartsToMol</span><span class="p">(</span> <span class="s">&quot;[cH0:1][c:2]([cH0])!@[CX3!r:3]=[NX2!r:4]&quot;</span> <span class="p">);</span>
<span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="o">&gt;</span> <span class="n">ind_map</span><span class="p">;</span>
<span class="n">RDKit</span><span class="o">::</span><span class="n">ROMol</span><span class="o">::</span><span class="n">VERTEX_ITER</span> <span class="n">it</span> <span class="p">,</span> <span class="n">end</span><span class="p">;</span>
<span class="n">boost</span><span class="o">::</span><span class="n">tie</span><span class="p">(</span> <span class="n">it</span> <span class="p">,</span> <span class="n">end</span> <span class="p">)</span> <span class="o">=</span> <span class="n">patt1</span><span class="o">-&gt;</span><span class="n">getVertices</span><span class="p">();</span>
<span class="k">while</span><span class="p">(</span> <span class="n">it</span> <span class="o">!=</span> <span class="n">end</span> <span class="p">)</span> <span class="p">{</span>
  <span class="k">const</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">Atom</span> <span class="o">*</span><span class="n">atom</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="n">patt1</span><span class="p">)[</span><span class="o">*</span><span class="n">it</span><span class="p">].</span><span class="n">get</span><span class="p">();</span>
  <span class="kt">int</span> <span class="n">map_num</span> <span class="o">=</span> <span class="n">atom</span><span class="o">-&gt;</span><span class="n">getAtomMapNum</span><span class="p">();</span>
  <span class="k">if</span><span class="p">(</span> <span class="n">map_num</span> <span class="p">)</span> <span class="p">{</span>
    <span class="n">ind_map</span><span class="p">[</span><span class="n">map_num</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">atom</span><span class="o">-&gt;</span><span class="n">getIdx</span><span class="p">();</span>
  <span class="p">}</span>
  <span class="o">++</span><span class="n">it</span><span class="p">;</span>
<span class="p">}</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="o">&gt;</span> <span class="n">map_list</span><span class="p">;</span>
<span class="k">for</span><span class="p">(</span> <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="o">&gt;::</span><span class="n">iterator</span> <span class="n">i</span> <span class="o">=</span> <span class="n">ind_map</span><span class="p">.</span><span class="n">begin</span><span class="p">()</span> <span class="p">;</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">ind_map</span><span class="p">.</span><span class="n">end</span><span class="p">()</span> <span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span> <span class="p">{</span>
  <span class="n">map_list</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span> <span class="n">i</span><span class="o">-&gt;</span><span class="n">second</span> <span class="p">);</span>
<span class="p">}</span>
<span class="k">for</span><span class="p">(</span> <span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">,</span> <span class="n">is</span> <span class="o">=</span> <span class="n">map_list</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">is</span> <span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span> <span class="p">{</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">map_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; &quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>gives</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">3</span> <span class="mi">4</span>
</pre></div>
</div>
<p>Then, when using the query on a molecule, you can get the indices of
the four matching atoms like this:
<a class="reference external" href="./C++Examples/example16.cpp">(example16.cpp)</a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="n">RDKit</span><span class="o">::</span><span class="n">ROMol</span> <span class="o">*</span><span class="n">mol1</span> <span class="o">=</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SmilesToMol</span><span class="p">(</span> <span class="s">&quot;Cc1cccc(C)c1C(C)=NC&quot;</span> <span class="p">);</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">RDKit</span><span class="o">::</span><span class="n">MatchVectType</span><span class="o">&gt;</span> <span class="n">hits_vect</span><span class="p">;</span>
<span class="k">if</span><span class="p">(</span> <span class="n">RDKit</span><span class="o">::</span><span class="n">SubstructMatch</span><span class="p">(</span> <span class="o">*</span><span class="n">mol1</span> <span class="p">,</span> <span class="o">*</span><span class="n">patt1</span> <span class="p">,</span> <span class="n">hits_vect</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
  <span class="k">for</span><span class="p">(</span> <span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">hits_vect</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span> <span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Match &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; : &quot;</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span> <span class="kt">size_t</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">map_list</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="p">;</span> <span class="o">++</span><span class="n">j</span> <span class="p">)</span> <span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">hits_vect</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">map_list</span><span class="p">[</span><span class="n">j</span><span class="p">]].</span><span class="n">second</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; &quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>gives</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Match</span> <span class="mi">1</span> <span class="p">:</span> <span class="mi">1</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">10</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="a-name-thesssrproblem-a-the-sssr-problem">
<span id="a-name-thesssrproblem-a-the-sssr-problem"></span><h2><a name="TheSSSRProblem"></a>The SSSR Problem<a class="headerlink" href="#a-name-thesssrproblem-a-the-sssr-problem" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>As others have ranted about with more energy and eloquence than I
intend to, the definition of a molecule’s smallest set of smallest
rings is not unique.  In some high symmetry molecules, a “true” SSSR
will give results that are unappealing.  For example, the SSSR for
cubane only contains 5 rings, even though there are
“obviously” 6. This problem can be fixed by implementing a <em>small</em>
(instead of <em>smallest</em>) set of smallest rings algorithm that returns
symmetric results.  This is the approach that we took with the RDKit.</p>
<p>Because it is sometimes useful to be able to count how many SSSR rings
are present in the molecule, there is a
<code class="docutils literal"><span class="pre">rdkit.Chem.rdmolops.GetSSSR</span></code> function, but this only returns the
SSSR count, not the potentially non-unique set of rings.</p>
</div>
<div class="section" id="footnotes">
<span id="footnotes"></span><h2>Footnotes<a class="headerlink" href="#footnotes" title="このヘッドラインへのパーマリンク">¶</a></h2>
<ol class="simple">
<li><a name="blaney"></a>Blaney, J. M.; Dixon, J. S. 「Distance Geometry
in Molecular Modeling」.  <em>Reviews in Computational Chemistry</em>; VCH:
New York, 1994.</li>
<li><a name="rappe"></a>Rappé, A. K.; Casewit, C. J.; Colwell, K. S.;
Goddard III, W. A.; Skiff, W. M. 「UFF, a full periodic table force
field for molecular mechanics and molecular dynamics
simulations」. <em>J. Am. Chem. Soc.</em> <strong>114</strong>:10024-35 (1992) .</li>
<li><a name="riniker2"></a>Riniker, S.; Landrum, G. A. 「Better Informed
Distance Geometry: Using What We Know To Improve Conformation
Generation」 <em>J. Chem. Inf. Comp. Sci.</em> <strong>55</strong>:2562-74 (2015)</li>
<li><a name="mmff1"></a>Halgren, T. A. 「Merck molecular force
field. I. Basis, form, scope, parameterization, and performance of
MMFF94.」 <em>J. Comp. Chem.</em> <strong>17</strong>:490–19 (1996).</li>
<li><a name="mmff2"></a>Halgren, T. A. 「Merck molecular force
field. II. MMFF94 van der Waals and electrostatic parameters for
intermolecular interactions.」 <em>J. Comp. Chem.</em> <strong>17</strong>:520–52 (1996).</li>
<li><a name="mmff3"></a>Halgren, T. A. 「Merck molecular force
field. III. Molecular geometries and vibrational frequencies for
MMFF94.」 <em>J. Comp. Chem.</em> <strong>17</strong>:553–86 (1996).</li>
<li><a name="mmff4"></a>Halgren, T. A. &amp; Nachbar, R. B. 「Merck
molecular force field. IV. conformational energies and geometries
for MMFF94.」 <em>J. Comp. Chem.</em> <strong>17</strong>:587-615 (1996).</li>
<li><a name="mmffs"></a>Halgren, T. A. 「MMFF VI. MMFF94s option for
energy minimization studies.」 <em>J. Comp. Chem.</em> <strong>20</strong>:720–9
(1999).</li>
<li><a name="guba"></a>Guba, W.; Meyder, A.; Rarey, M.; Hert,
J. 「Torsion Library Reloaded: A New Version of Expert-Derived
SMARTS Rules for Assessing Conformations of Small
Molecules」. <em>J. Chem. Inf. Model.</em> ** 56**:1-5 (2016)</li>
</ol>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="総合索引"
             >索引</a></li>
        <li class="nav-item nav-item-0"><a href="index.html">The RDKit 2017.09.2 ドキュメント</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, Greg Landrum.
      このドキュメントは <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.6 で生成しました。
    </div>
  </body>
</html>