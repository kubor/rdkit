<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>rdkit.Chem.Pharm3D.EmbedLib</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a href="http://www.rdkit.org">RDKit</a></th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        Package&nbsp;rdkit ::
        <a href="rdkit.Chem-module.html">Package&nbsp;Chem</a> ::
        <a href="rdkit.Chem.Pharm3D-module.html">Package&nbsp;Pharm3D</a> ::
        Module&nbsp;EmbedLib
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="rdkit.Chem.Pharm3D.EmbedLib-module.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<!-- ==================== MODULE DESCRIPTION ==================== -->
<h1 class="epydoc">Module EmbedLib</h1><p class="nomargin-top"><span class="codelink"><a href="rdkit.Chem.Pharm3D.EmbedLib-pysrc.html">source&nbsp;code</a></span></p>
<!-- ==================== FUNCTIONS ==================== -->
<a name="section-Functions"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Functions</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Functions"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="rdkit.Chem.Pharm3D.EmbedLib-module.html#GetAtomHeavyNeighbors" class="summary-sig-name">GetAtomHeavyNeighbors</a>(<span class="summary-sig-arg">atom</span>)</span><br />
      returns a list of the heavy-atom neighbors of the
atom passed in:</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="rdkit.Chem.Pharm3D.EmbedLib-pysrc.html#GetAtomHeavyNeighbors">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="rdkit.Chem.Pharm3D.EmbedLib-module.html#ReplaceGroup" class="summary-sig-name">ReplaceGroup</a>(<span class="summary-sig-arg">match</span>,
        <span class="summary-sig-arg">bounds</span>,
        <span class="summary-sig-arg">slop</span>=<span class="summary-sig-default">0.01</span>,
        <span class="summary-sig-arg">useDirs</span>=<span class="summary-sig-default">False</span>,
        <span class="summary-sig-arg">dirLength</span>=<span class="summary-sig-default">defaultFeatLength</span>)</span><br />
      Adds an entry at the end of the bounds matrix for a point at
the center of a multi-point feature</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="rdkit.Chem.Pharm3D.EmbedLib-pysrc.html#ReplaceGroup">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="rdkit.Chem.Pharm3D.EmbedLib-module.html#EmbedMol" class="summary-sig-name">EmbedMol</a>(<span class="summary-sig-arg">mol</span>,
        <span class="summary-sig-arg">bm</span>,
        <span class="summary-sig-arg">atomMatch</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">weight</span>=<span class="summary-sig-default">2.0</span>,
        <span class="summary-sig-arg">randomSeed</span>=<span class="summary-sig-default">-1</span>,
        <span class="summary-sig-arg">excludedVolumes</span>=<span class="summary-sig-default">None</span>)</span><br />
      Generates an embedding for a molecule based on a bounds matrix and adds
a conformer (id 0) to the molecule</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="rdkit.Chem.Pharm3D.EmbedLib-pysrc.html#EmbedMol">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="rdkit.Chem.Pharm3D.EmbedLib-module.html#AddExcludedVolumes" class="summary-sig-name">AddExcludedVolumes</a>(<span class="summary-sig-arg">bm</span>,
        <span class="summary-sig-arg">excludedVolumes</span>,
        <span class="summary-sig-arg">smoothIt</span>=<span class="summary-sig-default">True</span>)</span><br />
      Adds a set of excluded volumes to the bounds matrix
and returns the new matrix</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="rdkit.Chem.Pharm3D.EmbedLib-pysrc.html#AddExcludedVolumes">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="rdkit.Chem.Pharm3D.EmbedLib-module.html#UpdatePharmacophoreBounds" class="summary-sig-name">UpdatePharmacophoreBounds</a>(<span class="summary-sig-arg">bm</span>,
        <span class="summary-sig-arg">atomMatch</span>,
        <span class="summary-sig-arg">pcophore</span>,
        <span class="summary-sig-arg">useDirs</span>=<span class="summary-sig-default">False</span>,
        <span class="summary-sig-arg">dirLength</span>=<span class="summary-sig-default">defaultFeatLength</span>,
        <span class="summary-sig-arg">mol</span>=<span class="summary-sig-default">None</span>)</span><br />
      loops over a distance bounds matrix and replaces the elements
that are altered by a pharmacophore</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="rdkit.Chem.Pharm3D.EmbedLib-pysrc.html#UpdatePharmacophoreBounds">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="rdkit.Chem.Pharm3D.EmbedLib-module.html#EmbedPharmacophore" class="summary-sig-name">EmbedPharmacophore</a>(<span class="summary-sig-arg">mol</span>,
        <span class="summary-sig-arg">atomMatch</span>,
        <span class="summary-sig-arg">pcophore</span>,
        <span class="summary-sig-arg">randomSeed</span>=<span class="summary-sig-default">-1</span>,
        <span class="summary-sig-arg">count</span>=<span class="summary-sig-default">10</span>,
        <span class="summary-sig-arg">smoothFirst</span>=<span class="summary-sig-default">True</span>,
        <span class="summary-sig-arg">silent</span>=<span class="summary-sig-default">False</span>,
        <span class="summary-sig-arg">bounds</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">excludedVolumes</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">targetNumber</span>=<span class="summary-sig-default">-1</span>,
        <span class="summary-sig-arg">useDirs</span>=<span class="summary-sig-default">False</span>)</span><br />
      Generates one or more embeddings for a molecule that satisfy a pharmacophore</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="rdkit.Chem.Pharm3D.EmbedLib-pysrc.html#EmbedPharmacophore">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="rdkit.Chem.Pharm3D.EmbedLib-module.html#isNaN" class="summary-sig-name">isNaN</a>(<span class="summary-sig-arg">v</span>)</span><br />
      provides an OS independent way of detecting NaNs
This is intended to be used with values returned from the C++
side of things.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="rdkit.Chem.Pharm3D.EmbedLib-pysrc.html#isNaN">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="rdkit.Chem.Pharm3D.EmbedLib-module.html#OptimizeMol" class="summary-sig-name">OptimizeMol</a>(<span class="summary-sig-arg">mol</span>,
        <span class="summary-sig-arg">bm</span>,
        <span class="summary-sig-arg">atomMatches</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">excludedVolumes</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">forceConstant</span>=<span class="summary-sig-default">1200.0</span>,
        <span class="summary-sig-arg">maxPasses</span>=<span class="summary-sig-default">5</span>,
        <span class="summary-sig-arg">verbose</span>=<span class="summary-sig-default">False</span>)</span><br />
      carries out a UFF optimization for a molecule optionally subject
to the constraints in a bounds matrix</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="rdkit.Chem.Pharm3D.EmbedLib-pysrc.html#OptimizeMol">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="rdkit.Chem.Pharm3D.EmbedLib-module.html#EmbedOne" class="summary-sig-name">EmbedOne</a>(<span class="summary-sig-arg">mol</span>,
        <span class="summary-sig-arg">name</span>,
        <span class="summary-sig-arg">match</span>,
        <span class="summary-sig-arg">pcophore</span>,
        <span class="summary-sig-arg">count</span>=<span class="summary-sig-default">1</span>,
        <span class="summary-sig-arg">silent</span>=<span class="summary-sig-default">0</span>,
        <span class="summary-sig-arg">**kwargs</span>)</span><br />
      generates statistics for a molecule's embeddings</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="rdkit.Chem.Pharm3D.EmbedLib-pysrc.html#EmbedOne">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="rdkit.Chem.Pharm3D.EmbedLib-module.html#MatchPharmacophoreToMol" class="summary-sig-name">MatchPharmacophoreToMol</a>(<span class="summary-sig-arg">mol</span>,
        <span class="summary-sig-arg">featFactory</span>,
        <span class="summary-sig-arg">pcophore</span>)</span><br />
      generates a list of all possible mappings of a pharmacophore to a molecule</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="rdkit.Chem.Pharm3D.EmbedLib-pysrc.html#MatchPharmacophoreToMol">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="rdkit.Chem.Pharm3D.EmbedLib-module.html#_getFeatDict" class="summary-sig-name" onclick="show_private();">_getFeatDict</a>(<span class="summary-sig-arg">mol</span>,
        <span class="summary-sig-arg">featFactory</span>,
        <span class="summary-sig-arg">features</span>)</span><br />
      **INTERNAL USE ONLY**</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="rdkit.Chem.Pharm3D.EmbedLib-pysrc.html#_getFeatDict">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="rdkit.Chem.Pharm3D.EmbedLib-module.html#MatchFeatsToMol" class="summary-sig-name">MatchFeatsToMol</a>(<span class="summary-sig-arg">mol</span>,
        <span class="summary-sig-arg">featFactory</span>,
        <span class="summary-sig-arg">features</span>)</span><br />
      generates a list of all possible mappings of each feature to a molecule</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="rdkit.Chem.Pharm3D.EmbedLib-pysrc.html#MatchFeatsToMol">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="rdkit.Chem.Pharm3D.EmbedLib-module.html#CombiEnum" class="summary-sig-name">CombiEnum</a>(<span class="summary-sig-arg">sequence</span>)</span><br />
      This generator takes a sequence of sequences as an argument and
provides all combinations of the elements of the subsequences:</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="rdkit.Chem.Pharm3D.EmbedLib-pysrc.html#CombiEnum">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="rdkit.Chem.Pharm3D.EmbedLib-module.html#DownsampleBoundsMatrix" class="summary-sig-name">DownsampleBoundsMatrix</a>(<span class="summary-sig-arg">bm</span>,
        <span class="summary-sig-arg">indices</span>,
        <span class="summary-sig-arg">maxThresh</span>=<span class="summary-sig-default">4.0</span>)</span><br />
      removes rows from a bounds matrix that are
that are greater than a threshold value away from a set of
other points</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="rdkit.Chem.Pharm3D.EmbedLib-pysrc.html#DownsampleBoundsMatrix">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="rdkit.Chem.Pharm3D.EmbedLib-module.html#CoarseScreenPharmacophore" class="summary-sig-name">CoarseScreenPharmacophore</a>(<span class="summary-sig-arg">atomMatch</span>,
        <span class="summary-sig-arg">bounds</span>,
        <span class="summary-sig-arg">pcophore</span>,
        <span class="summary-sig-arg">verbose</span>=<span class="summary-sig-default">False</span>)</span><br />
      &gt;&gt;&gt; from rdkit import Geometry
&gt;&gt;&gt; from rdkit.Chem.Pharm3D import Pharmacophore
&gt;&gt;&gt; feats = [
...</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="rdkit.Chem.Pharm3D.EmbedLib-pysrc.html#CoarseScreenPharmacophore">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="rdkit.Chem.Pharm3D.EmbedLib-module.html#Check2DBounds" class="summary-sig-name">Check2DBounds</a>(<span class="summary-sig-arg">atomMatch</span>,
        <span class="summary-sig-arg">mol</span>,
        <span class="summary-sig-arg">pcophore</span>)</span><br />
      checks to see if a particular mapping of features onto
a molecule satisfies a pharmacophore's 2D restrictions</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="rdkit.Chem.Pharm3D.EmbedLib-pysrc.html#Check2DBounds">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="rdkit.Chem.Pharm3D.EmbedLib-module.html#_checkMatch" class="summary-sig-name" onclick="show_private();">_checkMatch</a>(<span class="summary-sig-arg">match</span>,
        <span class="summary-sig-arg">mol</span>,
        <span class="summary-sig-arg">bounds</span>,
        <span class="summary-sig-arg">pcophore</span>,
        <span class="summary-sig-arg">use2DLimits</span>)</span><br />
      **INTERNAL USE ONLY**</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="rdkit.Chem.Pharm3D.EmbedLib-pysrc.html#_checkMatch">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="rdkit.Chem.Pharm3D.EmbedLib-module.html#ConstrainedEnum" class="summary-sig-name">ConstrainedEnum</a>(<span class="summary-sig-arg">matches</span>,
        <span class="summary-sig-arg">mol</span>,
        <span class="summary-sig-arg">pcophore</span>,
        <span class="summary-sig-arg">bounds</span>,
        <span class="summary-sig-arg">use2DLimits</span>=<span class="summary-sig-default">False</span>,
        <span class="summary-sig-arg">index</span>=<span class="summary-sig-default">0</span>,
        <span class="summary-sig-arg">soFar</span>=<span class="summary-sig-default">[]</span>)</span><br />
      Enumerates the list of atom mappings a molecule
has to a particular pharmacophore.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="rdkit.Chem.Pharm3D.EmbedLib-pysrc.html#ConstrainedEnum">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="rdkit.Chem.Pharm3D.EmbedLib-module.html#MatchPharmacophore" class="summary-sig-name">MatchPharmacophore</a>(<span class="summary-sig-arg">matches</span>,
        <span class="summary-sig-arg">bounds</span>,
        <span class="summary-sig-arg">pcophore</span>,
        <span class="summary-sig-arg">useDownsampling</span>=<span class="summary-sig-default">False</span>,
        <span class="summary-sig-arg">use2DLimits</span>=<span class="summary-sig-default">False</span>,
        <span class="summary-sig-arg">mol</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">excludedVolumes</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">useDirs</span>=<span class="summary-sig-default">False</span>)</span></td>
          <td align="right" valign="top">
            <span class="codelink"><a href="rdkit.Chem.Pharm3D.EmbedLib-pysrc.html#MatchPharmacophore">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="GetAllPharmacophoreMatches"></a><span class="summary-sig-name">GetAllPharmacophoreMatches</span>(<span class="summary-sig-arg">matches</span>,
        <span class="summary-sig-arg">bounds</span>,
        <span class="summary-sig-arg">pcophore</span>,
        <span class="summary-sig-arg">useDownsampling</span>=<span class="summary-sig-default">0</span>,
        <span class="summary-sig-arg">progressCallback</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">use2DLimits</span>=<span class="summary-sig-default">False</span>,
        <span class="summary-sig-arg">mol</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">verbose</span>=<span class="summary-sig-default">False</span>)</span></td>
          <td align="right" valign="top">
            <span class="codelink"><a href="rdkit.Chem.Pharm3D.EmbedLib-pysrc.html#GetAllPharmacophoreMatches">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="rdkit.Chem.Pharm3D.EmbedLib-module.html#ComputeChiralVolume" class="summary-sig-name">ComputeChiralVolume</a>(<span class="summary-sig-arg">mol</span>,
        <span class="summary-sig-arg">centerIdx</span>,
        <span class="summary-sig-arg">confId</span>=<span class="summary-sig-default">-1</span>)</span><br />
      Computes the chiral volume of an atom</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="rdkit.Chem.Pharm3D.EmbedLib-pysrc.html#ComputeChiralVolume">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="_runDoctests"></a><span class="summary-sig-name">_runDoctests</span>(<span class="summary-sig-arg">verbose</span>=<span class="summary-sig-default">None</span>)</span></td>
          <td align="right" valign="top">
            <span class="codelink"><a href="rdkit.Chem.Pharm3D.EmbedLib-pysrc.html#_runDoctests">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
</table>
<!-- ==================== VARIABLES ==================== -->
<a name="section-Variables"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Variables</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Variables"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="_times"></a><span class="summary-name">_times</span> = <code title="{}">{}</code>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="logger"></a><span class="summary-name">logger</span> = <code title="logging.logger()">logging.logger()</code>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="defaultFeatLength"></a><span class="summary-name">defaultFeatLength</span> = <code title="2.0">2.0</code>
    </td>
  </tr>
</table>
<p class="indent-wrapped-lines"><b>Imports:</b>
  <span title="math">math</span>,
  <span title="sys">sys</span>,
  <span title="time">time</span>,
  <span title="numpy">numpy</span>,
  <a href="rdkit.Chem-module.html" title="rdkit.Chem">Chem</a>,
  <span title="rdkit.RDLogger">logging</span>,
  <a href="rdkit.Chem.ChemicalFeatures-module.html" title="rdkit.Chem.ChemicalFeatures">ChemicalFeatures</a>,
  <a href="rdkit.Chem.ChemicalForceFields-module.html" title="rdkit.Chem.ChemicalForceFields">ChemicalForceFields</a>,
  <span title="rdkit.Chem.rdDistGeom">MolDG</span>,
  <a href="rdkit.Chem.Pharm3D.ExcludedVolume-module.html" title="rdkit.Chem.Pharm3D.ExcludedVolume">ExcludedVolume</a>,
  <a href="rdkit.DistanceGeometry-module.html" title="rdkit.DistanceGeometry">DG</a>,
  <a href="rdkit.ML.Data.Stats-module.html" title="rdkit.ML.Data.Stats">Stats</a>
</p><br />
<!-- ==================== FUNCTION DETAILS ==================== -->
<a name="section-FunctionDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Function Details</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-FunctionDetails"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
</table>
<a name="GetAtomHeavyNeighbors"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">GetAtomHeavyNeighbors</span>(<span class="sig-arg">atom</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="rdkit.Chem.Pharm3D.EmbedLib-pysrc.html#GetAtomHeavyNeighbors">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">
returns a list of the heavy-atom neighbors of the
atom passed in:

&gt;&gt;&gt; m = Chem.MolFromSmiles('CCO')
&gt;&gt;&gt; l = GetAtomHeavyNeighbors(m.GetAtomWithIdx(0))
&gt;&gt;&gt; len(l)
1
&gt;&gt;&gt; isinstance(l[0],Chem.Atom)
True
&gt;&gt;&gt; l[0].GetIdx()
1

&gt;&gt;&gt; l = GetAtomHeavyNeighbors(m.GetAtomWithIdx(1))
&gt;&gt;&gt; len(l)
2
&gt;&gt;&gt; l[0].GetIdx()
0
&gt;&gt;&gt; l[1].GetIdx()
2

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="ReplaceGroup"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">ReplaceGroup</span>(<span class="sig-arg">match</span>,
        <span class="sig-arg">bounds</span>,
        <span class="sig-arg">slop</span>=<span class="sig-default">0.01</span>,
        <span class="sig-arg">useDirs</span>=<span class="sig-default">False</span>,
        <span class="sig-arg">dirLength</span>=<span class="sig-default">defaultFeatLength</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="rdkit.Chem.Pharm3D.EmbedLib-pysrc.html#ReplaceGroup">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">
Adds an entry at the end of the bounds matrix for a point at
the center of a multi-point feature

returns a 2-tuple:
  new bounds mat
  index of point added

&gt;&gt;&gt; boundsMat = numpy.array([[0.0,2.0,2.0],[1.0,0.0,2.0],[1.0,1.0,0.0]])
&gt;&gt;&gt; match = [0,1,2]
&gt;&gt;&gt; bm,idx = ReplaceGroup(match,boundsMat,slop=0.0)

the index is at the end:
&gt;&gt;&gt; idx == 3
True

and the matrix is one bigger:
&gt;&gt;&gt; bm.shape == (4, 4)
True

but the original bounds mat is not altered:
&gt;&gt;&gt; boundsMat.shape == (3, 3)
True


We make the assumption that the points of the
feature form a regular polygon, are listed in order
(i.e. pt 0 is a neighbor to pt 1 and pt N-1)
and that the replacement point goes at the center:
&gt;&gt;&gt; print(', '.join(['%.3f'%x for x in bm[-1]]))
0.577, 0.577, 0.577, 0.000
&gt;&gt;&gt; print(', '.join(['%.3f'%x for x in bm[:,-1]]))
1.155, 1.155, 1.155, 0.000

The slop argument (default = 0.01) is fractional:
&gt;&gt;&gt; bm,idx = ReplaceGroup(match,boundsMat)
&gt;&gt;&gt; print(', '.join(['%.3f'%x for x in bm[-1]]))
0.572, 0.572, 0.572, 0.000
&gt;&gt;&gt; print(', '.join(['%.3f'%x for x in bm[:,-1]]))
1.166, 1.166, 1.166, 0.000

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="EmbedMol"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">EmbedMol</span>(<span class="sig-arg">mol</span>,
        <span class="sig-arg">bm</span>,
        <span class="sig-arg">atomMatch</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">weight</span>=<span class="sig-default">2.0</span>,
        <span class="sig-arg">randomSeed</span>=<span class="sig-default">-1</span>,
        <span class="sig-arg">excludedVolumes</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="rdkit.Chem.Pharm3D.EmbedLib-pysrc.html#EmbedMol">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">
Generates an embedding for a molecule based on a bounds matrix and adds
a conformer (id 0) to the molecule

if the optional argument atomMatch is provided, it will be used to provide
supplemental weights for the embedding routine (used in the optimization
phase to ensure that the resulting geometry really does satisfy the
pharmacophore).

if the excludedVolumes is provided, it should be a sequence of
ExcludedVolume objects

&gt;&gt;&gt; m = Chem.MolFromSmiles('c1ccccc1C')
&gt;&gt;&gt; bounds = MolDG.GetMoleculeBoundsMatrix(m)
&gt;&gt;&gt; bounds.shape == (7, 7)
True
&gt;&gt;&gt; m.GetNumConformers()
0
&gt;&gt;&gt; EmbedMol(m,bounds,randomSeed=23)
&gt;&gt;&gt; m.GetNumConformers()
1

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="AddExcludedVolumes"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">AddExcludedVolumes</span>(<span class="sig-arg">bm</span>,
        <span class="sig-arg">excludedVolumes</span>,
        <span class="sig-arg">smoothIt</span>=<span class="sig-default">True</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="rdkit.Chem.Pharm3D.EmbedLib-pysrc.html#AddExcludedVolumes">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">
Adds a set of excluded volumes to the bounds matrix
and returns the new matrix

excludedVolumes is a list of ExcludedVolume objects


 &gt;&gt;&gt; boundsMat = numpy.array([[0.0,2.0,2.0],[1.0,0.0,2.0],[1.0,1.0,0.0]])
 &gt;&gt;&gt; ev1 = ExcludedVolume.ExcludedVolume(([(0,),0.5,1.0],),exclusionDist=1.5)
 &gt;&gt;&gt; bm = AddExcludedVolumes(boundsMat,(ev1,))

 the results matrix is one bigger:
 &gt;&gt;&gt; bm.shape == (4, 4)
 True

 and the original bounds mat is not altered:
 &gt;&gt;&gt; boundsMat.shape == (3, 3)
 True

 &gt;&gt;&gt; print(', '.join(['%.3f'%x for x in bm[-1]]))
 0.500, 1.500, 1.500, 0.000
 &gt;&gt;&gt; print(', '.join(['%.3f'%x for x in bm[:,-1]]))
 1.000, 3.000, 3.000, 0.000

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="UpdatePharmacophoreBounds"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">UpdatePharmacophoreBounds</span>(<span class="sig-arg">bm</span>,
        <span class="sig-arg">atomMatch</span>,
        <span class="sig-arg">pcophore</span>,
        <span class="sig-arg">useDirs</span>=<span class="sig-default">False</span>,
        <span class="sig-arg">dirLength</span>=<span class="sig-default">defaultFeatLength</span>,
        <span class="sig-arg">mol</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="rdkit.Chem.Pharm3D.EmbedLib-pysrc.html#UpdatePharmacophoreBounds">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">
loops over a distance bounds matrix and replaces the elements
that are altered by a pharmacophore

**NOTE** this returns the resulting bounds matrix, but it may also
alter the input matrix

atomMatch is a sequence of sequences containing atom indices
for each of the pharmacophore's features.

  &gt;&gt;&gt; from rdkit import Geometry
  &gt;&gt;&gt; from rdkit.Chem.Pharm3D import Pharmacophore
  &gt;&gt;&gt; feats = [
  ...   ChemicalFeatures.FreeChemicalFeature('HBondAcceptor', 'HAcceptor1',
  ...                                        Geometry.Point3D(0.0, 0.0, 0.0)),
  ...   ChemicalFeatures.FreeChemicalFeature('HBondDonor', 'HDonor1',
  ...                                        Geometry.Point3D(2.65, 0.0, 0.0)),
  ...   ]
  &gt;&gt;&gt; pcophore=Pharmacophore.Pharmacophore(feats)
  &gt;&gt;&gt; pcophore.setLowerBound(0,1, 1.0)
  &gt;&gt;&gt; pcophore.setUpperBound(0,1, 2.0)

  &gt;&gt;&gt; boundsMat = numpy.array([[0.0,3.0,3.0],[2.0,0.0,3.0],[2.0,2.0,0.0]])
  &gt;&gt;&gt; atomMatch = ((0,),(1,))
  &gt;&gt;&gt; bm = UpdatePharmacophoreBounds(boundsMat,atomMatch,pcophore)


   In this case, there are no multi-atom features, so the result matrix
   is the same as the input:
   &gt;&gt;&gt; bm is boundsMat
   True

   this means, of course, that the input boundsMat is altered:
   &gt;&gt;&gt; print(', '.join(['%.3f'%x for x in boundsMat[0]]))
   0.000, 2.000, 3.000
   &gt;&gt;&gt; print(', '.join(['%.3f'%x for x in boundsMat[1]]))
   1.000, 0.000, 3.000
   &gt;&gt;&gt; print(', '.join(['%.3f'%x for x in boundsMat[2]]))
   2.000, 2.000, 0.000

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="EmbedPharmacophore"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">EmbedPharmacophore</span>(<span class="sig-arg">mol</span>,
        <span class="sig-arg">atomMatch</span>,
        <span class="sig-arg">pcophore</span>,
        <span class="sig-arg">randomSeed</span>=<span class="sig-default">-1</span>,
        <span class="sig-arg">count</span>=<span class="sig-default">10</span>,
        <span class="sig-arg">smoothFirst</span>=<span class="sig-default">True</span>,
        <span class="sig-arg">silent</span>=<span class="sig-default">False</span>,
        <span class="sig-arg">bounds</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">excludedVolumes</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">targetNumber</span>=<span class="sig-default">-1</span>,
        <span class="sig-arg">useDirs</span>=<span class="sig-default">False</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="rdkit.Chem.Pharm3D.EmbedLib-pysrc.html#EmbedPharmacophore">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">
Generates one or more embeddings for a molecule that satisfy a pharmacophore

atomMatch is a sequence of sequences containing atom indices
for each of the pharmacophore's features.

  - count: is the maximum number of attempts to make a generating an embedding
  - smoothFirst: toggles triangle smoothing of the molecular bounds matix
  - bounds: if provided, should be the molecular bounds matrix. If this isn't
     provided, the matrix will be generated.
  - targetNumber: if this number is positive, it provides a maximum number
     of embeddings to generate (i.e. we'll have count attempts to generate
     targetNumber embeddings).

returns: a 3 tuple:
  1) the molecular bounds matrix adjusted for the pharmacophore
  2) a list of embeddings (molecules with a single conformer)
  3) the number of failed attempts at embedding

  &gt;&gt;&gt; from rdkit import Geometry
  &gt;&gt;&gt; from rdkit.Chem.Pharm3D import Pharmacophore
  &gt;&gt;&gt; m = Chem.MolFromSmiles('OCCN')
  &gt;&gt;&gt; feats = [
  ...   ChemicalFeatures.FreeChemicalFeature('HBondAcceptor', 'HAcceptor1',
  ...                                        Geometry.Point3D(0.0, 0.0, 0.0)),
  ...   ChemicalFeatures.FreeChemicalFeature('HBondDonor', 'HDonor1',
  ...                                        Geometry.Point3D(2.65, 0.0, 0.0)),
  ...   ]
  &gt;&gt;&gt; pcophore=Pharmacophore.Pharmacophore(feats)
  &gt;&gt;&gt; pcophore.setLowerBound(0,1, 2.5)
  &gt;&gt;&gt; pcophore.setUpperBound(0,1, 3.5)
  &gt;&gt;&gt; atomMatch = ((0,),(3,))

  &gt;&gt;&gt; bm,embeds,nFail = EmbedPharmacophore(m,atomMatch,pcophore,randomSeed=23,silent=1)
  &gt;&gt;&gt; len(embeds)
  10
  &gt;&gt;&gt; nFail
  0

  Set up a case that can't succeed:
  &gt;&gt;&gt; pcophore=Pharmacophore.Pharmacophore(feats)
  &gt;&gt;&gt; pcophore.setLowerBound(0,1, 2.0)
  &gt;&gt;&gt; pcophore.setUpperBound(0,1, 2.1)
  &gt;&gt;&gt; atomMatch = ((0,),(3,))

  &gt;&gt;&gt; bm,embeds,nFail = EmbedPharmacophore(m,atomMatch,pcophore,randomSeed=23,silent=1)
  &gt;&gt;&gt; len(embeds)
  0
  &gt;&gt;&gt; nFail
  10

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="isNaN"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">isNaN</span>(<span class="sig-arg">v</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="rdkit.Chem.Pharm3D.EmbedLib-pysrc.html#isNaN">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">
provides an OS independent way of detecting NaNs
This is intended to be used with values returned from the C++
side of things.

We can't actually test this from Python (which traps
zero division errors), but it would work something like
this if we could:
&gt;&gt;&gt; isNaN(0)
False

#&gt;&gt;&gt; isNan(1/0)
#True

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="OptimizeMol"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">OptimizeMol</span>(<span class="sig-arg">mol</span>,
        <span class="sig-arg">bm</span>,
        <span class="sig-arg">atomMatches</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">excludedVolumes</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">forceConstant</span>=<span class="sig-default">1200.0</span>,
        <span class="sig-arg">maxPasses</span>=<span class="sig-default">5</span>,
        <span class="sig-arg">verbose</span>=<span class="sig-default">False</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="rdkit.Chem.Pharm3D.EmbedLib-pysrc.html#OptimizeMol">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">
carries out a UFF optimization for a molecule optionally subject
to the constraints in a bounds matrix

  - atomMatches, if provided, is a sequence of sequences
  - forceConstant is the force constant of the spring used to enforce
    the constraints

 returns a 2-tuple:
   1) the energy of the initial conformation
   2) the energy post-embedding
 NOTE that these energies include the energies of the constraints



  &gt;&gt;&gt; from rdkit import Geometry
  &gt;&gt;&gt; from rdkit.Chem.Pharm3D import Pharmacophore
  &gt;&gt;&gt; m = Chem.MolFromSmiles('OCCN')
  &gt;&gt;&gt; feats = [
  ...  ChemicalFeatures.FreeChemicalFeature('HBondAcceptor', 'HAcceptor1',
  ...                                       Geometry.Point3D(0.0, 0.0, 0.0)),
  ...  ChemicalFeatures.FreeChemicalFeature('HBondDonor', 'HDonor1',
  ...                                       Geometry.Point3D(2.65, 0.0, 0.0)),
  ...  ]
  &gt;&gt;&gt; pcophore=Pharmacophore.Pharmacophore(feats)
  &gt;&gt;&gt; pcophore.setLowerBound(0,1, 2.5)
  &gt;&gt;&gt; pcophore.setUpperBound(0,1, 2.8)
  &gt;&gt;&gt; atomMatch = ((0,),(3,))
  &gt;&gt;&gt; bm,embeds,nFail = EmbedPharmacophore(m,atomMatch,pcophore,randomSeed=23,silent=1)
  &gt;&gt;&gt; len(embeds)
  10
  &gt;&gt;&gt; testM = embeds[0]

  Do the optimization:
  &gt;&gt;&gt; e1,e2 = OptimizeMol(testM,bm,atomMatches=atomMatch)

  Optimizing should have lowered the energy:
  &gt;&gt;&gt; e2 &lt; e1
  True

  Check the constrained distance:
  &gt;&gt;&gt; conf = testM.GetConformer(0)
  &gt;&gt;&gt; p0 = conf.GetAtomPosition(0)
  &gt;&gt;&gt; p3 = conf.GetAtomPosition(3)
  &gt;&gt;&gt; d03 = p0.Distance(p3)
  &gt;&gt;&gt; d03 &gt;= pcophore.getLowerBound(0,1)-.01
  True
  &gt;&gt;&gt; d03 &lt;= pcophore.getUpperBound(0,1)+.01
  True

  If we optimize without the distance constraints (provided via the atomMatches
  argument) we're not guaranteed to get the same results, particularly in a case
  like the current one where the pharmcophore brings the atoms uncomfortably
  close together:
  &gt;&gt;&gt; testM = embeds[1]
  &gt;&gt;&gt; e1,e2 = OptimizeMol(testM,bm)
  &gt;&gt;&gt; e2 &lt; e1
  True
  &gt;&gt;&gt; conf = testM.GetConformer(0)
  &gt;&gt;&gt; p0 = conf.GetAtomPosition(0)
  &gt;&gt;&gt; p3 = conf.GetAtomPosition(3)
  &gt;&gt;&gt; d03 = p0.Distance(p3)
  &gt;&gt;&gt; d03 &gt;= pcophore.getLowerBound(0,1)-.01
  True
  &gt;&gt;&gt; d03 &lt;= pcophore.getUpperBound(0,1)+.01
  False

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="EmbedOne"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">EmbedOne</span>(<span class="sig-arg">mol</span>,
        <span class="sig-arg">name</span>,
        <span class="sig-arg">match</span>,
        <span class="sig-arg">pcophore</span>,
        <span class="sig-arg">count</span>=<span class="sig-default">1</span>,
        <span class="sig-arg">silent</span>=<span class="sig-default">0</span>,
        <span class="sig-arg">**kwargs</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="rdkit.Chem.Pharm3D.EmbedLib-pysrc.html#EmbedOne">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">
generates statistics for a molecule's embeddings

Four energies are computed for each embedding:
    1) E1: the energy (with constraints) of the initial embedding
    2) E2: the energy (with constraints) of the optimized embedding
    3) E3: the energy (no constraints) the geometry for E2
    4) E4: the energy (no constraints) of the optimized free-molecule
       (starting from the E3 geometry)

Returns a 9-tuple:
    1) the mean value of E1
    2) the sample standard deviation of E1
    3) the mean value of E2
    4) the sample standard deviation of E2
    5) the mean value of E3
    6) the sample standard deviation of E3
    7) the mean value of E4
    8) the sample standard deviation of E4
    9) The number of embeddings that failed

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="MatchPharmacophoreToMol"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">MatchPharmacophoreToMol</span>(<span class="sig-arg">mol</span>,
        <span class="sig-arg">featFactory</span>,
        <span class="sig-arg">pcophore</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="rdkit.Chem.Pharm3D.EmbedLib-pysrc.html#MatchPharmacophoreToMol">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">
generates a list of all possible mappings of a pharmacophore to a molecule

Returns a 2-tuple:
  1) a boolean indicating whether or not all features were found
  2) a list, numFeatures long, of sequences of features


  &gt;&gt;&gt; import os.path
  &gt;&gt;&gt; from rdkit import Geometry, RDConfig
  &gt;&gt;&gt; from rdkit.Chem.Pharm3D import Pharmacophore
  &gt;&gt;&gt; fdefFile = os.path.join(RDConfig.RDCodeDir,'Chem/Pharm3D/test_data/BaseFeatures.fdef')
  &gt;&gt;&gt; featFactory = ChemicalFeatures.BuildFeatureFactory(fdefFile)
  &gt;&gt;&gt; activeFeats = [
  ...  ChemicalFeatures.FreeChemicalFeature('Acceptor', Geometry.Point3D(0.0, 0.0, 0.0)),
  ...  ChemicalFeatures.FreeChemicalFeature('Donor',Geometry.Point3D(0.0, 0.0, 0.0))]
  &gt;&gt;&gt; pcophore= Pharmacophore.Pharmacophore(activeFeats)
  &gt;&gt;&gt; m = Chem.MolFromSmiles('FCCN')
  &gt;&gt;&gt; match,mList = MatchPharmacophoreToMol(m,featFactory,pcophore)
  &gt;&gt;&gt; match
  True

  Two feature types:
  &gt;&gt;&gt; len(mList)
  2

  The first feature type, Acceptor, has two matches:
  &gt;&gt;&gt; len(mList[0])
  2
  &gt;&gt;&gt; mList[0][0].GetAtomIds()
  (0,)
  &gt;&gt;&gt; mList[0][1].GetAtomIds()
  (3,)

  The first feature type, Donor, has a single match:
  &gt;&gt;&gt; len(mList[1])
  1
  &gt;&gt;&gt; mList[1][0].GetAtomIds()
  (3,)

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="_getFeatDict"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_getFeatDict</span>(<span class="sig-arg">mol</span>,
        <span class="sig-arg">featFactory</span>,
        <span class="sig-arg">features</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="rdkit.Chem.Pharm3D.EmbedLib-pysrc.html#_getFeatDict">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">
**INTERNAL USE ONLY**

&gt;&gt;&gt; import os.path
&gt;&gt;&gt; from rdkit import Geometry, RDConfig, Chem
&gt;&gt;&gt; fdefFile = os.path.join(RDConfig.RDCodeDir,'Chem/Pharm3D/test_data/BaseFeatures.fdef')
&gt;&gt;&gt; featFactory = ChemicalFeatures.BuildFeatureFactory(fdefFile)
&gt;&gt;&gt; activeFeats = [
...  ChemicalFeatures.FreeChemicalFeature('Acceptor', Geometry.Point3D(0.0, 0.0, 0.0)),
...  ChemicalFeatures.FreeChemicalFeature('Donor',Geometry.Point3D(0.0, 0.0, 0.0))]
&gt;&gt;&gt; m = Chem.MolFromSmiles('FCCN')
&gt;&gt;&gt; d =_getFeatDict(m,featFactory,activeFeats)
&gt;&gt;&gt; sorted(list(d.keys()))
['Acceptor', 'Donor']
&gt;&gt;&gt; donors = d['Donor']
&gt;&gt;&gt; len(donors)
1
&gt;&gt;&gt; donors[0].GetAtomIds()
(3,)
&gt;&gt;&gt; acceptors = d['Acceptor']
&gt;&gt;&gt; len(acceptors)
2
&gt;&gt;&gt; acceptors[0].GetAtomIds()
(0,)
&gt;&gt;&gt; acceptors[1].GetAtomIds()
(3,)

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="MatchFeatsToMol"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">MatchFeatsToMol</span>(<span class="sig-arg">mol</span>,
        <span class="sig-arg">featFactory</span>,
        <span class="sig-arg">features</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="rdkit.Chem.Pharm3D.EmbedLib-pysrc.html#MatchFeatsToMol">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">
generates a list of all possible mappings of each feature to a molecule

Returns a 2-tuple:
  1) a boolean indicating whether or not all features were found
  2) a list, numFeatures long, of sequences of features


  &gt;&gt;&gt; import os.path
  &gt;&gt;&gt; from rdkit import RDConfig, Geometry
  &gt;&gt;&gt; fdefFile = os.path.join(RDConfig.RDCodeDir,'Chem/Pharm3D/test_data/BaseFeatures.fdef')
  &gt;&gt;&gt; featFactory = ChemicalFeatures.BuildFeatureFactory(fdefFile)
  &gt;&gt;&gt; activeFeats = [
  ...  ChemicalFeatures.FreeChemicalFeature('Acceptor', Geometry.Point3D(0.0, 0.0, 0.0)),
  ...  ChemicalFeatures.FreeChemicalFeature('Donor',Geometry.Point3D(0.0, 0.0, 0.0))]
  &gt;&gt;&gt; m = Chem.MolFromSmiles('FCCN')
  &gt;&gt;&gt; match,mList = MatchFeatsToMol(m,featFactory,activeFeats)
  &gt;&gt;&gt; match
  True

  Two feature types:
  &gt;&gt;&gt; len(mList)
  2

  The first feature type, Acceptor, has two matches:
  &gt;&gt;&gt; len(mList[0])
  2
  &gt;&gt;&gt; mList[0][0].GetAtomIds()
  (0,)
  &gt;&gt;&gt; mList[0][1].GetAtomIds()
  (3,)

  The first feature type, Donor, has a single match:
  &gt;&gt;&gt; len(mList[1])
  1
  &gt;&gt;&gt; mList[1][0].GetAtomIds()
  (3,)

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="CombiEnum"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">CombiEnum</span>(<span class="sig-arg">sequence</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="rdkit.Chem.Pharm3D.EmbedLib-pysrc.html#CombiEnum">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">
This generator takes a sequence of sequences as an argument and
provides all combinations of the elements of the subsequences:

&gt;&gt;&gt; gen = CombiEnum(((1,2),(10,20)))
&gt;&gt;&gt; next(gen)
[1, 10]
&gt;&gt;&gt; next(gen)
[1, 20]

&gt;&gt;&gt; [x for x in CombiEnum(((1,2),(10,20)))]
[[1, 10], [1, 20], [2, 10], [2, 20]]

&gt;&gt;&gt; [x for x in CombiEnum(((1,2),(10,20),(100,200)))]
[[1, 10, 100], [1, 10, 200], [1, 20, 100], [1, 20, 200], [2, 10, 100],
 [2, 10, 200], [2, 20, 100], [2, 20, 200]]

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="DownsampleBoundsMatrix"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">DownsampleBoundsMatrix</span>(<span class="sig-arg">bm</span>,
        <span class="sig-arg">indices</span>,
        <span class="sig-arg">maxThresh</span>=<span class="sig-default">4.0</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="rdkit.Chem.Pharm3D.EmbedLib-pysrc.html#DownsampleBoundsMatrix">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">
removes rows from a bounds matrix that are
that are greater than a threshold value away from a set of
other points

returns the modfied bounds matrix

The goal of this function is to remove rows from the bounds matrix
that correspond to atoms that are likely to be quite far from
the pharmacophore we're interested in. Because the bounds smoothing
we eventually have to do is N^3, this can be a big win

 &gt;&gt;&gt; boundsMat = numpy.array([[0.0,3.0,4.0],[2.0,0.0,3.0],[2.0,2.0,0.0]])
 &gt;&gt;&gt; bm = DownsampleBoundsMatrix(boundsMat,(0,),3.5)
 &gt;&gt;&gt; bm.shape == (2, 2)
 True

 we don't touch the input matrix:
 &gt;&gt;&gt; boundsMat.shape == (3, 3)
 True

 &gt;&gt;&gt; print(', '.join(['%.3f'%x for x in bm[0]]))
 0.000, 3.000
 &gt;&gt;&gt; print(', '.join(['%.3f'%x for x in bm[1]]))
 2.000, 0.000

 if the threshold is high enough, we don't do anything:
 &gt;&gt;&gt; boundsMat = numpy.array([[0.0,4.0,3.0],[2.0,0.0,3.0],[2.0,2.0,0.0]])
 &gt;&gt;&gt; bm = DownsampleBoundsMatrix(boundsMat,(0,),5.0)
 &gt;&gt;&gt; bm.shape == (3, 3)
 True

 If there's a max value that's close enough to *any* of the indices
 we pass in, we'll keep it:
 &gt;&gt;&gt; boundsMat = numpy.array([[0.0,4.0,3.0],[2.0,0.0,3.0],[2.0,2.0,0.0]])
 &gt;&gt;&gt; bm = DownsampleBoundsMatrix(boundsMat,(0,1),3.5)
 &gt;&gt;&gt; bm.shape == (3, 3)
 True

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="CoarseScreenPharmacophore"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">CoarseScreenPharmacophore</span>(<span class="sig-arg">atomMatch</span>,
        <span class="sig-arg">bounds</span>,
        <span class="sig-arg">pcophore</span>,
        <span class="sig-arg">verbose</span>=<span class="sig-default">False</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="rdkit.Chem.Pharm3D.EmbedLib-pysrc.html#CoarseScreenPharmacophore">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">

&gt;&gt;&gt; from rdkit import Geometry
&gt;&gt;&gt; from rdkit.Chem.Pharm3D import Pharmacophore
&gt;&gt;&gt; feats = [
...   ChemicalFeatures.FreeChemicalFeature('HBondAcceptor', 'HAcceptor1',
...                                        Geometry.Point3D(0.0, 0.0, 0.0)),
...   ChemicalFeatures.FreeChemicalFeature('HBondDonor', 'HDonor1',
...                                        Geometry.Point3D(2.65, 0.0, 0.0)),
...   ChemicalFeatures.FreeChemicalFeature('Aromatic', 'Aromatic1',
...                                        Geometry.Point3D(5.12, 0.908, 0.0)),
...   ]
&gt;&gt;&gt; pcophore=Pharmacophore.Pharmacophore(feats)
&gt;&gt;&gt; pcophore.setLowerBound(0,1, 1.1)
&gt;&gt;&gt; pcophore.setUpperBound(0,1, 1.9)
&gt;&gt;&gt; pcophore.setLowerBound(0,2, 2.1)
&gt;&gt;&gt; pcophore.setUpperBound(0,2, 2.9)
&gt;&gt;&gt; pcophore.setLowerBound(1,2, 2.1)
&gt;&gt;&gt; pcophore.setUpperBound(1,2, 3.9)

&gt;&gt;&gt; bounds = numpy.array([[0,2,3],[1,0,4],[2,3,0]],numpy.float)
&gt;&gt;&gt; CoarseScreenPharmacophore(((0,),(1,)),bounds,pcophore)
True

&gt;&gt;&gt; CoarseScreenPharmacophore(((0,),(2,)),bounds,pcophore)
False

&gt;&gt;&gt; CoarseScreenPharmacophore(((1,),(2,)),bounds,pcophore)
False

&gt;&gt;&gt; CoarseScreenPharmacophore(((0,),(1,),(2,)),bounds,pcophore)
True

&gt;&gt;&gt; CoarseScreenPharmacophore(((1,),(0,),(2,)),bounds,pcophore)
False

&gt;&gt;&gt; CoarseScreenPharmacophore(((2,),(1,),(0,)),bounds,pcophore)
False

# we ignore the point locations here and just use their definitions:
&gt;&gt;&gt; feats = [
...   ChemicalFeatures.FreeChemicalFeature('HBondAcceptor', 'HAcceptor1',
...                                        Geometry.Point3D(0.0, 0.0, 0.0)),
...   ChemicalFeatures.FreeChemicalFeature('HBondDonor', 'HDonor1',
...                                        Geometry.Point3D(2.65, 0.0, 0.0)),
...   ChemicalFeatures.FreeChemicalFeature('Aromatic', 'Aromatic1',
...                                        Geometry.Point3D(5.12, 0.908, 0.0)),
...   ChemicalFeatures.FreeChemicalFeature('HBondDonor', 'HDonor1',
...                                        Geometry.Point3D(2.65, 0.0, 0.0)),
...                ]
&gt;&gt;&gt; pcophore=Pharmacophore.Pharmacophore(feats)
&gt;&gt;&gt; pcophore.setLowerBound(0,1, 2.1)
&gt;&gt;&gt; pcophore.setUpperBound(0,1, 2.9)
&gt;&gt;&gt; pcophore.setLowerBound(0,2, 2.1)
&gt;&gt;&gt; pcophore.setUpperBound(0,2, 2.9)
&gt;&gt;&gt; pcophore.setLowerBound(0,3, 2.1)
&gt;&gt;&gt; pcophore.setUpperBound(0,3, 2.9)
&gt;&gt;&gt; pcophore.setLowerBound(1,2, 1.1)
&gt;&gt;&gt; pcophore.setUpperBound(1,2, 1.9)
&gt;&gt;&gt; pcophore.setLowerBound(1,3, 1.1)
&gt;&gt;&gt; pcophore.setUpperBound(1,3, 1.9)
&gt;&gt;&gt; pcophore.setLowerBound(2,3, 1.1)
&gt;&gt;&gt; pcophore.setUpperBound(2,3, 1.9)
&gt;&gt;&gt; bounds = numpy.array([[0,3,3,3],[2,0,2,2],[2,1,0,2],[2,1,1,0]],numpy.float)

&gt;&gt;&gt; CoarseScreenPharmacophore(((0,),(1,),(2,),(3,)),bounds,pcophore)
True

&gt;&gt;&gt; CoarseScreenPharmacophore(((0,),(1,),(3,),(2,)),bounds,pcophore)
True

&gt;&gt;&gt; CoarseScreenPharmacophore(((1,),(0,),(3,),(2,)),bounds,pcophore)
False

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="Check2DBounds"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">Check2DBounds</span>(<span class="sig-arg">atomMatch</span>,
        <span class="sig-arg">mol</span>,
        <span class="sig-arg">pcophore</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="rdkit.Chem.Pharm3D.EmbedLib-pysrc.html#Check2DBounds">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">
checks to see if a particular mapping of features onto
a molecule satisfies a pharmacophore's 2D restrictions

  &gt;&gt;&gt; from rdkit import Geometry
  &gt;&gt;&gt; from rdkit.Chem.Pharm3D import Pharmacophore
  &gt;&gt;&gt; activeFeats = [
  ...  ChemicalFeatures.FreeChemicalFeature('Acceptor', Geometry.Point3D(0.0, 0.0, 0.0)),
  ...  ChemicalFeatures.FreeChemicalFeature('Donor',Geometry.Point3D(0.0, 0.0, 0.0))]
  &gt;&gt;&gt; pcophore= Pharmacophore.Pharmacophore(activeFeats)
  &gt;&gt;&gt; pcophore.setUpperBound2D(0,1,3)
  &gt;&gt;&gt; m = Chem.MolFromSmiles('FCC(N)CN')
  &gt;&gt;&gt; Check2DBounds(((0,),(3,)),m,pcophore)
  True
  &gt;&gt;&gt; Check2DBounds(((0,),(5,)),m,pcophore)
  False

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="_checkMatch"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_checkMatch</span>(<span class="sig-arg">match</span>,
        <span class="sig-arg">mol</span>,
        <span class="sig-arg">bounds</span>,
        <span class="sig-arg">pcophore</span>,
        <span class="sig-arg">use2DLimits</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="rdkit.Chem.Pharm3D.EmbedLib-pysrc.html#_checkMatch">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">
**INTERNAL USE ONLY**

checks whether a particular atom match can be satisfied by
a molecule

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="ConstrainedEnum"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">ConstrainedEnum</span>(<span class="sig-arg">matches</span>,
        <span class="sig-arg">mol</span>,
        <span class="sig-arg">pcophore</span>,
        <span class="sig-arg">bounds</span>,
        <span class="sig-arg">use2DLimits</span>=<span class="sig-default">False</span>,
        <span class="sig-arg">index</span>=<span class="sig-default">0</span>,
        <span class="sig-arg">soFar</span>=<span class="sig-default">[]</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="rdkit.Chem.Pharm3D.EmbedLib-pysrc.html#ConstrainedEnum">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">
Enumerates the list of atom mappings a molecule
has to a particular pharmacophore.
We do check distance bounds here.

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="MatchPharmacophore"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">MatchPharmacophore</span>(<span class="sig-arg">matches</span>,
        <span class="sig-arg">bounds</span>,
        <span class="sig-arg">pcophore</span>,
        <span class="sig-arg">useDownsampling</span>=<span class="sig-default">False</span>,
        <span class="sig-arg">use2DLimits</span>=<span class="sig-default">False</span>,
        <span class="sig-arg">mol</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">excludedVolumes</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">useDirs</span>=<span class="sig-default">False</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="rdkit.Chem.Pharm3D.EmbedLib-pysrc.html#MatchPharmacophore">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">


if use2DLimits is set, the molecule must also be provided and topological
distances will also be used to filter out matches

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="ComputeChiralVolume"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">ComputeChiralVolume</span>(<span class="sig-arg">mol</span>,
        <span class="sig-arg">centerIdx</span>,
        <span class="sig-arg">confId</span>=<span class="sig-default">-1</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="rdkit.Chem.Pharm3D.EmbedLib-pysrc.html#ComputeChiralVolume">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">
Computes the chiral volume of an atom

We're using the chiral volume formula from Figure 7 of
Blaney and Dixon, Rev. Comp. Chem. V, 299-335 (1994)

  &gt;&gt;&gt; import os.path
  &gt;&gt;&gt; from rdkit import RDConfig
  &gt;&gt;&gt; dataDir = os.path.join(RDConfig.RDCodeDir,'Chem/Pharm3D/test_data')

  R configuration atoms give negative volumes:
  &gt;&gt;&gt; mol = Chem.MolFromMolFile(os.path.join(dataDir,'mol-r.mol'))
  &gt;&gt;&gt; Chem.AssignStereochemistry(mol)
  &gt;&gt;&gt; mol.GetAtomWithIdx(1).GetProp('_CIPCode')
  'R'
  &gt;&gt;&gt; ComputeChiralVolume(mol,1) &lt; 0
  True

  S configuration atoms give positive volumes:
  &gt;&gt;&gt; mol = Chem.MolFromMolFile(os.path.join(dataDir,'mol-s.mol'))
  &gt;&gt;&gt; Chem.AssignStereochemistry(mol)
  &gt;&gt;&gt; mol.GetAtomWithIdx(1).GetProp('_CIPCode')
  'S'
  &gt;&gt;&gt; ComputeChiralVolume(mol,1) &gt; 0
  True

  Non-chiral (or non-specified) atoms give zero volume:
  &gt;&gt;&gt; ComputeChiralVolume(mol,0) == 0.0
  True

  We also work on 3-coordinate atoms (with implicit Hs):
  &gt;&gt;&gt; mol = Chem.MolFromMolFile(os.path.join(dataDir,'mol-r-3.mol'))
  &gt;&gt;&gt; Chem.AssignStereochemistry(mol)
  &gt;&gt;&gt; mol.GetAtomWithIdx(1).GetProp('_CIPCode')
  'R'
  &gt;&gt;&gt; ComputeChiralVolume(mol,1)&lt;0
  True

  &gt;&gt;&gt; mol = Chem.MolFromMolFile(os.path.join(dataDir,'mol-s-3.mol'))
  &gt;&gt;&gt; Chem.AssignStereochemistry(mol)
  &gt;&gt;&gt; mol.GetAtomWithIdx(1).GetProp('_CIPCode')
  'S'
  &gt;&gt;&gt; ComputeChiralVolume(mol,1)&gt;0
  True

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a href="http://www.rdkit.org">RDKit</a></th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1
    on Tue Jan 23 10:00:34 2018
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
